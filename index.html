<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Haikyu Fly High - Team Builder by Devoy Aces</title>
<style>
    #menuBtn {
    width: 60px;
    height: 60px;
    font-size: 2.5em;
    padding: 0;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: #28a745;
    color: white;
    border: none;
    cursor: pointer;
    z-index: 1000;
    position: fixed;
    top: 15px;
    left: 15px;
}

#menuBtn:hover {
    background-color: #218838;
}
    #rotateBtn,
    #saveTeamBtn,
    #clearTeamBtn {
        font-size: 2em;
        padding: 20px 38px;
        min-width: 180px;
        border-radius: 8px;
    }
    body {
        background-color: #222;
        color: #fff;
        font-family: Arial, sans-serif;
        text-align: center;
    }

    h1 {
        margin-top: 20px;
    }

    .team-grid {
        display: flex;
        flex-direction: column;
        gap: 20px;
        align-items: center;
        margin-top: 30px;
    }

    .row {
        display: flex;
        gap: 20px;
    }

    .top-row {
        transform: translateX(6px);
    }

    .player-slot {
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    .hex {
        position: relative;
        width: 150px;
        height: 210px;
        background-color: #444;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: background 0.3s;
        overflow: hidden;
    }

    .hex:hover {
        background-color: #555;
    }

    .hex img {
        width: 100%;
        height: 100%;
object-fit: Save;
    }

    .player-info {
        margin-top: 5px;
        font-size: 14px;
        color: #fff;
        text-align: center;
        max-width: 150px;
        word-wrap: break-word;
    }

    .bench-slot {
        width: 50px;
        height: 67px;
        background-color: #444;
        border-radius: 5px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        overflow: hidden;
    }

    .bench-slot img {
        width: 100%;
        height: 100%;
         object-fit: Save;
    }

    .add-slot-btn {
        background-color: #28a745;
        border: none;
        color: white;
        padding: 5px 10px;
        margin-left: 10px;
        cursor: pointer;
        border-radius: 5px;
    }

    .add-slot-btn:hover {
        background-color: #218838;
    }
.bench-quick{
  display:flex; gap:6px; margin:0 10px;
}
.bench-quick-btn{
  background:#222; color:#fff; border:1px solid #555;
  border-radius:6px; padding:4px 6px; font-size:12px; cursor:pointer;
}
.bench-quick-btn:hover{ background:#333; }
    #saveTeamBtn {
        background-color: #28a745;
        border: none;
        color: white;
        padding: 6px 10px;
        margin-right: 10px;
        cursor: pointer;
        border-radius: 5px;
        font-size: 16px;
        vertical-align: middle;
    }

    #saveTeamBtn:hover {
        background-color: #218838;
    } 



    #synergy-panel {
        margin-top: 50px;
        background-color: #333;
        padding: 15px;
        border-radius: 10px;
        max-width: 600px;
        margin-left: auto;
        margin-right: auto;
        text-align: left;
    }

    .scroll-menu {
        display: none;
        margin-top: 10px;
        max-height: 200px;
        overflow-y: auto;
        background-color: #333;
        padding: 10px;
        border-radius: 8px;
        flex-wrap: wrap;
    }

    .scroll-menu img {
        width: 80px;
        height: auto;
        cursor: grab;
        margin: 5px;
        border: 2px solid transparent;
    }

    .scroll-menu img:hover {
        border: 2px solid yellow;
    }

    /* Painel lateral */
    .sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 300px;
        height: 100%;
        background-color: #333;
        overflow-x: hidden;
        transition: transform 0.3s ease, opacity 0.3s ease;
        transform: translateX(-100%);
        padding: 20px;
        box-shadow: 2px 0 5px rgba(0,0,0,0.5);
        z-index: 999;
        opacity: 0;
        pointer-events: none;
        display: flex;
        flex-direction: column;
    }

    .sidebar.open {
        transform: translateX(0);
        opacity: 1;
        pointer-events: auto;
    }

    .sidebar h2 {
        color: #fff;
        margin-bottom: 20px;
    }

    .sidebar button.close-btn {
        background: none;
        border: none;
        color: #fff;
        font-size: 20px;
        cursor: pointer;
        position: absolute;
        top: 15px;
        right: 15px;
    }

    #menuBtn {
        position: fixed;
        top: 15px;
        left: 15px;
        background-color: #28a745;
        color: white;
        border: none;
        padding: 10px 15px;
        font-size: 18px;
        cursor: pointer;
        border-radius: 5px;
        z-index: 1000;
    }

    #menuBtn:hover {
        background-color: #218838;
    }
    /* Aumenta o bot√£o no mobile / telas touch */
@media (max-width: 768px), (pointer: coarse) {
  #menuBtn {
    /* alvo de toque grande (recomendado 48‚Äì64px) */
    width: 64px;
    height: 64px;

    /* centraliza o √≠cone ‚ò∞ dentro do quadrado */
    display: inline-flex;
    align-items: center;
    justify-content: center;

    /* o √≠cone fica Mayr */
    font-size: 32px;

    /* remove o padding para n√£o ‚Äúesticar‚Äù al√©m do width/height */
    padding: 0;

    /* arredondamento um pouco Mayr (opcional) */
    border-radius: 12px;
  }
}

    /* Lista de characters no menu */
    .char-list {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
    }

    .char-card {
        width: 80px;
        text-align: center;
        cursor: pointer;
    }

    .char-card img {
        width: 100%;
        border-radius: 5px;
    }

    /* Conte√∫do do menu com rolagem */
    #sidebar {
    scroll-behavior: smooth;    
    position: fixed;
    right: 0;
    top: 0;
    width: 300px; /* ajuste conforme seu layout */
    height: 100vh; /* ocupa a tela inteira */
    background-color: #222;
    color: white;
    overflow-y: auto; /* ativa rolagem vertical */
    padding: 10px;
    box-sizing: border-box;


    /* Oculta a barra no Chrome, Edge, Safari */
    scrollbar-width: none; /* Firefox */
    -ms-overflow-style: none; /* IE e Edge antigos */
}
    #sidebar::-webkit-scrollbar {
    display: none; /* Chrome, Safari, Edge */
}

    .filtros {
        display: flex;
        flex-direction: column;
        gap: 8px;
        margin-bottom: 10px;
    }

    .filtros label {
        font-size: 14px;
        font-weight: bold;
        margin-bottom: 3px;
        display:block;
        text-align:left;
    }

    .filtros select {
        width: 100%;
        padding: 5px;
        font-size: 14px;
        border-radius: 5px;
        border: none;
    }

    #limparFiltros {
        background-color: #ff4d4d;
        color: white;
        border: none;
        padding: 6px;
        font-size: 14px;
        border-radius: 5px;
        cursor: pointer;
        width:100%;
    }

    #limparFiltros:hover {
        background-color: #e60000;
    }

    .saved-list button {
        margin-left: 8px;
        padding: 4px 8px;
        font-size: 13px;
        border-radius: 4px;
        cursor: pointer;
        border: none;
    }
    .saved-list .load-btn { background:#28a745; color:#fff; }
    .saved-list .del-btn { background:#ff4d4d; color:#fff; }

    .bond-btn {
    background-color: #444;
    color: white;
    border: 1px solid #666;
    border-radius: 6px;
    padding: 4px 8px;
    font-size: 14px;
    cursor: pointer;
    transition: background-color 0.2s, transform 0.2s;
}

.bond-btn:hover {
    background-color: #666;
    transform: scale(1.05);
}

.bond-btn:active {
    background-color: #888;
    transform: scale(0.98);
}
    .skill-btn {
    background-color: #555;
    color: white;
    border: 1px solid #777;
    border-radius: 6px;
    padding: 4px 8px;
    font-size: 14px;
    cursor: pointer;
    transition: background-color 0.2s, transform 0.2s;
}

.skill-btn:hover {
    background-color: #777;
    transform: scale(1.05);
}

.skill-btn:active {
    background-color: #999;
    transform: scale(0.98);
}
    .char-info {
    text-align: center;
    margin-top: 4px;
}

.char-name {
    font-weight: bold;
    font-size: 14px;
    color: #fff;
    margin: 0;
}

.char-Stats {
    font-size: 12px;
    color: #ccc;
    margin: 0;
}

.char-Stats span {
    font-weight: bold;
    color: #ffcc00; /* cor destaque do valor */
}
    #scrollMenu {
    scrollbar-width: none; /* Firefox */
    -ms-overflow-style: none; /* IE e Edge antigos */
}

#scrollMenu::-webkit-scrollbar {
    display: none; /* Chrome, Safari, Edge */
}
    #scrollMenu {
    overflow-y: auto; /* j√° est√°, mas refor√ßando */
}
   /* header de filtros dentro do scrollMenu (bench) */
#scrollMenu .bench-quick-inside{
  display:flex; gap:6px; padding:6px 6px 8px; flex-wrap:wrap;
}
#scrollMenu .bench-quick-inside button{
  background:#222; color:#fff; border:1px solid #555;
  border-radius:6px; padding:4px 6px; font-size:12px; cursor:pointer;
}
#scrollMenu .bench-quick-inside button.active{ outline:2px solid #999; }
    
#sidebar-content ul {
    list-style: none;       /* remove bullets */
    padding-left: 0;        /* remove recuo padr√£o */
    margin-left: 0;         /* evita deslocamento */
    text-align: center;     /* centraliza texto */
}

#sidebar-content li {
    margin-bottom: 4px;     /* espa√ßo entre linhas */
}
    .filtros {
    background-color: #333;
    padding: 12px;
    border-radius: 8px;
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.filtros label {
    font-size: 13px;
    font-weight: bold;
    margin-bottom: 4px;
}

.filtros select {
    width: 100%;
    padding: 6px;
    border: 1px solid #555;
    border-radius: 6px;
    background-color: #222;
    color: white;
}

#limparFiltros {
    background-color: #ff4d4d;
    border: none;
    padding: 8px;
    border-radius: 6px;
    font-weight: bold;
    cursor: pointer;
}

#limparFiltros:hover {
    background-color: #e60000;
}
    /* Remove bolinhas e aplica espa√ßamento no Side Menu */
#sidebar-content ul,
#sidebar-content li {
    list-style: none !important;  /* for√ßa remover bullets */
    padding-left: 0 !important;
    margin-left: 0 !important;
}

#sidebar-content ul {
    display: flex;
    flex-direction: column;
    gap: 10px; /* mesmo espa√ßamento da aba Info */
}
    .sidebar > ul {
    list-style: none;      /* remove bullets */
    padding: 0;            /* elimina recuo padr√£o */
    margin: 0 0 16px 0;    /* margem inferior opcional */
    display: flex;         /* empilha verticalmente */
    flex-direction: column;
    gap: 10px;             /* espa√ßamento entre os itens */
}

.sidebar > ul > li {
    margin: 0;             /* garante que n√£o tenha margens extras */
}
    .person-symbols {
    display: flex;
    justify-content: center;
    gap: 6px;
    margin-top: 6px;
}

.symbol-icon {
    width: 40px;
    height: 40px;
    object-fit: contain;
}
    .card-sub{
  font-size: 12px;
  opacity: 0.85;
  margin-top: 2px;
}

/* === LISTA NO Side Menu === */
#charList{
  display: grid;
  grid-template-columns: repeat(2, minmax(50px, 1fr)); /* 2 colunas no menu */
  gap: 10px;
  padding: 0;
  margin: 0;
  list-style: none;
}
/* nova classe para esconder */
#charList.is-hidden { display: none !important; }

/* escalar a imagem ao tamanho da coluna */
#charList .person-card img{
  width: 100%;
  height: auto;          /* mant√©m propor√ß√£o */
  display: block;
  border-radius: 8px;
}

/* texto */
#charList .card-name{ margin-top:6px; font-weight:600; text-align:center; }
#charList .card-sub{  font-size:12px; opacity:.85; margin-top:2px; text-align:center; }

/* quando houver mais espa√ßo, aumente o n¬∫ de colunas */
@media (min-width: 420px){
  #charList{ grid-template-columns: repeat(3, minmax(50px, 1fr)); }
}
@media (min-width: 560px){
  #charList{ grid-template-columns: repeat(4, minmax(50px, 1fr)); }
}
    #bench-row-wrapper{
  display: flex;
  flex-direction: column;   /* empilha t√≠tulo, slots e toolbar */
  gap: 8px;
}
#bench-row{ order: 1; }
#bench-toolbar{
  order: 2;
  display: flex;
  gap: 10px;
  justify-content: flex-end; /* ou center/space-between */
  margin-top: 45px;
}
/* === ITEMS (Memory + Potential Sets) === */
.item-badge {
  position:absolute; bottom:4px; right:6px;
  background:#111; border:1px solid #666; color:#fff;
  font-size:11px; padding:2px 6px; border-radius:6px; opacity:.9;
  max-width: 90%; overflow: hidden; white-space: nowrap; text-overflow: ellipsis;
}
.item-modal-backdrop{
  position:fixed; inset:0; background:rgba(0,0,0,.6);
  display:flex; align-items:center; justify-content:center; z-index:5000;
}
.item-modal{
  background:#2b2b2b; color:#fff; width:min(640px,92vw);
  border-radius:12px; padding:14px; box-shadow:0 12px 32px rgba(0,0,0,.5);
}
.item-row{ display:grid; grid-template-columns: 140px 1fr; gap:10px; align-items:center; margin:10px 0; }
.item-modal select{
  width:100%; background:#1f1f1f; color:#fff; border:1px solid #555; border-radius:8px; padding:8px;
}
.item-actions{ display:flex; gap:8px; justify-content:flex-end; margin-top:12px; }
.item-btn{
  background:#444; border:1px solid #666; color:#fff;
  padding:8px 10px; border-radius:8px; cursor:pointer;
}
.item-btn:hover{ background:#555; }
.item-stats{
  background:#1e1e1e; border:1px solid #444; border-radius:10px; padding:8px; font-size:13px;
}
.item-stats code{ font-family: ui-monospace, Menlo, Consolas, monospace; }
.item-desc{ opacity:.85; font-size:12px; margin-top:6px; line-height:1.35; }
.hex, .bench-slot { position: relative; } /* ancora do badge/engrenagem */
.item-gear{
  position:absolute; top:4px; right:4px; z-index:5;
  width:22px; height:22px; display:flex; align-items:center; justify-content:center;
  border-radius:999px; background:rgba(20,20,20,.85); border:1px solid #666;
  font-size:14px; cursor:pointer; color:#fff;
}
.item-gear:hover{ background:rgba(40,40,40,.95); }
.item-badge img { width:14px; height:14px; vertical-align:-2px; margin-right:4px; border-radius:3px; }
.item-choice img {
  width:28px; height:28px; border-radius:6px; object-fit:cover;
}
.item-choice.empty { opacity:.6; }
/* Linha no formato: [label] [IMG] [select]  */
.item-row-inline{
  display: grid;
  grid-template-columns: 140px 52px 1fr; /* label | img | select */
  gap: 10px;
  align-items: center;
  margin: 10px 0;
}

/* thumb quadrada */
.item-thumb{
  width: 48px; height: 48px;
  border-radius: 8px;
  background: #2a2a2a;
  object-fit: cover;
  box-shadow: inset 0 0 0 1px #444;
}

/* select estilo ‚Äúpill‚Äù (opcional) */
.item-select{
  width: 100%;
  background:#1f1f1f; color:#fff;
  border:1px solid #555; border-radius:999px;
  padding: 8px 12px;
}

/* descri√ß√£o fica alinhada sob IMG+select (colunas 2..3) */
.item-subdesc{
  grid-column: 2 / span 2;
  font-size: 12px; opacity: .85; margin-top: 6px;
}
/* --- mais espa√ßo no modal de Items --- */
.item-row-inline{
  display: grid;
  grid-template-columns: 170px 56px 1fr; /* label | IMG | select  (era 140px 52px 1fr) */
  column-gap: 16px;                      /* era 10px */
  row-gap: 8px;
  align-items: start;                    /* evita que label fique baixo */
  margin: 14px 0;                        /* era 10px */
}

/* o texto do r√≥tulo alinhado ao topo da linha (Memory / Potential...) */
.item-row-inline > div:first-child{
  align-self: start;
  padding-top: 4px;
}

/* a miniatura um pouco Mayr */
.item-thumb{
  width: 150px; height: 150px;             /* se quiser mais: 56x56 */
  border-radius: 8px;
  background: #2a2a2a;
  object-fit: cover;
  box-shadow: inset 0 0 0 1px #444;
}

/* select mais ‚Äúfofo‚Äù e com respiro */
.item-select{
  width: 100%;
  background:#1f1f1f; color:#fff;
  border:1px solid #555; border-radius:999px;
  padding: 10px 14px;                    /* era 8px 12px */
}

/* descri√ß√£o com mais espa√ßo e alinhada sob IMG+select */
.item-subdesc{
  grid-column: 2 / span 2;               /* ocupa coluna da IMG + select */
  margin-top: 8px;                        /* era 6px */
  font-size: 12px; opacity: .85;
}

/* d√° um espa√ßo extra entre os blocos */
.item-modal .item-row-inline + .item-row-inline{
  margin-top: 120px;
}
/* === Grid de 2 colunas no modal === */
.item-modal .items-grid{
  display:grid;
  grid-template-columns: 1fr 1fr;           /* coluna esquerda | direita */
  column-gap: 28px;                          /* espa√ßo entre colunas */
  row-gap: 18px;
  align-items:start;
  margin-top: 6px;
}

/* coluna direita ganha um divisor sutil √† esquerda */
.item-modal .items-col + .items-col{ position:relative; }
.item-modal .items-col + .items-col::before{
  content:"";
  position:absolute; left:-14px; top:0; bottom:0; width:1px;
  background: rgba(255,255,255,.08);
}

/* linhas internas no formato: label | IMG | select */
.item-row-inline{
  display:grid;
  grid-template-columns: 150px 56px 1fr;     /* label | img | select */
  column-gap: 16px; row-gap: 8px;
  align-items:center;
  margin: 6px 0;
}
.item-row-inline > div:first-child{          /* o r√≥tulo (Memory / Potential...) */
  align-self:start; padding-top: 6px;
}
.item-thumb{
  width: 75px; height: 75px; border-radius: 10px;
  background:#2a2a2a; object-fit:cover;
  box-shadow: inset 0 0 0 1px #444;
}
.item-select{
  width:100%; background:#1f1f1f; color:#fff;
  border:1px solid #555; border-radius:999px;
  padding:10px 14px;
}
.item-subdesc{
  grid-column: 2 / span 2;                   /* fica alinhado sob IMG+select */
  font-size:12px; opacity:.85; margin-top:8px;
}

/* linha ‚ÄúStats preview‚Äù continua em 2 colunas padr√£o (label | conte√∫do) */
.item-row{
  display:grid; grid-template-columns: 150px 1fr;
  column-gap: 16px; align-items:start; margin: 6px 0;
}
/* --- Badge s√≥ com √≠cones --- */
/* === Badge com √≠cones que se ajustam ao tamanho === */
.item-badge{
  --icon: 37px;                 /* ajuste aqui o tamanho do √≠cone (18‚Äì28px) */
  display:flex; gap:6px; align-items:center;
  position:absolute; bottom:4px; right:6px;
  background:rgba(0,0,0,.60);
  border:1px solid rgba(255,255,255,.25);
  border-radius:8px; padding:3px 6px; z-index:4;
}

/* cada ‚Äúslot‚Äù de √≠cone */
.item-badge .ico{
  position:relative;
  width:var(--icon); height:var(--icon);
  border-radius:4px; overflow:hidden;
  box-shadow: inset 0 0 0 1px rgba(255,255,255,.35);
  background:#222;
}

/* a imagem cobre 100% do slot, sem distorcer */
.item-badge .ico img{
  position:absolute; inset:0;
  width:100% !important;
  height:100% !important;
  object-fit:cover;
  display:block;
}

/* etiqueta ‚ÄúM/4/2‚Äù (opcional) escala com o tamanho do √≠cone */
.item-badge .tag{
  position:absolute; right:-2px; bottom:-2px;
  padding:0 2px;
  font-size:calc(var(--icon) * 0.42);
  line-height:1.05;
  background:rgba(0,0,0,.85); color:#fff;
  border:1px solid rgba(255,255,255,.35); border-radius:3px;
}
/* --- Layout 3 colunas: label | IMG | select --- */
.items-3col{ display:grid; row-gap:18px; }

.row-3col{
  display:grid;
  grid-template-columns: 120px 120px 1fr; /* label | img | select */
  column-gap:18px; align-items:center;
}

.row-3col .label{ align-self:center; padding-top:4px; }

.big-thumb{
  width:120px; height:80px;           /* ajuste como preferir */
  border-radius:10px;
  background:#2a2a2a;
  box-shadow:inset 0 0 0 1px #444;
  object-fit:cover;
}

.select-wide{
  width:100%; background:#1f1f1f; color:#fff;
  border:1px solid #555; border-radius:10px;
  padding:10px 12px;
}

.subdesc{ font-size:12px; opacity:.85; margin-top:8px; }

/* Stats em lista vertical */
.stats-list{ list-style:none; margin:0; padding:0; }
.stats-list li{
  margin:6px 0;
  font-family:ui-monospace, Menlo, Consolas, monospace;
  background:#1e1e1e; border:1px solid #444; border-radius:10px;
  padding:6px 10px;
}
.stats-list li b{ margin-right:6px; }
.hex.drop-ok, .bench-slot.drop-ok { outline: 2px dashed #9cf; }
.hex.drop-bad, .bench-slot.drop-bad { outline: 2px dashed #f66; }
/* t√≠tulo + badge lado a lado */
.synergy-header{ display:flex; align-items:baseline; gap:12px; margin-bottom:8px; }
.team-type-badge{ font-size:.95rem; font-weight:600; opacity:.9; }
.multi-teams{ display:flex; align-items:center; gap:10px; margin:10px 0 16px; }
.team-tabs{ display:flex; gap:8px; flex-wrap:wrap; }
.team-tab{
  padding:6px 12px; border-radius:9999px; border:1px solid #444;
  background:#2a2a2a; color:#ddd; cursor:pointer; font-weight:600;
}
.team-tab.active{ background:#3a3a3a; border-color:#666; }
.add-team{
  padding:6px 10px; border-radius:8px; border:1px solid #444;
  background:#2f6; color:#000; font-weight:700; cursor:pointer;
}
.team-tab.editing{ pointer-events:auto; }
.team-tab-edit{
  width:120px; max-width:160px;
  background:transparent; color:inherit;
  border:1px dashed #777; border-radius:9999px;
  padding:4px 8px; outline:none; font:inherit; font-weight:600;
}
.multi-teams, #teamBar {
  display: flex;
  justify-content: center;   /* <‚Äî centraliza horizontalmente */
  align-items: center;
  gap: 10px;
  margin: 10px 0 16px;
}
    /* impede scroll no fundo quando o modal est√° aberto */
body.modal-open {
  overflow: hidden;
}

/* backdrop j√° √© fixed e centraliza; s√≥ adiciono padding e conten√ß√£o de overscroll */
.item-modal-backdrop{
  position:fixed; inset:0;
  background:rgba(0,0,0,.6);           /* alpha v√°lido (antes estava 6) */
  display:flex; align-items:center; justify-content:center;
  padding:16px;                         /* respiro nas bordas em zoom alto */
  overscroll-behavior: contain;         /* evita ‚Äúvazar‚Äù scroll para o body */
  z-index:5000;
}

/* painel do modal com limite de altura e rolagem pr√≥pria */
.item-modal{
  background:#2b2b2b; color:#fff;
  width:min(640px,92vw);
  border-radius:12px; padding:14px;
  box-shadow:0 12px 32px rgba(0,0,0,.5);

  max-height: calc(100dvh - 32px);      /* cabe na tela */
  overflow: auto;                        /* rola por dentro */
}
/* fallback para navegadores sem dvh */
@supports not (height: 100dvh){
  .item-modal{ max-height: calc(100vh - 32px); }
}

/* barra de bot√µes sempre vis√≠vel no rodap√© do modal */
.item-actions{
  position: sticky;
  bottom: 0;
  background: rgba(43,43,43,.95);
  border-top: 1px solid #444;
  margin-top:12px;
  padding:8px 0;
  display:flex; gap:8px; justify-content:flex-end;
}
.recommend-panel{
  display:flex; flex-direction:column; gap:8px; 
  align-items:center; margin:10px 0 16px;
}
.recommend-panel .row{ display:flex; flex-wrap:wrap; gap:12px; align-items:center; justify-content:center; }
.recommend-panel label{ color:#ddd; font-weight:600; display:flex; gap:6px; align-items:center; }
.recommend-panel input[type="range"]{ width:120px; }
.recommend-panel button{
  padding:6px 12px; border-radius:10px; border:1px solid #444;
  background:#40f06a; color:#000; font-weight:800; cursor:pointer;
}
.recommend-bar{ display:flex; justify-content:center; margin:6px 0 10px; }

.recommend-panel{
  display:none;                     /* oculto por padr√£o */
  flex-direction:column; gap:8px;
  align-items:center; margin:6px 0 16px;
  padding:10px; border:1px solid #444; border-radius:10px; background:#2a2a2a;
}
.recommend-panel.open{ display:flex; }  /* abre quando adicionamos .open */

.recommend-panel .row{ display:flex; flex-wrap:wrap; gap:12px; align-items:center; justify-content:center; }
.recommend-panel label{ color:#ddd; font-weight:600; display:flex; gap:6px; align-items:center; }
.recommend-panel input[type="range"]{ width:120px; }

.recommend-bar button,
.recommend-panel button{
  padding:6px 12px; border-radius:10px; border:1px solid #444;
  background:#40f06a; color:#000; font-weight:800; cursor:pointer;
}
.type-prefs{ border:1px solid #444; border-radius:8px; padding:6px 10px; }
.type-prefs legend{ padding:0 6px; font-size:.9rem; color:#bbb; }
.type-prefs label{ font-weight:500; }
.banner-img{
  width: 40px; height: 40px; object-fit: contain;
  background:#0003; border-radius:8px; border:1px solid #3a3a3a; display:block;
}
/* collapse da coluna esquerda */
body.planner-collapsed .panel.sources { display:none !important; }
body.planner-collapsed .planner-wrap { grid-template-columns: 1fr !important; }

/* bot√£o compacto */
.btn.mini{ padding:4px 8px; font-size:.85rem; border-radius:7px; }
/* reserva largura para a coluna System */
#tblFree td.col-System, #tblFree th.col-System { width: 260px; }
#tblCash td.col-System, #tblCash th.col-System { width: 260px; }

/* inputs de texto com largura m√≠nima e sem cortar texto */
.grid-table input[type="text"]{
  min-width: 240px;      /* garante leitura */
  white-space: nowrap;   /* n√£o quebra no meio */
  text-overflow: clip;   /* sem "..." cortando */
  overflow: visible;
}
/* container por m√™s */
.month-group{ margin:14px 0 18px; }
.month-title{ font-weight:800; margin:0 0 8px; opacity:.9; }


/* cart√£o */
.banner-card{
  background:#1e1e1e; border:1px solid #3a3a3a; border-radius:12px; padding:10px;
}
.banner-card h5{ margin:0 0 6px; font-size:.95rem; opacity:.9; }
.banner-card img{ width:160px; height:210px; object-fit:cover; display:block; border-radius:10px; border:1px solid #3a3a3a; }
.banner-fields label{ display:block; font-size:.95rem; margin-top:6px; }
.banner-fields input{ width:100%; background:#1d1d1d; color:#fff; border:1px solid #555; border-radius:8px; padding:6px 8px; }

.rebanner-col{ grid-column: 1 / -1; display:flex; justify-content:center; }
/* Reabrir fontes quando colapsado */
#reopenSources {
  position: fixed; left: 14px; bottom: 18px; z-index: 10000;
  background:#ffd54f; color:#222; border:0; font-weight:800;
  padding:8px 12px; border-radius:10px; cursor:pointer;
  box-shadow:0 3px 0 rgba(0,0,0,.25); display:none;
}
body.planner-collapsed #reopenSources { display:block; }

/* Coluna central de rebanners pode ter 1..N cart√µes empilhados */
.rebanner-col { grid-column: 1 / -1; display:flex; flex-direction:column; gap:18px; align-items:center; }

/* Linhas informativas (Tickets/Mem√≥rias/Cashback) no cart√£o */
.banner-lines { margin-top:10px; font-weight:700; line-height:1.6; }
.banner-lines span { display:block; }

.banner-card img{ display:block; margin:0 auto; }
body.planner-collapsed .panel.sources{ display:none !important; }
body.planner-collapsed .planner-wrap{ grid-template-columns: 1fr  }

.rebanners-row{ display:flex; gap:18px; justify-content:center; }
/* Alinha o bot√£o √† direita no cabe√ßalho do painel */
#synergy-panel .synergy-header{ justify-content: space-between; }

/* Lista dentro do modal (apresenta√ß√£o dos bonds) */
.stats-bond-list{ background:#2a2a2a; border:1px solid #444; border-radius:10px; padding:10px; }
.stats-bond-item{ margin:10px 0; }
.stats-bond-item h4{ margin:0 0 6px; font-size:1rem; }
.stats-bond-item ul{ margin:0; padding-left:16px; }
.stats-bond-item li{ margin:4px 0; font-family: ui-monospace, Menlo, Consolas, monospace; }
/* --- Stats bonds (modal) --- */
.stats-bond-item ul li{display:flex;align-items:center;gap:8px;margin:6px 0;}
.stats-char-thumb{width:28px;height:28px;border-radius:50%;object-fit:cover;border:1px solid #444}

/* a√ß√µes no rodap√© do modal */
.item-actions{display:flex;gap:8px;justify-content:flex-end;align-items:center}

/* picker de ‚Äúpersonagens da conta‚Äù */
.owned-picker{display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:8px;
  max-height:50vh;overflow:auto;margin-top:8px}
.owned-card{display:flex;gap:8px;align-items:center;padding:6px;border:1px solid #555;border-radius:10px}
.owned-card input{margin-left:auto}

/* pills de Stat Bonds no painel lateral */
.pill{display:inline-block;padding:4px 10px;border-radius:14px;border:1px solid #666;
  cursor:pointer;margin:3px 4px;font-size:.95em;background:#222}
.pill:hover{background:#2a2a2a}
.subdesc{opacity:.9;margin-top:8px}
/* Cabe√ßalho de cada bond + bot√£o See details */
.stats-bond-head{display:flex;justify-content:space-between;align-items:center;gap:8px}
.see-details-btn{font-size:.85em;padding:3px 8px;border:1px solid #666;border-radius:8px;background:#222;cursor:pointer}
.see-details-btn:hover{background:#2a2a2a}

/* Lista de personagens "faltando" (fora do time) */
.missing-char{color:#ff5c5c;font-style:italic}
/* Deixa o planner id√™ntico aos outros bot√µes do menu */
#sidebar #openPlannerBtn,
#openPlannerBtn.menu-link.bond-btn{
  background-color:#444;
  color:#fff;
  border:1px solid #666;
  border-radius:6px;
  padding:4px 8px;
  font-size:14px;
  cursor:pointer;
  transition:background-color .2s, transform .2s;
  box-shadow:none;
  font-weight:normal;
}
#sidebar #openPlannerBtn:hover{ background-color:#666; transform:scale(1.05); }
#sidebar #openPlannerBtn:active{ background-color:#888; transform:scale(.98); }
/* === Planner em tela cheia === */
#pagePlanner{
  position: fixed;      /* vira um overlay */
  inset: 0;             /* top/right/bottom/left = 0 */
  width: 100vw;
  height: 100vh;
  margin: 0;
  padding: 16px clamp(12px,2vw,24px) 24px;
  background: #121212;  /* usar a cor do seu tema, se tiver vari√°vel */
  z-index: 999;         /* acima do restante da UI */
  overflow: auto;       /* rolagem interna */
}

/* evita ‚Äúcaixa‚Äù estreita por max-width herdado */
#pagePlanner .container,
#pagePlanner .planner-box,
#pagePlanner .planner-wrap,
#pagePlanner .planner-grid{
  max-width: none !important;
  width: 100% !important;
}

/* mant√©m cabe√ßalho/toolbar vis√≠vel enquanto rola o planner */
#pagePlanner .planner-header{
  position: sticky;
  top: 0;
  z-index: 1;
  background: inherit;
  padding-bottom: 8px;
}

/* quando o planner est√° aberto, trava o scroll do body atr√°s */
body.planner-open{ overflow: hidden; }
/* ===== Planner: layout em duas colunas ===== */
#pagePlanner .planner-two-col{
  display: grid;
  grid-template-columns: minmax(640px, 1fr) minmax(360px, 30vw);
  gap: 16px;
  align-items: start;
}

/* permite o conte√∫do da coluna esquerda encolher corretamente */
#pagePlanner .planner-main{ min-width: 0; }

/* Simula√ß√£o fixa ao rolar (dentro do overlay fullscreen) */
#pagePlanner .planner-sim{
  position: sticky;
  top: 12px;                 /* ajuste se tiver header fixo Mayr */
  max-height: calc(100vh - 24px);
  overflow: auto;
  /* apar√™ncia opcional */
  background: #1a1a1a;
  border: 1px solid #333;
  border-radius: 12px;
  padding: 12px;
}

/* cards/linhas de m√™s ocupam toda a largura dispon√≠vel */
#plannerMonths > *{ width: 100%; }

/* responsivo: empilha em telas menores */
@media (max-width: 1100px){
  #pagePlanner .planner-two-col{
    grid-template-columns: 1fr;
  }
  #pagePlanner .planner-sim{
    position: static;
    max-height: none;
  }
}
.banner-card{
  width: 320px;          /* mesma idea do .rebanner-card */
  margin: 0 auto;        /* centraliza dentro da coluna */
  flex: 0 0 320px;       /* evita ‚Äúesticar‚Äù */
}
@media (max-width: 1200px){
  .banner-card{ width: 280px; } /* opcional, igual aos rebanners menores */
}
/* ===== Modal gen√©rica ===== */
.modal-overlay{
  position: fixed; inset: 0; display: none;
  align-items: center; justify-content: center;
  z-index: 2000;  /* acima do planner */
}
.modal-overlay.open{ display: flex; }
.modal-backdrop{
  position: absolute; inset: 0; background: rgba(0,0,0,.55);
}
.modal-dialog{
  position: relative;
  width: clamp(780px, 80vw, 1100px);
  max-height: 90vh;
  background: #1b1b1b;
  border: 1px solid #333; border-radius: 14px;
  box-shadow: 0 20px 60px rgba(0,0,0,.6);
  overflow: hidden; display: flex; flex-direction: column;
}
.modal-header{
  display: flex; justify-content: space-between; align-items: center;
  padding: 10px 14px; background: #222; border-bottom: 1px solid #333;
  position: sticky; top: 0; z-index: 1;
}
.modal-body{
  padding: 12px; overflow: auto;
  max-height: calc(90vh - 56px);
}

/* trava scroll atr√°s da modal */
body.modal-open{ overflow: hidden; }

/* quando o painel est√° dentro da modal, deixe ele ocupar 100% */
.modal-body .panel.sources{ margin: 0; width: 100%; box-sizing: border-box; }
/* Alternador de servidor (JP / CN) */
.server-switch{
  display:flex; gap:8px; justify-content:center; margin:6px 0 12px;
}
.server-btn{
  background:#2a2a2a; color:#ddd; border:1px solid #444;
  padding:6px 12px; border-radius:10px; cursor:pointer; font-weight:700;
}
.server-btn:hover{ background:#333; border-color:#666; color:#fff; }
.server-btn.active{ background:#3a3a3a; border-color:#777; color:#fff; }
/* Grade fluida: cabe 1 ou 2 cards por linha conforme espa√ßo disponible */
.month-row{
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(var(--card-w), 1fr));
  gap: 16px 24px;               /* gap menor ajuda a fechar com a Simula√ß√£o */
  align-items: start;
}
.rebanner-card{ width: var(--card-w); }
/* Reduz larguras s√≥ nos campos do painel de Simula√ß√£o */
#simPane #simInputs label { display: flex; align-items: center; gap: 10px; }

/* Garante que estes inputs n√£o ocupem 100% da coluna */
#simPane #simInputs input { width: auto; }

/* Larguras finais: n√∫mero e data */
#simPane #simInputs .planner-input[type="number"] { width: 140px; }   /* Saldo inicial */
#simPane #simInputs .planner-input[type="date"]   { width: 170px; }   /* Data de in√≠cio */


/* WIN 999 DIAMONDS */
.win-diamonds-btn {
  position: fixed;       /* recalculo a posi√ß√£o perto do grid via JS */
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 300px;
  height: 144px;
  padding: 0 18px;
  border-radius: 14px;
  background: linear-gradient(180deg, #1ee196 0%, #12b886 100%);
  color: #0b0b0b;
  font-weight: 800;
  font-size: 18px;
  letter-spacing: .3px;
  border: none;
  box-shadow: 0 10px 24px rgba(0,0,0,.35), inset 0 -2px 0 rgba(0,0,0,.25);
  cursor: pointer;
  z-index: 9999;
  transition: transform .08s ease, box-shadow .08s ease, opacity .2s ease;
}
.win-diamonds-btn:hover { transform: translateY(-1px); }
.win-diamonds-btn:active { transform: translateY(0); box-shadow: 0 6px 18px rgba(0,0,0,.35); }

@media (max-width: 900px){
  /* em telas menores, fixa no canto inferior direito */
  .win-diamonds-btn {
    right: 16px !important;
    bottom: 16px !important;
    left: auto !important;
    top: auto !important;
  }
}
.mini-line{ display:inline-flex; gap:4px; vertical-align:middle; margin-right:6px; }
.mini-char{ width:24px; height:32px; object-fit:cover; border-radius:4px; box-shadow:0 0 0 1px #444; }
.top-row-li{ display:flex; align-items:center; gap:6px; justify-content:center; }
.btn-more{ background:#2a2a2a; color:#ddd; border:1px solid #555; border-radius:8px; padding:2px 8px; cursor:pointer; }
.btn-imp,.btn-cmt{ margin-left:4px; }
.char-row { display:flex; align-items:center; justify-content:space-between; gap:.5rem; }
.char-row .mini-line { display:flex; align-items:center; gap:.5rem; }
.char-row .char-name { opacity:.9; }
/* --- Mobile helpers --- */
.bench-slot{ position: relative; } /* garante que o bot√£o fique preso no slot */

@media (pointer: coarse){
  .mob-pick{
    outline: 2px solid #ffd54f;
    outline-offset: 2px;
  }

  .mob-rm{
    position:absolute;
    top:2px; left:2px;
    width:20px; height:20px;
    border:0;
    border-radius:999px;
    font-weight:900;
    line-height:20px;
    cursor:pointer;
    z-index:5;
    opacity:.95;
  }
}
/* MOBILE: permitir drag sem o browser transformar em scroll/zoom */
@media (pointer: coarse) {
  .hex, .bench-slot {
    touch-action: none;            /* <- o pulo do gato */
    -webkit-user-select: none;
    user-select: none;
  }
}
/* Descri√ß√£o ‚Äúabre/fecha‚Äù abaixo do bot√£o (Skills/Bonds) */
.reveal-desc{
  margin-top: 8px;
  padding: 10px 12px;
  background: #1e1e1e;
  border: 1px solid #444;
  border-radius: 10px;
  font-size: 13px;
  line-height: 1.35;
  text-align: left;
  white-space: normal;
}
.reveal-desc ul{ margin: 8px 0 0 18px; }
.reveal-desc i{ opacity: .85; }



</style>
</head>
<body>

<button id="menuBtn">‚ò∞</button>
<div class="sidebar" id="sidebar">
    <button class="close-btn" id="closeSidebar">√ó</button>
    <h2>Side Menu</h2>
    <ul>
        <div id="view-stats" style="display:flex;gap:16px;justify-content:center;align-items:center;margin-top:6px;opacity:.95">
  <span>Daily Views: <strong id="visits-today">‚Äî</strong></span>
  <span>Total: <strong id="visits-total">‚Äî</strong></span>
</div>
        <!-- substitu√≠ EStat√≠sticas por Save/Load -->
        <li><button class="menu-link bond-btn" data-section="save">üíæ Salvar & Carregar Times</button></li>
        <li><button class="menu-link bond-btn" data-section="characters">üîç Personagens</button></li>
        <li><button class="menu-link bond-btn" data-section="schools">üè´ Escolas</button></li>
        <li><button class="menu-link bond-btn" data-section="help">‚ÑπÔ∏è Info</button></li>
        <li><button id="openPlannerBtn" class="menu-link bond-btn">üíé Planejador de Recursos</button></li>
        <li><button id="btnOpenRanking" type="button" data-sidebar-safe="true">üèÜ Ranking</button></li>
        <li><button id="btnXpCalc" class="menu-link bond-btn">üéØ Calculadora XP</button></li>
      </ul>
    <div id="sidebar-content">
        <p>Selecione uma op√ß√£o acima.</p>
    </div>
</div>

<h1>Haikyu Fly High - Team Builder by Devoy Aces</h1>

<div id="multiTeams" class="multi-teams">
  <div id="teamTabs" class="team-tabs"></div>
  <button id="addTeamBtn" class="add-team" type="button">+ Team</button>
</div>

<div class="team-grid">
    <div class="row top-row">
        <div class="player-slot"><div class="hex" data-role="S"></div><div class="player-info">S</div></div>
        <div class="player-slot"><div class="hex" data-role="MB"></div><div class="player-info">MB</div></div>
        <div class="player-slot"><div class="hex" data-role="WS"></div><div class="player-info">WS</div></div>
    </div>
    <div class="row">
        <div class="player-slot"><div class="hex" data-role="L"></div><div class="player-info">L</div></div>
        <div class="player-slot"><div class="hex" data-role="WS"></div><div class="player-info">WS</div></div>
        <div class="player-slot"><div class="hex" data-role="MB"></div><div class="player-info">MB</div></div>
        <div class="player-slot"><div class="hex" data-role="OP"></div><div class="player-info">OP</div></div>
    </div>

    <!-- linha onde fica o bot√£o SALVAR e os bench slots -->
    <div class="row" id="bench-row-wrapper" style="align-items:center;">

        <div class="row" id="bench-row" style="gap:10px;">
            <div class="player-slot bench"><div class="bench-slot" data-role="bench"></div><div class="player-info">Banco</div></div>
            <div class="player-slot bench"><div class="bench-slot" data-role="bench"></div><div class="player-info">Banco</div></div>
            <div class="player-slot bench"><div class="bench-slot" data-role="bench"></div><div class="player-info">Banco</div></div>
            <button class="add-slot-btn" onclick="addBenchSlot()">+</button>
        </div>
         <div id="bench-toolbar" style="display:flex; align-items:center; gap:10px; margin-top:8px;">
    <button id="rotateBtn" title="Rotate clockwise" style="background-color:#222222;color:white;padding:6px 10px; border:none; border-radius:5px; font-size:16px; cursor:pointer;margin-right:8px;">‚Üª</button>
    <button id="saveTeamBtn" title="Save Team" style="background-color:#222222;margin-right:8px;">‚¨áÔ∏è</button>
    <button id="clearTeamBtn" title="Clear Team" style="background-color:#222222; color:white; padding:6px 10px; border:none; border-radius:5px; font-size:16px; cursor:pointer;margin-right:55px;">üóëÔ∏è</button>
    <button id="recommendBtn" title="Recommend based on highest synergies possible"style="background-color:#222222; color:white; padding:6px 10px; border:none; border-radius:5px; font-size:16px; cursor:pointer;margin-right:55px;">‚≠ê</button>
</div>
    </div>
</div>

<!-- Painel de sliders (inicialmente oculto) -->
<div id="recoPanel" class="recommend-panel">
  <div class="row">
    <label>Sinergias
      <input id="wSynergy" type="range" min="0" max="5" step="0.5" value="3">
      <span id="wSynergyVal">3</span>
    </label>
    <label>√Çncora
      <input id="wAnchor" type="range" min="0" max="5" step="0.5" value="1">
      <span id="wAnchorVal">1</span>
    </label>
    <label>Tipo do time
      <input id="wTeamType" type="range" min="0" max="5" step="0.5" value="1.5">
      <span id="wTeamTypeVal">1.5</span>
    </label>
    <label>Stats
      <input id="wStats" type="range" min="0" max="5" step="0.5" value="1">
      <span id="wStatsVal">1</span>
    </label>
  </div>
  <div class="row">
  <label><input id="allowCrossRole" type="checkbox" checked> Permitir cross-role (exceto L)</label>

  <fieldset class="type-prefs">
    <legend>Tipo do time</legend>
    <label><input type="checkbox" id="prefQuick"> Quick</label>
    <label><input type="checkbox" id="prefPower"> Power</label>
    <label><input type="checkbox" id="prefBlock"> Block</label>
    <label><input type="checkbox" id="prefReceive"> Reception</label>
  </fieldset>

  <button id="runRecommendBtn" type="button">Aplicar</button>
  <button id="closeRecoBtn" type="button">Fechar</button>
</div>
</div>

<div class="scroll-menu" id="scrollMenu"></div>

<div id="synergy-panel">
  <div class="synergy-header" style="justify-content:space-between;">
    <h2>Sinergias</h2>
    <button id="statsBondBtn" class="btn mini" type="button" title="Mostrar v√≠nculos de stats">
      Stats bonds
    </button>
  </div>
  <ul id="synergy-list">
    <li>Apenas vinculos de posicionamento ser√£o mostrados.Elas apenas funcionam quando os membros dela ent√£o em quadra. Para ver as demais clique em "Stats bonds".</li>
  </ul>
</div>
<!-- QR LivePix fixo na esquerda -->
<a href="https://livepix.gg/gondif" target="_blank" rel="noopener" id="livepixQr">
  <img src="https://api.qrserver.com/v1/create-qr-code/?data=https://livepix.gg/gondif&size=120x120" 
       alt="LivePix QR - gondif" />
</a>

<style>
  #livepixQr {
    position: fixed;
    left: 16px;      /* dist√¢ncia da borda esquerda */
    bottom: 16px;    /* fica no canto inferior, sempre vis√≠vel */
    z-index: 9999;   /* garante que fica por cima de outros elementos */
  }
  #livepixQr img {
    width: 100px;    /* tamanho do QR (ajuste como quiser) */
    height: auto;
    border-radius: 8px; /* opcional: cantos arredondados */
    box-shadow: 0 0 8px rgba(0,0,0,0.5); /* opcional: sombra */
  }
</style>
<script>
/* ====== DADOS (mantidos) ====== */
const characters = [
{ nome: "Kageyama UR", data: "01/12/26", funcao: "S", img: "img/kageyamaUR.png", School: "Karasuno", vinculo: ["Dupla Exc√™ntrica", "G√™nios Karasuno","Rei e Grande Rei"], Stats:{Serve:1783,Spike:1680,Set:1869,Receive:1508,Block:1682,Save:1415}, habilidades:[
  {nome:"Levantador G√™nio", descricao:"Kageyama Tobio realiza um levantamento com poder de [Passe] √ó 120/135/150%. Ao levantar, o [Ataque R√°pido] do companheiro que vai atacar √© aumentado em [Passe] √ó 15%. Esse efeito dura at√© a bola passar para o outro lado da rede."},
  {nome:"Saque Assassino", descricao:"Kageyama Tobio realiza um Saque em Suspens√£o forte com uma pot√™ncia de 130/145/160% de seu [Saque]. Se essa jogada for um saque perfeito, a [T√©cnica de Ataque] de seus colegas de time √© aumentada em 10%. Esse efeito dura at√© a bola cruzar a rede 6 vezes."},
  {nome:"Rei Silencioso", descricao:"Aumenta a [T√©cnica de Ataque] de Kageyama Tobio em 8/10/12%. Quando ele est√° na quadra e o Saque, o Ataque R√°pido ou a Cortada do oponente for uma boa jogada, Kageyama ganha 1 ac√∫mulo do efeito de [Empenho Competitivo] at√© 5 ac√∫mulos. Quando ele est√° na quadra e um aliado saca, faz um Ataque R√°pido ou faz uma Cortada, 1 ac√∫mulo do efeito de [Empenho Competitivo] √© consumido, e a [Percep√ß√£o] do jogador executando o Saque, Ataque R√°pido ou Cortada √© aumentado em 20/25/30%. Esse efeito dura at√© a bola passar pro outro lado da rede duas vezes. No come√ßo de um rally, Kageyama ganhar√° um ac√∫mulo do efeito de [Empenho Competitivo]"},
  {nome:"Dominar o Jogo", descricao:"Kageyama Tobio executa um Ataque R√°pido com poder equivalente a 240/255/270/285/300% do levantamento. O Ataque R√°pido n√£o pode ser bloqueado. O tempo de recarga da habilidade de bloqueio da linha de frente do oponente aumenta em 4√ó o n√∫mero de cruzamentos de rede ocorridos."},
  {nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Aumenta os atributos b√°sicos em 13%.</li><li>S2: [For√ßa] do Kageyama aumenta em 20%. 1 - Se o efeito &quot;Competitivo&quot; for consumido, aumenta em 15% o atibuto [Percep√ß√£o] do aliado que for realizar um Saque/Largada/Ataque R√°pido ou Potente, durando esse efeito at√© 2 cruzamentos de rede. 2 - Se em alguma jogada do Kageyama o efeito &quot;Competitivo&quot; for consumido, recebe 1 ac√∫mulo desse efeito, aumentando a for√ßa dessa jogada em [For√ßa do atributo do tipo da jogada, ex: Saque, Passe, etc.] x 15%. Aumenta em mais 20% de [Percep√ß√£o]. Esse efeito dura at√© 2 passadas. 3 - Quando possui mais de 3 ac√∫mulos do efeito &quot;Competitivo&quot;, aumenta em 10% o atributo [T√©cnica de Ataque] do aliado que for realizar um Saque/Largada/Ataque R√°pido ou Potente. Esse efeito dura at√© 2 cruzamentos de rede.</li><li>S4: O atributo [Passe] do Kageyama aumenta em 15%. Quando Kageyama est√° em quadra e o aliado for realizar um Ataque R√°pido/Potente, a cada 500 de for√ßa do atributo [Passe] do Kageyama, aumenta em 6% o atributo [For√ßa] do membro a atacar. O aumento ocorre at√© no m√°ximo 60%. Quando Kageyama ativa uma habilidade, o CD de suas outras habilidades diminui 1 cruzamento de rede.</li>"}
], symbols: [ "img/quicksymbol.png", "img/servesymbol.png", "img/settersymbol.png" ] },

{ nome: "Kageyama SSR", funcao: "S", img: "img/kageyamaSR.png", School: "Karasuno", vinculo: [], Stats:{Serve:1402,Spike:1328,Set:1470,Receive:1189,Block:1329,Save:1117}, habilidades:[
  {nome:"SAQUE COMPLICADO", descricao:"TOBIO KAGEYAMA (Treino) realiza um Saque em Suspens√£o com 120% do atributo Saque como poder."},
  {nome:"OBSERVADOR AFIADO", descricao:"TOBIO KAGEYAMA (Treino) realiza um Levantamento com 115% do atributo Levantamento como poder; para essa jogada, a For√ßa dos atacantes do seu lado aumenta em 10%"},
  {nome:"ASCENS√ÉO DO CAMPE√ÉO", descricao:"Enquanto TOBIO KAGEYAMA (Treino) estiver presente, aumenta a Percep√ß√£o dos jogadores do seu lado em 10% e aumenta a pot√™ncia da Cortada em 6% dos atributos Ataque Potente/Ataque R√°pido do jogador"},
  {nome:"LARGADA SURPRESA", descricao:"TOBIO KAGEYAMA (Treino) realiza uma Largada do Levantador imposs√≠vel de bloquear com 225% do atributo Passe como poder"},
  {nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Atributos b√°sicos +10%.</li><li>S2: [Unexpected Attack] ‚Äî Efeito adicional: No Two Attack desta jogada, Kageyama Tobio (Treino) recebe [Percep√ß√£o] e [Poder] +10%. Pelas pr√≥ximas 2 trocas, os aliados recebem [Percep√ß√£o] e [Poder] +5%.</li><li>S4: Quando o Spike de um aliado (Power Attack ou Quick Attack) for Nice Play, o tempo de recarga de [Unexpected Attack] √© reduzido em 8 passagens de rede.</li>"}
], symbols: [ "img/quicksymbol.png", "img/servesymbol.png", "img/settersymbol.png" ] },

{ nome: "Hinata SP", data: "01/27/26", funcao: "MB", img: "img/hinataSP.png", School: "Karasuno", vinculo: ["Dupla Exc√™ntrica", "Observa√ß√£o de flores de cerejeira" , "Sol vs Lua"], Stats:{Serve:1663,Spike:1950,Set:1580,Receive:1856,Block:1758,Save:1579}, habilidades:[
  {nome:"Manipular o Momento", descricao:"Quando Hinata Shoyo (Hanami) est√° em quadra, a [T√©cnica de Defesa] de todos os jogadores da linha de frente aumenta em 10/13/16%. Quando o resultado da jogada de Hinata Shoyo for Perfeita, sua [T√©cnica de Ataque] aumenta em 3/3.5/4% com no m√°ximo 4 ac√∫mulos."},
  {nome:"Um Apoio", descricao:"Hinata Shoyo (Hanami) recebe uma bola com 140/160/180% de [Recep√ß√£o] como poder e os atributos base do seu time aumentam em 12%. Esse efeito dura por 6 cruzamentos de rede."},
  {nome:"Contra-ataque", descricao:"Quando Hinata Shoyo (Hanami) est√° na linha de tr√°s, a [T√©cnica de Defesa] dos aliados na linha de tr√°s aumenta em 10/13/16%. Quando ele est√° em quadra e a recep√ß√£o do time n√£o for RUIM, seu [Ataque R√°pido] aumenta em 12/16/20% pelos pr√≥ximos dois cruzamentos de rede. Se a recep√ß√£o do companheiro for Perfeita, o Ataque R√°pido de Hinata Shoyo (Hanami) ap√≥s essa jogada aumenta em 100%."},
  {nome:"Salto Alto", descricao:"Hinata Shoyo (Hanami) realiza um Ataque R√°pido com 260/275/290% de [Ataque R√°pido] como poder. Se for Perfeita, a pot√™ncia aumenta em mais 40/45/50% de [Ataque R√°pido]."},
  {nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Aumenta os atributos b√°sicos em 13%.</li><li>S2: [T√©cnica de Ataque] do Hinata aumenta em 20%. 1 - Se o Ataque R√°pido do Hinata se tornar uma Jogada Cr√≠tica, esse Ataque n√£o ser√° bloqueado e os atributos [Percep√ß√£o] e [Reflexo] dos advers√°rios s√£o reduzidos em 10%. Esse efeito permanece at√© 3 cruzamentos de rede. 2 - Se Hinata marcar ponto com esse Ataque R√°pido, os atributos [Percep√ß√£o] e [Reflexo] dos advers√°rios s√£o reduzidos em mais 10%. Esse efeito permanece at√© 3 cruzamentos de rede.</li><li>S4: O atributo [For√ßa] do Hinata aumenta em 30%. 1 - Ao iniciar a partida, o atributo [Percep√ß√£o] do Hinata √© reduzido para 0% e a cada 1% diminuido, o atributo [For√ßa] do Hinata aumenta em 2.5%. 2 - Se o Ataque R√°pido do Hinata resultar em uma Jogada R√°pida, seu atributo [For√ßa] aumenta em [Percep√ß√£o] x 40%, chegando at√© no m√°ximo 60%.</li>"}
], symbols: [ "img/quicksymbol.png", "img/receivesymbol.png" ] },

{ nome: "Hinata SSR", funcao: "MB", img: "img/hinataSR.png", School: "Karasuno", vinculo: ["Dupla Exc√™ntrica"], Stats:{Serve:1251,Spike:1475,Set:1191,Receive:1275,Block:1333,Save:1336}, habilidades:[
  {nome: "O GRANDE CHAMARIZ", descricao:"Enquanto SHOYO HINATA estiver presente, aumenta os atributos Ataque Potente/Ataque R√°pido dos jogadores do seu lado em 7%"},
  {nome: "DUO DE ATAQUE R√ÅPIDO", descricao:"Quando SHOYO HINATA realiza uma Cortada R√°pida e o jogador que est√° passando √© do tipo Ataque R√°pido, aumenta a pot√™ncia dessa cortada em 15% do atributo Ataque R√°pido do jogador"},
  {nome: "UNO COM A BOLA", descricao:"Aumenta a Percep√ß√£o de SHOYO HINATA em 6%; quando HINATA realiza uma jogada Superior, aumenta a Percep√ß√£o em mais 4%, at√© 1 ac√∫mulos"},
  {nome: "JOVEM ALADO", descricao:"SHOYO HINATA realiza uma Cortada R√°pida com 235% do atributo Ataque R√°pido como poder; quando essa cortada conquista um resultado Superior, aumenta seu poder em 20% do atributo Ataque R√°pido"},
  {nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Atributos b√°sicos +10%.</li><li>S2: Mudan√ßa de efeito ‚Äî em Nice Play, o b√¥nus de [Percep√ß√£o] agora acumula at√© 3 (antes m√°x. 1).</li><li>S4: Se o Quick Attack do Shoyo Hinata for Nice Play, a recarga de <JOVEM ALADO> √© redefinida.</li>"}
], symbols: [ "img/quicksymbol.png" ] },

{ nome: "Nishinoya SP", data: "03/13/26", funcao: "L", img: "img/nishinoyaSP.png", School: "Karasuno", vinculo: ["G√™nios Karasuno", "Depois da Escola"], Stats:{Serve:1615,Spike:1615,Set:1769,Receive:1950,Block:1571,Save:1862}, habilidades:[
  {nome:"Acelera√ß√£o de Classe Mundial", descricao:"O [Reflexo] de Nishinoya Yu (Depois da Escola) aumenta em 10/13/16%. Quando um membro do time advers√°rio faz uma jogada Perfeita, o [Reflexo] de Nishinoya Yu (Depois da Escola) aumenta em 1.5%, at√© 10 ac√∫mulos. Dura at√© a bola cruzar a rede 6 vezes."},
  {nome:"Passe A", descricao:"O [Reflexo] de Nishinoya Yu (Depois da Escola) aumenta em 10/13/16%. Quando um membro do time advers√°rio faz uma jogada Perfeita, o [Reflexo] de Nishinoya Yu (Depois da Escola) aumenta em 1.5%, at√© 10 ac√∫mulos. Dura at√© a bola cruzar a rede 6 vezes."},
  {nome:"Salvar o Time na Crise", descricao:"O [Empenho] de Nishinoya Yu (Depois da Escola) aumenta em 20/25/30%. Quando um aliado faz uma jogada Perfeita, o tempo de recarga da Recep√ß√£o com o P√© √© reduzido em um cruzamento de rede."},
  {nome:"Recep√ß√£o com o P√©", descricao:"Nishinoya Yu (Depois da Escola) executa uma recep√ß√£o com 260/275/290% de [Recep√ß√£o] como poder. A [Recep√ß√£o] dele aumenta em 20%. Dura por dois cruzamentos de rede."},
  {nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Aumenta os atributos b√°sicos em 13%.</li><li>S2: Mudan√ßa na habilidade 3 do Nishinoya: 1 - Ao inv√©s de a condi√ß√£o ser &gt;Jogada Cr√≠tica do aliado&lt; para diminuir o CD da habilidade 4, vira &gt;Jogada Cr√≠tica do aliado ou advers√°rio&lt;.  2 - Quando o Passe do Nishinoya for uma Jogada Cr√≠tica, diminui 1 passada da bola pela rede do CD da habilidade  4 e os atributos b√°sicos dos aliados aumentam e 12%, permanecendo ese efeito por at√© 3 cruzamentos de rede.</li><li>S4: 1 - Quando Nishinoya est√° em quadra, aumenta o atributo [Reflexo] dos aliados em 10%. 2 - Quando Nishinoya est√° em quadra e o Ataque R√°pido/Potente do advers√°rio resultar em uma Jogada Cr√≠tica, o atributo [Reflexo] dos aliados da Linha de Defesa/Atr√°s aumenta em 15%, permanecendo esse efeito por at√© 4 cruzamentos de rede.</li>"}
], symbols: [ "img/receivesymbol.png", "img/settersymbol.png" ] },

{ nome: "Nishinoya SSR", funcao: "L", img: "img/nishinoyaSR.png", School: "Karasuno", vinculo: ["Deus Guardi√£o e Ponta" , "Esquadr√£o de Kiyoko"], Stats:{ Serve:1206, Spike:1206, Set:1338, Receive:1483, Block:1172, Save:1416 }, habilidades:[
  {nome: "DEUS GUARDI√ÉO", descricao:"Quando o resultado do teste de resist√™ncia de YU NISHINOYA n√£o for RUIM, aumenta o poder da pr√≥xima habilidade de Cortada Potente usada pelo seu jogador do tipo Pot√™ncia em 15% de seu atributo Ataque Potente."},
  {nome: "L√çBERO EXCEPCIONAL", descricao:"YU NISHINOYA realiza uma Defesa com 120% do atributo Defesa como poder"},
  {nome: "REFOR√áO DE MORAL", descricao:"Quando YU NISHINOYA entra na quadra, aumenta o Moral do seu lado em 18"},
  {nome: "ROLLING THUNDER", descricao:"YU NISHINOYA consome 20 de Vigor adicional para realizar uma recep√ß√£o com 220% da pot√™ncia do atributo Recep√ß√£o; se o resultado da Recep√ß√£o n√£o for RUIM, reduz a recarga da pr√≥xima habilidade de Cortada Potente do seu lado em 6 cruzamentos de rede"},
  {nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Atributos b√°sicos +10%.</li><li>S2: <Rolling Thunder> ‚Äî Mudan√ßa e efeito adicional: o custo extra de Stamina ao ativar passa a ser 10; a for√ßa desta Recep√ß√£o aumenta ainda mais em [Recep√ß√£o] √ó 10%.</li><li>S4: Para o Nishinoya, a primeira Recep√ß√£o e Cobertura de cada set recebem b√¥nus ‚Äî Recep√ß√£o +[Recep√ß√£o] √ó 30%, Cobertura +[Cobertura] √ó 30%; essa jogada ser√° sempre pelo menos NORMAL.</li>"}
], symbols: [ "img/receivesymbol.png" ] },

{ nome: "Tanaka SSR", funcao: "WS", img: "img/tanakaSR.png", School: "Karasuno", vinculo: ["Esquadr√£o de Kiyoko"], Stats:{ Serve:1270, Spike:1475, Set:1194, Receive:1403, Block:1330, Save:1203 }, habilidades:[
  {nome: "ENTRADA DO ACE", descricao:"Aumenta a pot√™ncia da 1¬∞ Cortada Potente de RYUNOSUKE TANAKA em cada partida em 25% do atributo Ataque Potente"},
  {nome: "ESP√çRITO OBSTINADO", descricao:"RYUNOSUKE TANAKA realiza uma Recep√ß√£o com 115% do atributo Recep√ß√£o como poder; para essa Recep√ß√£o, o Reflexo de TANAKA aumenta em 10%"},
  {nome: "PAIX√ÉO ARDENTE", descricao:"Aumenta a pot√™ncia da Cortada Potente de RYUNOSUKE TANAKA em 10% do atributo Ataque Potente; sua Cortada Potente reduz o bloqueio do advers√°rio e o Vigor dos jogadores receptores em 5"},
  {nome: "SUPERCORTADA INTERNA", descricao:"RYUNOSUKE TANAKA consome 5 de Vigor extra para realizar uma Cortada Curta na Diagonal com 250% do atributo Ataque Potente como poder. Se essa for a 1¬∞ cortada de TANAKA no set, aumenta a pot√™ncia da cortada em mais 30% do atributo Ataque Potente de TANAKA"},
  {nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Atributos b√°sicos +10%.</li><li>S2: <Vanguard Leader> ‚Äî Mudan√ßa de efeito: a jogada fortalecida muda de ‚Äúo 1¬∫ Power Attack de cada set‚Äù para ‚Äúat√© o 2¬∫ Power Attack de cada set‚Äù.</li><li>S4: Se marcar ponto com <SUPERCORTADA INTERNA>, os aliados em quadra recebem [Power Attack] +40%. Ativa 1 vez por set.</li>"}
], symbols: [ "img/powersymbol.png" ] },

{ nome: "Tsuki SP", funcao: "MB", img: "img/tsukiSP.png", School: "Karasuno", vinculo: ["Sol vs Lua","Festival Fogos de Artificio","Aliados no Campo de Treinamento"], Stats:{Serve:1668,Spike:1948,Set:1579,Receive:1661,Block:1769,Save:1753}, habilidades:[
  {nome:"Grande C√©rebro", descricao:"Quando um membro do time advers√°rio estiver sob um efeito desfavor√°vel, a [Percep√ß√£o] e o [Reflexo] de Tsukishima Kei (Festival de Fogos de Artif√≠cio) aumentam em 15/20/25%, e a [T√©cnica de Ataque] e a [T√©cnica de Defesa] dos aliados aumentam em 10%. Dura por 1 rali. Quando um aliado ativa uma habilidade de bloqueio, o [Ataque R√°pido] de Tsukishima Kei (Festival de Fogos de Artif√≠cio) aumenta em 3% (at√© 10 ac√∫mulos). Quando um aliado ativa uma habilidade de Ataque R√°pido, o [Bloqueio] de Tsukishima Kei (Festival de Fogos de Artif√≠cio) aumenta em 3% (at√© 10 ac√∫mulos)."},
  {nome:"Bloqueio √© um Sistema", descricao:"Tsukishima Kei (Festival de Fogos de Artif√≠cio) bloqueia com poder de [Bloqueio] √ó 300/325/350%. Aumenta o [Reflexo] dos defensores traseiros aliados em 10% e o [Empenho] em 20%. Dura at√© a bola cruzar a rede duas vezes."},
  {nome:"Observar Calmamente a Situa√ß√£o", descricao:"No in√≠cio da partida, se a [T√©cnica de Ataque] de Tsukishima Kei (Festival de Fogos de Artif√≠cio) for ‚â• a [T√©cnica de Defesa], ele recebe o efeito [Ataque I/II/III]; caso contr√°rio, recebe [Defesa I/II/III]. Com [Ataque I/II/III], o tempo de recarga de 'Bloqueio √© um Sistema' √© reduzido em 4√ó o n√∫mero de cruzamentos de rede, mas a pot√™ncia dessa habilidade √© reduzida em [Bloqueio] √ó 100/80/60%. [Ataque R√°pido] √© reduzido em 20/30/40."},
  {nome:"Ataques que Aproveitam sua Altura", descricao:"Tsukishima Kei (Festival de Fogos de Artif√≠cio) realiza um Ataque R√°pido com pot√™ncia de [Ataque R√°pido] √ó 260%/280%/300%/320%/340%. Se algum oponente tiver efeito desfavor√°vel, a pot√™ncia desse ataque r√°pido aumenta em [Ataque R√°pido] √ó 60%."},
  {nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Aumenta os atributos b√°sicos em 13%.</li><li>S2: Se Tsukishima possui o efeito [Ataque], seus atributos [T√©cncia de Ataque] aumenta em 15% e [T√©cnica de Defesa] aumenta em 20%. Se Tsukishima possui o efeito [Defesa], seus atributos [T√©cncia de Defesa] aumenta em 15% e [T√©cnica de Ataque] aumenta em 20%. Mudan√ßa na habilidade 1:- A condi√ß√£o para o aumento do [Ataque R√°pido] altera de [Quando o aliado ativa uma habilidade de Bloqueio] para [Quando o aliado ativa uma habilidade de Bloqueio/Quando Tsukishima toca na bola/Quando o advers√°rio sob efeito Debuff toca na bola]. A condi√ß√£o para o aumento do [Bloqueio] altera de [Quando o aliado ativa uma habilidade de Ataque R√°pido] para [Quando o aliado ativa uma habilidade de Ataque R√°pido/Quando Tsukishima toca na bola/Quando o advers√°rio sob efeito Debuff toca na bola]</li><li>S4: Os atributos [Empenho] e [For√ßa] do Tsukishima aumentam em 40%. Se o Bloqueio do Tsukishima resultar em uma Jogada Cr√≠tica, a for√ßa desse Bloqueio ter√° um aumento de atributo [Bloqueio] x 40%. Aplica efeito Debuff [F√∫ria] nos advers√°rios da Linha de Ataque/Frente, reduzindo em 10% o atributo [Ataque R√°pido/Potente] deles. Se o Ataque R√°pido do Tsukishima resultar em uma Jogada Cr√≠tica, a for√ßa desse Ataque ter√° um aumento de [Ataque R√°pido] x 40%. Esse Ataque n√£o pode ser bloqueado.</li>"}
], symbols: [ "img/quicksymbol.png", "img/blocksymbol.png" ] },

{ nome: "Tsuki SSR", funcao: "MB", img: "img/tsukiSR.png", School: "Karasuno", vinculo: [], Stats: { Serve:1291, Spike:1403, Set:1229, Receive:1251, Block:1481, Save:1176 }, habilidades:[
  {nome: "COMPOSTURA DO KARASUNO", descricao:"Enquanto KEI TSUKISHIMA estiver presente, aumenta a For√ßa dos jogadores do tipo Ataque R√°pido do seu lado em 10%"},
  {nome: "ATAQUE R√ÅPIDO T√ÅTICO", descricao:"KEI TSUKISHIMA realiza uma Cortada R√°pida com 115% do atributo Ataque R√°pido. Quando um jogador do seu lado usar uma habilidade de Cortada, aumenta a Percep√ß√£o desse jogador em 5%"},
  {nome: "NASCER DA LUA", descricao:"Enquanto KEI TSUKISHIMA estiver presente, aumenta a pot√™ncia de Bloqueio dos jogadores da linha de ataque do seu lado em 8% do atributo Bloqueio deles"},
  {nome: "R√âPLICA DO KEI", descricao:"KEI TSUKISHIMA realiza um Bloqueio com 195% do atributo Bloqueio como poder; aplica a Penalidade ‚ÄúProvocar‚Äù ao atacante advers√°rio (reduz os atributos Ataque Potente/Ataque R√°pido em 10%)"},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Atributos b√°sicos +10%.</li><li>S2: Quando o Tsukishima bloquear, os aliados que fizerem Recep√ß√£o recebem [Recep√ß√£o] +3% (acumula at√© 3).</li><li>S4: <Sauda√ß√µes> ‚Äî Efeito adicional: ap√≥s ativar, aplica [Raiva] na linha de frente inimiga ([Power Attack]/[Quick Attack] ‚àí10%).</li>"}
], symbols: [ "img/quicksymbol.png", "img/blocksymbol.png" ] },

{ nome: "Daichi SSR", funcao: "OP", img: "img/daichiSR.png", School: "Karasuno", vinculo: [], Stats: { Serve:1260, Spike:1333, Set:1197, Receive:1476, Block:1331, Save:1271 }, habilidades:[
  {nome: "RECEP√á√ÉO SEGURA", descricao:"Quando DAICHI SAWAMURA realiza uma Recep√ß√£o, restaura 3 de Vigor do jogador com o menor Vigor do seu lado"},
  {nome: "CORTADA MARRETA", descricao:"DAICHI SAWAMURA realiza uma Cortada Potente com 120% do seu atributo Ataque Potente"},
  {nome: "ALICERCE DO TIME", descricao:"Enquanto DAICHI SAWAMURA estiver presente, a pot√™ncia de Recep√ß√£o dos jogadores da linha de defesa do seu lado aumenta em 10% do atributo Recep√ß√£o deles"},
  {nome: "DEFESA CONFI√ÅVEL", descricao:"DAICHI SAWAMURA realiza uma Recep√ß√£o com 220% do seu atributo Recep√ß√£o. Se a pr√≥xima Cortada do seu lado for uma Cortada Potente, aumenta a pot√™ncia dessa cortada em 15% do atributo Ataque Potente do atacante"},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Atributos b√°sicos +10%.</li><li>S2: A recarga de <Steadfast Defense> passa a ser de 4 passagens de rede.</li><li>S4: <Steadfast Defense> ‚Äî Efeito adicional: ap√≥s esta jogada ativar, a primeira habilidade de Power Attack recebe poder extra igual a [Power Attack] √ó 25%, e o consumo de Stamina √© reduzido em 50%.</li>"}
], symbols: [ "img/receivesymbol.png" ] },

{ nome: "Azumane SSR", funcao: "WS", img: "img/azumaneSR.png", School: "Karasuno", vinculo: ["Deus Guardi√£o e Ponta"], Stats: { Serve:1410, Spike:1478, Set:1191, Receive:1337, Block:1269, Save:1196 }, habilidades:[
  {nome: "DEFESA PROFICIENTE", descricao:"ASAHI AZUMANE realiza uma Recep√ß√£o com 120% do atributo Recep√ß√£o como poder"},
  {nome: "SAQUE R√ÅPIDO", descricao:"ASAHI AZUMANE realiza um Saque em Suspens√£o com 120% do atributo Saque como poder"},
  {nome: "AURA DO ACE", descricao:"Quando o Vigor de ASAHI AZUMANE estiver acima de 70, a pot√™ncia de sua Cortada Potente aumenta em 15% do atributo Ataque Potente"},
  {nome: "CORTADA CARREGADA", descricao:"ASAHI AZUMANE consome 30 de Vigor adicional para realizar uma Cortada Potente com 235% do atributo Ataque Potente como poder, recebendo 1 ac√∫mulos de ‚ÄúCarga de Poder‚Äù; ao usar a habilidade [CORTADA CARREGADA], cada ac√∫mulo de ‚ÄúCarga de Poder‚Äù aumenta a pot√™ncia da Cortada Potente em 50% do atributo Ataque Potente"},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Atributos b√°sicos +10%.</li><li>S2:PROFICIENT DEFENSE: consumo de Stamina reduzido para 0; CHARGED SPIKE modificado: consumo adicional de Stamina reduzido para 20.</li><li>S4:CHARGED SPIKE ‚Äî Novo Efeito: cada ac√∫mulo do Buff ‚ÄúPower Charge‚Äù aumenta o poder deste Power Spike em +60% do atributo Power Attack.</li>"}
], symbols: [ "img/powersymbol.png", "img/servesymbol.png" ] },

{ nome: "Sugawara SP", data: "04/12/26", funcao: "S", img: "img/sugawaraSP.png", School: "Karasuno", vinculo: ["Depois da Escola"], Stats:{Serve:1856,Spike:1746,Set:1950,Receive:1580,Block:1758,Save:1487}, habilidades:[
  {nome:"Apoiar o Ataque", descricao:"Quando Sugawara Koshi (Depois da Escola) est√° em quadra e um aliado da linha de frente ativa uma habilidade de bloqueio, o [Bloqueio] do bloqueador aumenta em 5/6.25/7.5% √ó a soma do [Bloqueio] do outro aliado da linha de frente (m√°ximo 1000/1250/1500). Dura at√© a bola cruzar a rede duas vezes. Quando ele est√° em quadra e um aliado da linha de tr√°s recebe, a [Recep√ß√£o] do recebedor aumenta em 5/6.25/7.5% √ó a soma da [Recep√ß√£o] do outro aliado da linha de tr√°s (m√°x. 1000/1250/1500). Dura at√© a bola cruzar a rede duas vezes."},
  {nome:"Saque habilidoso que explora fraquezas", descricao:"Sugawara Koushi (Depois da Escola) executa um Saque com poder [Serve] √ó 140/160/180%. Aumenta a Moral do Time em 10. Aumenta os atributos base dos aliados em 12/14/16% por 1 rali."},
  {nome:"Prepara√ß√£o Cuidadosa", descricao:"Sugawara Koushi (Depois da Escola) aumenta o Vigor em 13/16/20%. Na primeira participa√ß√£o dele, os aliados consomem 50% do Vigor atual deles e, a cada 6 Vigores consumidos, os atributos base dos aliados aumentam em 1%/1.3%/1.6%. Ap√≥s a primeira participa√ß√£o, os aliados recuperam 15 de Vigor ao fim de cada rali, por 4 ralis."},
  {nome:"Jogada Sinalizada", descricao:"Sugawara Koushi (Depois da Escola) consome 15 de Vigor extra e realiza um levantamento com 60% ([Passe] √ó 2) / 80% ([Passe] √ó 2) / 300% / 20% ([Passe] √ó 3) / 40% ([Passe] √ó 3) de poder. O primeiro companheiro a atacar (Ataque Potente/Ataque R√°pido) ap√≥s essa jogada aumenta a [T√©cnica de Ataque] em 2.0% at√© a bola cruzar a rede duas vezes."},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Aumenta os atributos b√°sicos em 13%.</li><li>S2: Se Sugawara estiver com menos de 80 de Vigor, ao tocar na bola ele recupera 5 de Vigor. Quando Sugawara est√° em quadra e o time aliado pontuar, o aliado que pontuar recupera 10 de Vigor e seus atributos [Reflexo] e [Percep√ß√£o] aumentam em 8%, esse efeito acumula at√© 2 vezes.</li><li>S4: 1- Quando Sugawara est√° em quadra, aumenta os atributos b√°sicos dos aliados em 10%. 2 - Quando Sugawara est√° em quadra e o time aliado pontua, aumenta em 4% o atributo [T√©cnica de Ataque] dos aliados, permanecendo o efeito por 8 passadas e acumula at√© 3 vezes. 3 - Quando Sugawara est√° em quadra e o time advers√°rio pontua, aumenta em 4% o atributo [T√©cnica de Defesa] dos aliados, permanecendo o efeito por 8 cruzamentos de rede e acumula at√© 3 vezes. 4 - Se no rally em que o time advers√°rio pontuou a bola tiver passado menos de 5 vezes pela rede, aumenta em mais 4% o atributo [T√©cnica de Defesa] dos aliados, permanecendo o efeito por 8 cruzamentos de rede e acumula at√© 3 vezes.</li>"}
], symbols: [ "img/blocksymbol.png", "img/servesymbol.png", "img/settersymbol.png" ] },

{ nome: "Kenma SP", data: "02/26/26", funcao: "S", img: "img/kenmaSP.png", School: "Nekoma", vinculo: ["Observa√ß√£o de flores de cerejeira","C√©rebro e Comandante SP"], Stats:{Serve:1669,Spike:1668,Set:1950,Receive:1856,Block:1665,Save:1576}, habilidades:[
  {nome:"Lideran√ßa", descricao:"Quando Kozume Kenma (Hanami) est√° em quadra, o [Reflexo] dos aliados aumenta em 10/13/16%. Ao estar em quadra e um aliado receber ou salvar, ele ganha 1 ac√∫mulo de [Defesa que Elimina Aberturas] e o [Reflexo] dos aliados aumenta em 1.5%, at√© 10 ac√∫mulos. Se o resultado da recep√ß√£o/defesa do aliado n√£o for RUIM, ganha mais 1 ac√∫mulo."},
  {nome:"Levantamento Sem Movimento Desperdi√ßado", descricao:"Kozume Kenma (Hanami) realiza um levantamento com 140/160/180% de [Passe] como poder. Se o atacante (Ataque Potente/Ataque R√°pido) ap√≥s essa jogada estiver na linha de tr√°s, o poder do ataque aumenta em 20%."},
  {nome:"Procurar Falhas", descricao:"Quando Kozume Kenma (Hanami) realiza um Passe ou uma Largada, sua [Percep√ß√£o] aumenta em 40/60/80% de [Reflexo] como poder. Se ele estiver em quadra e o bloqueio do aliado n√£o for RUIM, o poder da Cortada atual do oponente (Ataque Potente/Ataque R√°pido) aumenta em 10/13/16% do [Ataque Potente/Ataque R√°pido] correspondente (efeito de enfraquecimento para o oponente)."},
  {nome:"Jogada que Confunde o Advers√°rio", descricao:"Kozume Kenma (Hanami) realiza uma Largada com 255/270/285/300/315% de [Passe] como poder. N√£o pode ser bloqueado. Ap√≥s essa jogada, quando um oponente realizar a primeira Cortada (Ataque Potente/Ataque R√°pido), a [Pot√™ncia] desse jogador √© reduzido em 40% por 2 cruzamentos de rede."},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Aumenta os atributos b√°sicos em 13%.</li><li>S2: Quando Kenma for realizar um Passe/Largada, o pr√≥ximo Ataque R√°pido ou Potente/Largada que um aliado for fazer, aumentar√° o atributo [For√ßa] desse aliado em atributo [Reflexo do Kenma] x 100%. Esse efeito permanece at√© 2 cruzamentos de rede.</li><li>S4: A cada 1 ac√∫mulo do efeito [Defesa que Elimina Chances], diminui 1% do atributo [Percep√ß√£o] dos advers√°rios e diminui 2% do atributo [For√ßa] dos advers√°rios. 1 - Se o n√∫mero de ac√∫mulos dispon√≠vel passar de 8, diminui em mais 5% do atributo [Percep√ß√£o] e diminui em mais 10% do atributo [For√ßa] do advers√°rio. 2 - Quando Kenma est√° em quadra e o tima advers√°rio pontua, Kenma recebe 3 ac√∫mulos do efeito [Defesa que Elimina Chances].</li>"}
], symbols: [ "img/receivesymbol.png", "img/settersymbol.png" ] },

{ nome: "Kenma SSR", funcao: "S", img: "img/kenmaSR.png", School: "Nekoma", vinculo: ["C√©rebro e Comandante"], Stats:{Serve:1261,Spike:1393,Set:1479,Receive:1196,Block:1390,Save:1131}, habilidades:[
  {nome:"VIS√ÉO DIVINA", descricao:"Enquanto KENMA KOZUME estiver presente, aumenta a pot√™ncia de Recep√ß√£o dos jogadores do seu lado em 8% do atributo Recep√ß√£o deles; quando o resultado do passe de Kozume ou da Recep√ß√£o do seu lado for PERFEITO, recebe 1 ac√∫mulo do Potencializador [V√¥lei de Praia]. Cada ac√∫mulo aumenta o atributo Recep√ß√£o dos jogadores do seu lado em 3%, at√© 6 ac√∫mulos"},
  {nome:"LEVANTAMENTO FIRME", descricao:"KENMA KOZUME realiza um Passe com 120% do atributo Passe como poder"},
  {nome:"TIME CORA√á√ÉO", descricao:"Enquanto KENMA KOZUME estiver presente, aumenta a pot√™ncia de Recep√ß√£o dos jogadores do seu lado em 6% do atributo Recep√ß√£o deles; quando o Potencializador [V√¥lei de Praia] exceder 5 ac√∫mulos, aumenta a pot√™ncia de Recep√ß√£o dos jogadores do seu lado em 150% do atributo Recep√ß√£o e Defesa em 150%. Quando o jogador do seu lado falhar em uma Recep√ß√£o/Defesa, consome 6 ac√∫mulos do [V√¥lei de Praia] para mudar o resultado para PERFEITO"},
  {nome:"LARGADA ENGANOSA", descricao:"KENMA KOZUME realiza uma Largada do Levantador imposs√≠vel de bloquear com 220% do atributo Passe como poder"},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Atributos b√°sicos +10%.</li><li>S2: Ao ativar <Tricky Play>, recebe 2 ac√∫mulos de [Conectar].</li><li>S4: No in√≠cio de cada set, se o Kozume Kenma estiver em quadra, recebe 4 ac√∫mulos de [Conectar].</li>"}
], symbols: [ "img/receivesymbol.png", "img/settersymbol.png" ] },

{ nome: "Yaku SSR", funcao: "L", img: "img/yakuSR.png", School: "Nekoma", vinculo: ["Orienta√ß√£o Educacional"], Stats:{Serve:1206,Spike:1206,Set:1336,Receive:1483,Block:1172,Save:1412}, habilidades:[
  {nome:"MESTRE DA DEFESA", descricao:"Enquanto MORISUKE YAKU estiver presente, quando seu lado realizar uma Recep√ß√£o que n√£o seja RUIM, aumenta os atributos de Recep√ß√£o e Defesa de YAKU em 3%, acumulando at√© 5 vezes"},
  {nome:"ESCUDO CONFI√ÅVEL", descricao:"Enquanto MORISUKE YAKU estiver presente, aumenta a pot√™ncia de Cortada R√°pida dos jogadores do tipo Ataque R√°pido do seu lado em 8% do atributo Ataque R√°pido deles"},
  {nome:"L√çBERO DEFINITIVO", descricao:"Aumenta o atributo Recep√ß√£o de MORISUKE YAKU em 11%; quando o resultado da Recep√ß√£o de YAKU for NORMAL, muda para PERFEITO"},
  {nome:"RECEP√á√ÉO CONFI√ÅVEL", descricao:"MORISUKE YAKU realiza uma Recep√ß√£o com 240% do atributo Recep√ß√£o como poder"},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Atributos b√°sicos +10%.</li><li>S2: <Recep√ß√£o Imponente> ‚Äî Efeito adicional: o poder desta Recep√ß√£o aumenta em [Recep√ß√£o] √ó 20%.</li><li>S4: Quando o advers√°rio estiver em match point, [Recep√ß√£o] e [Cobertura] do Morisuke Yaku +10%.</li>"}
], symbols: [ "img/receivesymbol.png" ] },

{ nome: "Kuro SSR", funcao: "MB", img: "img/kuroSR.png", School: "Nekoma", vinculo: [], Stats:{Serve:1302,Spike:1405,Set:1224,Receive:1264,Block:1481,Save:1197}, habilidades:[
  {nome:"AURA DO ESPECIALISTA", descricao:"Enquanto TETSURO Kuro (Treino) estiver presente, aumenta a For√ßa dos jogadores do tipo Ataque R√°pido do seu lado em 16%"},
  {nome:"ATAQUE FERRENHO", descricao:"TETSURO Kuro (Treino) realiza uma Cortada R√°pida com 125% do atributo Ataque R√°pido como poder, recebe 1 ac√∫mulo de ‚ÄúCarga de Poder‚Äù; ao usar a habilidade [Ataque Ferrenho], cada ac√∫mulo de [Carga de Poder] aumenta a pot√™ncia da cortada em 15% do atributo Ataque R√°pido, at√© 2 ac√∫mulos"},
  {nome:"TORRE DE CONTROLE DO BLOQUEIO", descricao:"Enquanto TETSURO Kuro (Treino) estiver presente, aumenta o atributo Bloqueio dos jogadores do seu lado em 8%"},
  {nome:"BLOQUEIO TOTAL", descricao:"TETSURO Kuro (Treino) realiza um Bloqueio com 170% do atributo Bloqueio como poder; quando outros jogadores da linha de ataque do tipo Bloqueio est√£o presentes, aumenta a pot√™ncia desse bloqueio em 15% do atributo Bloqueio"},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Atributos b√°sicos +10%.</li><li>S2: <Stable Attack> ‚Äî Mudan√ßa de efeito: o efeito de [Charge] n√£o tem limite de ac√∫mulos.</li><li>S4: Ap√≥s <Full Block> ativar, aplica [Raiva] aos inimigos que fizerem Spike (Power Attack/Quick Attack): [Power Attack]/[Quick Attack] ‚àí10%.</li>"}
], symbols: [ "img/blocksymbol.png", "img/quicksymbol.png" ] },

{ nome: "Kuro UR", funcao: "MB", img: "img/kuroUR.png", School: "Nekoma", vinculo: ["C√©rebro e Comandante"], Stats:{Serve:1497,Spike:1616,Set:1406,Receive:1453,Block:1703,Save:1376}, habilidades:[
  {nome:"CAPIT√ÉO SUPREMO", descricao:"Aumenta o atributo Ataque R√°pido de TETSURO Kuro em 10%; enquanto Kuro estiver presente, cada vez que a bola cruzar a rede, aumenta seus atributos de Bloqueio e Ataque R√°pido em 5%, at√© 5 ac√∫mulos"},
  {nome:"ATAQUE R√ÅPIDO A", descricao:"TETSURO Kuro realiza uma Cortada R√°pida com 125% do atributo  Ataque R√°pido como poder; recebe 1 ac√∫mulo de ‚ÄúCarga de Poder‚Äù, cada ac√∫mulo de ‚ÄúCarga de Poder‚Äù aumenta a pot√™ncia da Cortada [Ataque R√°pido A] em 5% do atributo Ataque R√°pido, at√© 3 ac√∫mulos"},
  {nome:"CONDUTOR", descricao:"Aumenta o atributo Bloqueio de TETSURO Kuro em 14%; quando o resultado de um Bloqueio de Kuro for PERFEITO, aplica a penalidade ‚ÄúEnfurecer‚Äù ao atacante advers√°rio (reduz os atributos Ataque Potente/R√°pido em 10%)"},
  {nome:"BLOQUEIO REATIVO", descricao:"TETSURO Kuro realiza um Bloqueio com 235% do atributo Bloqueio como poder; quando o jogador advers√°rio que est√° cortando for afetado por uma penalidade, aumenta o poder desse bloqueio em mais 20% do atributo Bloqueio"},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Aumenta os atributos b√°sicos em 13%.</li><li>S2: O CD da habilidade 2 √© reduzido para 0 cruzamentos de rede.</li><li>S4: Mudan√ßa na habilidade 3: Para ativar essa habilidade a condi√ß√£o [se o Bloqueio de Kuroo for PERFECT] √© alterada para [Quando Kuroo for bloquear]. Esse bloqueio √© aumentado em for√ßa do atributo [Bloqueio] x 25%.</li>"}
], symbols: [ "img/quicksymbol.png", "img/blocksymbol.png" ] },

{ nome: "Lev SSR", funcao: "MB", img: "img/levSR.png", School: "Nekoma", vinculo: ["Orienta√ß√£o Educacional"], Stats:{Serve:1287,Spike:1407,Set:1213,Receive:1244,Block:1471,Save:1174}, habilidades:[
  {nome:"MUDAN√áA T√ÅTICA", descricao:"Enquanto LEV HAIBA estiver presente, e quando o seu lado conseguir uma recep√ß√£o PERFEITA, aumenta a pot√™ncia da pr√≥xima Cortada R√°pida dele em 15% do atributo Ataque R√°pido"},
  {nome:"BLOQUEIO DE MOMENTUM", descricao:"LEV HAIBA realiza um Bloqueio com 105% do atributo Bloqueio como poder"},
  {nome:"ATLETISMO NATURAL", descricao:"Quando LEV HAIBA realiza uma Cortada R√°pida e o jogador advers√°rio que est√° bloqueando tem uma penalidade, reduz a pot√™ncia de bloqueio dele em 10% do atributo Bloqueio do jogador que est√° bloqueando"},
  {nome:"CORTADA TALENTOSA", descricao:"LEV HAIBA realiza uma Cortada R√°pida com 245% do atributo Ataque R√°pido como poder"},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Atributos b√°sicos +10%.</li><li>S2: Quando o Lev Haiba bloquear, se o inimigo que fez o Spike (Power Attack/Quick Attack) estiver com um debuff, o [Bloqueio] do Lev Haiba +5%.</li><li>S4: <High-Point Spike> ‚Äî Efeito adicional: se o resultado do Toss de um aliado for PERFECT, o poder deste Quick Attack aumenta em [Quick] √ó 12%.</li>"}
], symbols: [ "img/quicksymbol.png", "img/blocksymbol.png" ] },

{ nome: "Aone SP", data: "06/18/26", funcao: "MB", img: "img/aoneSP.png", School: "Dateko", vinculo: ["Nata√ß√£o","Parede de Ferro"], Stats:{Serve:1865,Spike:1776,Set:1755,Receive:1581,Block:1911,Save:1491}, habilidades:[
  {nome:"Parede Poderosa", descricao:"O [Reflexo] de Aone Takanobu (Garotos da Praia) aumenta em 10/13/16%. Se o Vigor dele for menor que 80, seus [Bloqueio] e [Saque] aumentam em 10%. Ao bloquear, se o resultado for bloqueio duplo ou triplo, para cada membro bloqueador com habilidade de bloqueio, o poder do bloqueio aumenta em 20% do [Bloqueio] de Aone Takanobu (Garotos da Praia)."},
  {nome:"Saque em Suspens√£o que Motiva o Time", descricao:"Aone Takanobu (Garotos da Praia) realiza um Saque em Suspens√£o com 140/160/180% de [Saque] como poder. O tempo de recarga da habilidade do levantador oponente aumenta em 4√ó o n√∫mero de cruzamentos de rede. Ao sair da quadra, se Aone ativou o [Saque em Suspens√£o que Motiva o Time] durante a partida, a [T√©cnica de Ataque] e a [T√©cnica de Defesa] dos seus jogadores aumentam em 5%. Se os ac√∫mulos de [Bloqueio R√≠gido] forem 3 ou mais, aumentam em mais 5%. Dura at√© a pr√≥xima partida de Aone. (Cada ac√∫mulo de [Bloqueio R√≠gido] concede +10% de [Reflexo], m√°x. 20)."},
  {nome:"Paredes Fortes e Altas", descricao:"Quando Aone Takanobu (Garotos da Praia) est√° em quadra, cada vez que um oponente faz um ataque (Ataque Potente/R√°pido), o atacante ganha 1 ac√∫mulo de [Trancado]. No in√≠cio da partida, todos os oponentes ganham 1 ac√∫mulo de [Trancado]. Se o Aone Takanobu (Garotos da Praia) estiver na quadra e um oponente tiver 2 ac√∫mulos de [Trancado], esse oponente ir√° consumir todos os ac√∫mulos de [Trancado] dele, e o Aone Takanobu (Garotos da Praia) ganha [Bloqueio R√≠gido]. Com mais de 2 ac√∫mulos de [Bloqueio R√≠gido], o [Bloqueio] dele aumenta em 10% de [Bloqueio] como poder. Com mais de 4 ac√∫mulos de [Bloqueio R√≠gido], o tempo de recarga de [Bloqueio Afiado e Conduzido] cai para 8 cruzamentos de rede (12 ‚Üí 8). Com mais de 6 ac√∫mulos de [Bloqueio R√≠gido], o [Empenho] dele aumenta em 10%. Com mais de 8 ac√∫mulos de [Bloqueio R√≠gido], o tempo de recarga de [Bloqueio Afiado e Conduzido] cai para 4 cruzamentos de rede (8 ‚Üí 4)."},
  {nome:"Bloqueio Afiado e Conduzido", descricao:"Aone Takanobu (Garotos da Praia) bloqueia com 260/275/290/305/320% do [Bloqueio]. Aumenta a Moral do Time em 15."},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Aumenta os atributos b√°sicos em 13%.</li><li>S2: 1 - Quando Aone est√° em quadra e o time advers√°rio pontuar, todos os oponentes em quadra recebem 1 ac√∫mulo do efeito &quot;Foco&quot;. 2 - Quando possui 6 ac√∫mulos do efeito &quot;Bloqueio Resistente&quot;, o CD da habilidade 4 do Aone √© resetado. Isso ocorre 1 vez por rally.</li><li>S4: 1 - Quando Aone est√° no Banco, os aliados da Linha de Ataque/Frente recebem aumento de 25% no atributo [Bloqueio]. 2 - Quando o atributo [Reflexo] do Aone passar de 100%, a cada 1% a mais, aumenta 1% o seu atributo [Empenho], podendo aumentar at√© no m√°ximo 60%.</li>"}
], symbols: [ "img/blocksymbol.png", "img/servesymbol.png" ] },

{ nome: "Aone SSR", funcao: "MB", img: "img/aoneSR.png", School: "Dateko", vinculo: ["O Silencioso e o Sarc√°stico"], Stats:{Serve:1300,Spike:1403,Set:1223,Receive:1251,Block:1481,Save:1176}, habilidades:[
  {nome:"ACE DE BARREIRA", descricao:"Quando o resultado de um Bloqueio de TAKANOBU AONE for PERFEITO, marca o atacante advers√°rio, reduzindo a pot√™ncia da pr√≥xima cortada dele em 10% dos atributos Ataque Potente/Ataque R√°pido e aumentando o consumo de Vigor dele em 30%"},
  {nome:"ATAQUE FORTE", descricao:"TAKANOBU AONE realiza uma Cortada R√°pida com 120% do atributo Ataque R√°pido como poder"},
  {nome:"COBERTURA DE BLOQUEIO TOTAL", descricao:"Quando TAKANOBU AONE bloqueia, para cada jogador do tipo Bloqueio do seu lado (1), aumenta a pot√™ncia do Bloqueio em 1% do atributo Bloqueio; quando toda a linha de ataque (3 jogador(es)) for do tipo Bloqueio, aumenta a pot√™ncia do Bloqueio em mais 4% do atributo Bloqueio"},
  {nome:"PILAR DE FERRO", descricao:"TAKANOBU AONE realiza um Bloqueio com 195% do atributo Bloqueio como poder; ao bloquear a Cortada Potente de um advers√°rio, aumenta a pot√™ncia desse bloqueio em mais 9% do atributo Bloqueio"},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Atributos b√°sicos +10%.</li><li>S2: <Lock On> ‚Äî Mudan√ßa de efeito: a condi√ß√£o muda de ‚Äúquando o resultado do bloqueio do Aone Takanobu for PERFECT‚Äù para ‚Äúquando Aone Takanobu bloquear‚Äù.</li><li>S4: Quando Aone Takanobu bloquear, se o inimigo que fez o Spike (Power Attack/Quick Attack) estiver com Stamina ‚â§ 30%, o resultado deste bloqueio ser√° garantido como pelo menos NORMAL.</li>"}
], symbols: [ "img/quicksymbol.png", "img/blocksymbol.png" ] },

{ nome: "Futakuchi SSR", funcao: "WS", img: "img/futakuchiSR.png", School: "Dateko", vinculo: ["O Silencioso e o Sarc√°stico" , "O Novo Capit√£o e o Novato Alt√£o","Parede de Ferro"], Stats:{Serve:1299,Spike:1404,Set:1223,Receive:1262,Block:1476,Save:1196}, habilidades:[
  {nome:"AUTORIDADE DO CAPIT√ÉO", descricao:"Enquanto KENJI FUTAKUCHI estiver presente, aumenta a pot√™ncia do Bloqueio do seu lado em 8% do atributo Bloqueio de cada jogador"},
  {nome:"IN√çCIO DE ATAQUE", descricao:"KENJI FUTAKUCHI realiza um Saque em Suspens√£o com 120% do atributo Saque como poder"},
  {nome:"DEFESA CRESCENTE", descricao:"Enquanto KENJI FUTAKUCHI estiver presente, para cada jogador do tipo Bloqueio do seu lado (1), aumenta a pot√™ncia do Bloqueio em 0.5% do atributo Bloqueio"},
  {nome:"MURALHA DE FERRO INDESTRUT√çVEL", descricao:"KENJI FUTAKUCHI realiza um Bloqueio com 195% do atributo Bloqueio como poder; quando o jogador advers√°rio que est√° cortando for afetado por uma penalidade, aumenta o poder desse bloqueio em mais 10% do atributo Bloqueio"},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Atributos b√°sicos +10%.</li><li>S2: [Saque] do Futakuchi Kenji +10%.</li><li>S4: Quando Futakuchi Kenji bloquear, aplica [Raiva] no inimigo que realizou o Spike (Power Attack/Quick Attack): [Power Attack]/[Quick Attack] ‚àí10%.</li>"}
], symbols: [ "img/blocksymbol.png", "img/servesymbol.png" ] },

{ nome: "Sasaya SSR", funcao: "OP", img: "img/sasayaSR.png", School: "Dateko", vinculo: [], Stats:{Serve:1262,Spike:1471,Set:1194,Receive:1402,Block:1339,Save:1202}, habilidades:[
  {nome:"RESPOSTA CALMA", descricao:"Aumenta a Percep√ß√£o de TAKEHITO SASAYA em 5%; enquanto SASAYA estiver presente, aumenta o Reflexo dos jogadores do seu lado em 5%"},
  {nome:"DEFESA IMPENETR√ÅVEL", descricao:"TAKEHITO SASAYA realiza um Bloqueio com 105% do atributo Bloqueio como poder"},
  {nome:"MURALHA DE FERRO FORTIFICADA", descricao:"Enquanto TAKEHITO SASAYA estiver presente, quando seu lado estiver perdendo, aumenta a pot√™ncia da habilidade de Bloqueio do seu lado em mais 3% do atributo Bloqueio de cada jogador que estiver bloqueando e aumenta o Reflexo desses jogadores em 5%"},
  {nome:"JOGADA AGRESSIVA", descricao:"TAKEHITO SASAYA realiza uma Cortada Potente com 240% do atributo Ataque Potente como poder"},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Atributos b√°sicos +10%.</li><li>S2: Takehito Sasaya n√£o sofre efeitos negativos (debuffs). Se o time estiver atr√°s no placar, [Bloqueio] e [Power Attack] do Sasaya +10%.</li><li>S4: As recargas de <Seamless Defense> e <Powerful Attack> s√£o reduzidas em 2 passagens de rede.</li>"}
], symbols: [ "img/powersymbol.png" ] },

{ nome: "Koganegawa SSR", funcao: "S", img: "img/koganegawaSR.png", School: "Dateko", vinculo: ["O Novo Capit√£o e o Novato Alt√£o"], Stats:{Serve:1256,Spike:1402,Set:1470,Receive:1184,Block:1406,Save:1110}, habilidades:[
  {nome: "LEVANTADOR NOVATO", descricao: "KANJI KOGANEGAWA realiza um Passe com 120% do atributo Passe como poder"},
  {nome: "FA√çSCA DE BLOQUEIO", descricao: "KANJI KOGANEGAWA realiza um Bloqueio com 105% do atributo Bloqueio como poder; enquanto KANJI KOGANEGAWA estiver presente, ao bloquear a Cortada Potente de um advers√°rio, aumenta a pot√™ncia de Bloqueio do seu lado em 3% do atributo Bloqueio de cada jogador que estiver bloqueando"},
  {nome: "MURALHA DE FERRO III", descricao: "Enquanto KANJI KOGANEGAWA estiver presente, aumenta a pot√™ncia da habilidade de Bloqueio dos outros jogadores do seu lado em 2% do atributo Bloqueio de cada jogador que estiver bloqueando"},
  {nome: "LARGADA REL√ÇMPAGO", descricao: "KANJI KOGANEGAWA realiza uma Largada do Levantador imposs√≠vel de bloquear com 210% do atributo Passe como poder"},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Atributos b√°sicos +10%.</li><li>S2: Quando Kanji Koganegawa estiver na linha de frente, os inimigos em quadra t√™m [Power Attack] ‚àí4%.</li><li>S4: <New Secret Weapon> ‚Äî Efeito adicional: se todos os aliados da linha de frente forem membros de Bloqueio, o poder deste Two Attack aumenta em [Toss] √ó 15%.</li>"}
], symbols: [ "img/blocksymbol.png", "img/settersymbol.png" ] }, 

{ nome: "Oikawa UR", data: "09/14/25", funcao: "S", img: "img/oikawaUR.png", School: "Aoba Johsai", vinculo: ["Harmonia Perfeita"], Stats:{Serve:1705,Spike:1533,Set:1627,Receive:1378,Block:1530,Save:1290}, habilidades:[
  {nome:"LEVANTAMENTO DO GRANDE REI", descricao:"TORU OIKAWA realiza um Passe com 120% do atributo Passe como poder; quando os jogadores do seu lado conseguem uma Cortada Superior, eles recebem 1 ac√∫mulo de ‚ÄúTempo do Ataque‚Äù. Cada ac√∫mulo aumenta a Percep√ß√£o dos jogadores do seu lado em 1%, at√© 10 ac√∫mulos"},
  {nome:"LARGADA DO GRANDE REI", descricao:"TORU OIKAWA realiza uma Largada do Levantador imposs√≠vel de bloquear com 115% do atributo Passe como poder; enquanto OIKAWA estiver presente, aumenta a For√ßa dos jogadores do tipo Potente do seu lado em 20%"},
  {nome:"L√çDER DA QUADRA", descricao:"Enquanto TORU OIKAWA estiver presente, aumenta a Percep√ß√£o dos jogadores do seu lado em 10%; quando o jogador do seu lado usar uma habilidade de Cortada Potente, consome 6 ac√∫mulos do Potencializador [Tempo do Ataque] para garantir um resultado Superior para essa cortada"},
  {nome:"SAQUE EM SUSPENS√ÉO DO GRANDE REI", descricao:"TORU OIKAWA realiza um Saque em Suspens√£o Potente com 260% do atributo Saque como poder; para esse Saque, a Percep√ß√£o de OIKAWA aumenta em 20% e a For√ßa aumenta em 20%"},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Aumenta os atributos b√°sicos em 13%.</li><li>S2: [Saque] do Oikawa aumenta em 18%. Cada vez que o efeito &quot;Tempo do Ataque&quot; √© consumido aumenta o atributo [Saque Potente] dos aliados em 5%, acumulando at√© 5 vezes.</li><li>S4: Quando √© a vez de Oikawa sacar, os aliados em quadra recebem aumento dos atributos [Percep√ß√£o] e [For√ßa] em 15%, durando at√© 3 passadas da bola pela rede. Ap√≥s o saque de Oikawa, se at√© o per√≠odo de 2 cruzamentos de rede o time aliado tiver pontuado, √© resetado o CD da habilidade 4 do Oikawa.</li>"}
], symbols: [ "img/powersymbol.png", "img/servesymbol.png", "img/settersymbol.png" ] },

{ nome: "Oikawa SSR", funcao: "S", img: "img/oikawaSR.png", School: "Aoba Johsai", vinculo: [], Stats:{Serve:1483,Spike:1334,Set:1416,Receive:1198,Block:1332,Save:1123}, habilidades:[
  {nome:"VIS√ÉO DA QUADRA", descricao:"Aumenta o atributo Passe de TORU OIKAWA (Treino) em 10%; quando o jogador do seu lado usa uma habilidade de Cortada, recebe 1 ac√∫mulo do Potencializador [Tempo do Ataque], cada ac√∫mulo do Potencializador [Tempo do Ataque] aumenta a Percep√ß√£o dos jogadores do seu lado em 1%, at√© 10 ac√∫mulos"},
  {nome:"MUDAN√áA DE JOGO", descricao:"Enquanto TORU OIKAWA (Treino) estiver presente, no in√≠cio de cada turno, quando seu lado estiver perdendo, aumenta todos os atributos b√°sicos dos jogadores do seu lado em 6%, com dura√ß√£o de 8 cruzamentos de rede"},
  {nome:"TORRE DE COMANDO", descricao:"Enquanto TORU OIKAWA (Treino) estiver presente, aumenta a Percep√ß√£o dos jogadores do seu lado em 6%; cada ac√∫mulo do Potencializador [Tempo do Ataque] proporciona um aumento adicional de 1% na Percep√ß√£o dos jogadores do seu lado"},
  {nome:"SAQUE DUPLO SENTIDO", descricao:"TORU OIKAWA (Treino) realiza um Saque em Suspens√£o Potente com 240% do atributo Saque como poder; para esse Saque, a Percep√ß√£o de OIKAWA (Treino) aumenta em 15%, esse Saque tem uma chance fixa de 5% de falhar"},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Atributos b√°sicos +10%.</li><li>S2: <Saque Quase-Certo> ‚Äî Efeito adicional: Oikawa Tooru (Treino) n√£o erra Saques. Enquanto Oikawa (Treino) estiver sacando, [Percep√ß√£o] +15% e [Poder] +20%.</li><li>S4: <Saque Quase-Certo> ‚Äî Efeito adicional: ao ativar, recebe 2 ac√∫mulos de [Ritmo de Ataque]. Se esse Saque marcar ponto, a recarga √© redefinida.</li>"}
], symbols: [ "img/powersymbol.png", "img/servesymbol.png", "img/settersymbol.png" ] },

{ nome: "Iwazumi SSR", funcao: "WS", img: "img/iwazumiSR.png", School: "Aoba Johsai", vinculo: ["Harmonia Perfeita", "A Matilha"], Stats:{Serve:1269,Spike:1476,Set:1191,Receive:1402,Block:1332,Save:1203}, habilidades:[
  {nome:"FOR√áA DO ACE", descricao:"Aumenta a Percep√ß√£o de HAJIME IWAIZUMI em 5% e a For√ßa em 10%"},
  {nome:"DEFESA FOCADA", descricao:"HAJIME IWAIZUMI realiza uma Recep√ß√£o com 120% do atributo Recep√ß√£o como poder"},
  {nome:"APOIO DO VICE-CAPIT√ÉO", descricao:"Enquanto HAJIME IWAIZUMI estiver presente, aumenta a For√ßa dos jogadores do seu lado em 6%"},
  {nome:"MANO A MANO", descricao:"HAJIME IWAIZUMI realiza uma Cortada Potente com 240% do atributo Ataque Potente como poder; quando essa cortada conquistar um resultado Superior, aumenta sua pot√™ncia em 15% do atributo Ataque Potente"},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Atributos b√°sicos +10%.</li><li>S2: Se o Hajime Iwaizumi estiver em quadra, os aliados em quadra recebem [Poder] +15%.</li><li>S4: <Confronto Direto> ‚Äî Efeito adicional: neste Power Attack, o poder de Bloqueio do oponente √© reduzido em [Bloqueio] √ó 20% (com base no membro que bloquear).</li>"}
], symbols: [ "img/powersymbol.png" ] },

{ nome: "Kentaro MAD DOG SSR", funcao: "OP", img: "img/kentaroSR.png", School: "Aoba Johsai", vinculo: ["A Matilha"], Stats:{Serve:1408,Spike:1476,Set:1180,Receive:1318,Block:1258,Save:1183}, habilidades:[
  {nome:"ATAQUE FEROZ", descricao:"Aumenta a Percep√ß√£o de KENTARO KYOTANI em 8% e o atributo Ataque Potente em 5%"},
  {nome:"SAQUE CACHORRO LOUCO", descricao:"KENTARO KYOTANI realiza um Saque com 130% do atributo Saque como poder; para esse Saque, a Percep√ß√£o aumenta em 15%, com uma chance fixa de 10% de falhar"},
  {nome:"EXPLOS√ÉO DE FOR√áA", descricao:"Aumenta a For√ßa de KENTARO KYOTANI em 18%"},
  {nome:"PRESA DO CACHORRO LOUCO", descricao:"KENTARO KYOTANI realiza uma Cortada Potente com 210% do atributo Ataque Potente como poder, reduzindo o bloqueio do advers√°rio e o Vigor dos jogadores receptores em 10"},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Atributos b√°sicos +10%.</li><li>S2: Se o Power Attack do Kentaro Kyotani for Nice Play, o bloqueador e o recebedor inimigos perdem +5 de Stamina cada.</li><li>S4: <Explosive Power Attack> ‚Äî Efeito adicional: se o inimigo que Receber este Power Attack estiver com ‚â§50% de Stamina, o [Recep√ß√£o] desse membro ‚àí18%.</li>"}
], symbols: [ "img/powersymbol.png", "img/servesymbol.png" ] },

{ nome: "Ushijima UR", funcao: "OP", img: "img/ushijimaUR.png", School: "Shiratorizawa", vinculo: ["Bests para a vida", "Campe√£o Absoluto e Levantador S√≥lido"], Stats:{Serve:1626,Spike:1707,Set:1368,Receive:1537,Block:1459,Save:1367}, habilidades:[
  {nome:"NO RITMO", descricao:"Aumenta a Percep√ß√£o de WAKATOSHI USHIJIMA em 8%; enquanto USHIJIMA estiver presente, no encerramento de cada turno, aumenta a Percep√ß√£o dele em 3%"},
  {nome:"SAQUE DOMINADOR", descricao:"WAKATOSHI USHIJIMA realiza um Saque em Suspens√£o com 125% do atributo Saque como poder; quando esse saque se torna Superior, os jogadores receptores n√£o podem usar habilidades; ao marcar um Ace, reduz a recarga do SAQUE DOMINADOR em 4 cruzamentos de rede"},
  {nome:"ESTILO ACE", descricao:"Quando os jogadores do seu lado realizam jogadas Superiores, aumenta os Atributos B√°sicos de WAKATOSHI USHIJIMA em 1.5%, acumulando at√© 8 vezes; quando USHIJIMA marca, remove todos os efeitos de penalidade dele"},
  {nome:"ACE INCONTEST√ÅVEL", descricao:"WAKATOSHI USHIJIMA realiza uma Cortada Potente com 250% do atributo Ataque Potente como poder; quando USHIJIMA realiza um desempenho Superior, reduz a recarga de [ACE INCONTEST√ÅVEL] em 1 cruzamento de rede"},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Aumenta os atributos b√°sicos em 13%.</li><li>S2: O CD da habilidade4 √© reduzido para 4 passadas da bola pela rede. Se o aliado realizar uma Jogada Cr√≠tica, reduz 1 cruzamento de rede do CD da habilidade 4.</li><li>S4: Dobra o valor do atributo [Percep√ß√£o] de Ushijima. Quando Ushijima realiza uma Jogada Cr√≠tica, ele recupera 2 de Vigor.</li>"}
], symbols: [ "img/powersymbol.png", "img/servesymbol.png" ] },

{ nome: "Tendo SSR", funcao: "MB", img: "img/tendoSR.png", School: "Shiratorizawa", vinculo: ["Bests para a vida"], Stats:{Serve:1295,Spike:1402,Set:1217,Receive:1255,Block:1480,Save:1175}, habilidades:[
  {nome:"MAVERICK", descricao:"Aumenta o Reflexo de SATORI TENDO em 12%"},
  {nome:"ATAQUE R√ÅPIDO SURPRESA", descricao:"SATORI TENDO realiza uma Cortada R√°pida com 120% do atributo Ataque R√°pido como poder"},
  {nome:"BLOQUEIO DE JOGO MENTAL", descricao:"Quando SATORI TENDO realiza um Bloqueio Superior, a recarga do INSTINTO SELVAGEM √© reduzida em 1 cruzamento de rede"},
  {nome:"INSTINTO SELVAGEM", descricao:"SATORI TENDO realiza um Bloqueio com 220% do atributo Bloqueio como poder; ao bloquear a Cortada Superior de um advers√°rio, aumenta o Reflexo de TENDO em 15% para esse bloqueio"},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Atributos b√°sicos +10%.</li><li>S2: Se Satori Tendou estiver em quadra, no in√≠cio da partida aplica [Raiva] aos inimigos ([Power Attack]/[Quick Attack] ‚àí10%).</li><li>S4: [Bloqueio] do Satori Tendou +10%. Quando o Tendou bloquear, se o atacante inimigo estiver com debuff, neste bloqueio a [Rea√ß√£o] do Tendou +10%.</li>"}
], symbols: [ "img/blocksymbol.png" ] },

{ nome: "Goshiki SSR", funcao: "WS", img: "img/goshikiSR.png", School: "Shiratorizawa", vinculo: ["WS de Shiratorizawa"], Stats:{Serve:1268,Spike:1475,Set:1189,Receive:1402,Block:1322,Save:1196}, habilidades:[
  {nome:"ATENDENDO √ÄS EXPECTATIVAS", descricao:"Quando TSUTOMU GOSHIKI marca, aumenta o Moral do seu lado em 8"},
  {nome:"RECEP√á√ÉO SIMPLES", descricao:"TSUTOMU GOSHIKI realiza uma Recep√ß√£o com 120% do atributo Recep√ß√£o como poder"},
  {nome:"FUTURO ACE", descricao:"No encerramento de cada turno, TSUTOMU GOSHIKI recebe 1 ac√∫mulo do potencializador [Afiado]; cada ac√∫mulo de [Afiado] aumenta o atributo Ataque Potente em 2.5%, at√© 5 ac√∫mulos"},
  {nome:"FAZEDOR DE MILAGRES", descricao:"TSUTOMU GOSHIKI realiza uma Cortada Potente com 225% do atributo Ataque Potente como poder; para essa Cortada Potente, a Percep√ß√£o de GOSHIKI aumenta em 10%"},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Atributos b√°sicos +10%.</li><li>S2: <Pr√≥ximo Ace> ‚Äî Efeito adicional: para cada ac√∫mulo de [Precis√£o], [Percep√ß√£o] +2%.</li><li>S4: Quando um aliado ativar a Moral da Equipe, redefine a recarga de <Fazer um Milagre>. Enquanto a Moral da Equipe estiver ativa, <Fazer um Milagre> n√£o exige recarga ap√≥s a ativa√ß√£o.</li>"}
], symbols: [ "img/powersymbol.png", "img/servesymbol.png" ] },

{ nome: "Shirabu SSR", funcao: "S", img: "img/shirabuSR.png", School: "Shiratorizawa", vinculo: ["Campe√£o Absoluto e Levantador S√≥lido"], Stats:{Serve:1391,Spike:1326,Set:1474,Receive:1193,Block:1322,Save:1110}, habilidades:[
  {nome:"INABAL√ÅVEL", descricao:"Aumenta o atributo Passe de KENJIRO SHIRABU em 10%; quando SHIRABU passa para um atacante com a caracter√≠stica Ataque Potente, aumenta a pot√™ncia dessa Cortada Potente em 8% do atributo Ataque Potente do atacante"},
  {nome:"LARGADA CALCULADA", descricao:"KENJIRO SHIRABU realiza uma Largada do Levantador imposs√≠vel de bloquear com 120% do atributo Passe como poder"},
  {nome:"HABILIDADES DE AJUSTE", descricao:"Aumenta a Percep√ß√£o de KENJIRO SHIRABU em 9%"},
  {nome:"ATIVANDO O ACE", descricao:"KENJIRO SHIRABU realiza um Passe com 210% do atributo Passe como poder; para esse Passe, a Percep√ß√£o de SHIRABU aumenta em 10%"},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Atributos b√°sicos +10%.</li><li>S2: Quando um aliado ativa uma habilidade de Power Attack, todos os aliados recebem [Percep√ß√£o] +1% e [Rea√ß√£o] +2%, acumulando at√© 5 vezes.</li><li>S4: Na primeira vez de cada set que voc√™ ativar o Toss ‚ÄúValorizar o Spiker‚Äù, ele n√£o exige recarga ap√≥s a ativa√ß√£o e esse Toss ser√° garantido como Nice Play.</li>"}
], symbols: [ "img/powersymbol.png", "img/settersymbol.png" ] },

{ nome: "Semi SSR", funcao: "S", img: "img/semiSR.png", School: "Shiratorizawa", vinculo: [], Stats:{Serve:1476,Spike:1329,Set:1406,Receive:1184,Block:1329,Save:1111}, habilidades:[
  {nome:"POSSE DE BOLA", descricao:"Quando EITA SEMI saca, reduz a pot√™ncia de recep√ß√£o dos jogadores da linha de defesa do advers√°rio em 13% do atributo Recep√ß√£o deles, durando 4 cruzamentos de rede"},
  {nome:"LEVANTAMENTO ENGANOSO", descricao:"EITA SEMI realiza um Passe com 120% do atributo Passe como poder"},
  {nome:"DESEMPENHO PREMIUM", descricao:"Ao sacar, aumenta a Percep√ß√£o de EITA SEMI em 5% e a For√ßa em 10%"},
  {nome:"SAQUE INSPIRADOR", descricao:"EITA SEMI realiza um Saque em Suspens√£o com 220% do atributo Saque como poder; ao marcar um Ace, aumenta a Percep√ß√£o em 3% e o Reflexo em 6% para os jogadores do seu lado"},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Atributos b√°sicos +10%.</li><li>S2: Se Eita Semi marcar um Service Ace, redefine a recarga de <This One Is Free>.</li><li>S4: O [Saque] do Eita Semi aumenta em [Percep√ß√£o] √ó 50%.</li>"}
], symbols: [ "img/powersymbol.png", "img/servesymbol.png", "img/settersymbol.png" ] },

{ nome: "Ohira SSR", funcao: "WS", img: "img/ohiraSR.png", School: "Shiratorizawa", vinculo: ["WS de Shiratorizawa"], Stats:{Serve:1272,Spike:1477,Set:1188,Receive:1399,Block:1332,Save:1197}, habilidades:[
  {nome:"DEFESA POTENTE", descricao:"Quando REON OHIRA recebe a Cortada R√°pida Superior de um advers√°rio, aumenta a pot√™ncia de recep√ß√£o em 40% do atributo Recep√ß√£o de OHIRA"},
  {nome:"DEFESA DE PONTO DE VIRADA", descricao:"REON OHIRA realiza uma Recep√ß√£o com 120% do atributo Recep√ß√£o como poder"},
  {nome:"BENKEI BENEVOLENTE", descricao:"Aumenta a Percep√ß√£o de REON OHIRA em 5% e o Reflexo em 10%"},
  {nome:"CORTADA DEVASTADORA", descricao:"REON OHIRA realiza uma Cortada Potente com 240% do atributo Ataque Potente como poder"},
{nome:"Resson√¢ncias",Descricao:"<li>S1/3/5: Atributos b√°sicos +10%.</li><li>S2: Se a Recep√ß√£o ou o Power Attack do Shion Ohira for Nice Play, quando o Setter aliado fizer o pr√≥ximo Toss ele recebe [Percep√ß√£o] +8% e [Poder] +15%.</li><li>S4: Se a Recep√ß√£o ou o Power Attack do Shion Ohira for Nice Play, as habilidades Ultimate dos aliados t√™m a recarga reduzida em 2 passagens de rede.</li>"}
], symbols: [ "img/receivesymbol.png" ] },

/* ==missing Stats== */{ nome: "Yamagata SSR", funcao: "L", img: "img/yamagataSR.png", School: "Shiratorizawa", vinculo: [], Stats:{Serve:1206,Spike:1206,Set:1331,Receive:1477,Block:1172,Save:1410}, habilidades:[
  {nome:"DESEMPENHO EST√ÅVEL", descricao:"Aumenta o Reflexo de HAYATO YAMAGATA em 13%"},
  {nome:"DEFESA AMPLA", descricao:"HAYATO YAMAGATA realiza uma Defesa com 120% do atributo Defesa como poder"},
  {nome:"REFLEXOS R√ÅPIDOS", descricao:"Quando o advers√°rio consegue um bloqueio PERFEITO, aumenta a pot√™ncia de Defesa de HAYATO YAMAGATA em 40% de seu atributo Defesa"},
  {nome:"RECEP√á√ÉO S√ìLIDA", descricao:"HAYATO YAMAGATA realiza uma Recep√ß√£o com 235% do atributo Recep√ß√£o como poder"},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Atributos b√°sicos +10%.</li><li>S2: Se Hayato Yamagata estiver em quadra, no in√≠cio da partida os aliados da linha de tr√°s recebem [Recep√ß√£o] +10% por 3 trocas.</li><li>S4: Quando um aliado fizer uma Nice Play, a recarga de <Recep√ß√£o S√≥lida> √© reduzida em 2 passagens de rede.</li>"}
], symbols: [ "img/receivesymbol.png" ] },

{ nome: "Bokuto UR", data: "08/30/25", funcao: "WS", img: "img/bokutoUR.png", School: "Fukurodani", vinculo: ["√Ås Milagroso e Levantador Carinhoso"], Stats:{Serve:1623,Spike:1705,Set:1369,Receive:1537,Block:1461,Save:1376}, habilidades:[
  {nome:"MOTOR DO HYPE", descricao:"Quando KOTARO BOKUTO entra na quadra, aumenta o Moral do seu time em 20. Enquanto ele estiver na quadra, cada toque dos seus jogadores aumenta o Moral em 4. O efeito Refor√ßo de Moral do Time se torna: todos os jogadores t√™m os Atributos B√°sicos aumentados em 32% com dura√ß√£o de 4 toques do seu time"},
  {nome:"GRANDE SACADOR", descricao:"KOTARO BOKUTO realiza um Saque em Suspens√£o com 125% do atributo Saque dele como poder"},
  {nome:"MUDAN√áA DE HUMOR", descricao:"No estado [Empolgado], o Ataque Potente de KOTARO BOKUTO aumenta em 12% e a For√ßa em 18%. Em [Desanimado], ele n√£o pode usar habilidades de Cortada. BOKUTO entra em [Empolgado] quando seu time entra em [Refor√ßo de Moral do Time], e entra em [Desanimado] quando isso termina. Ao fim de cada turno, ele sai de [Desanimado]"},
  {nome:"ACE FORMADO PELO TIME", descricao:"KOTARO BOKUTO realiza uma Cortada Potente com 260% de seu atributo Ataque Potente. Se essa Cortada for Superior, sua For√ßa aumenta em 12% e o Moral do seu time aumenta em 16"},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Aumenta os atributos b√°sicos em 13%.</li><li>S2: Enquanto Bokuto estiver com o efeito [Desanimado] ativo, os membros aliados recebem o efeito [√Çnimo do Time], aumentando seus atributos b√°sicos em 12%.</li><li>S4: Atributo [Ataque Potente] do Bokuto aumenta em 16%. Se a jogada de Ataque Potente do Bokuto n√£o for BAD, √© resetado o CD da habilidade 4 do Bokuto.</li>"}
], symbols: [ "img/powersymbol.png", "img/servesymbol.png" ] },

{ nome: "Bokuto SP", data: "05/12/26", funcao: "WS", img: "img/bokutoSP.png", School: "Fukurodani", vinculo: ["Nata√ß√£o", "Ace Milagroso e Levantador Carinhoso"], Stats:{Serve:1673,Spike:1950,Set:1574,Receive:1856,Block:1760,Save:1572}, habilidades:[
  {nome:"Animar", descricao:"O [Ataque Potente] de Kotaro Bokuto (Garotos da Praia) aumenta em 13/16/19%. Quando ele est√° em quadra, os efeitos de aumento de Moral para aliados, exceto 'Encorajar', s√£o reduzidos em 100%; a cada 10 de Moral reduzida, o jogador ganha 1 ac√∫mulo de 'Unidos'. Por ac√∫mulo, os atributos b√°sicos dos aliados aumentam em 0.16%, at√© 199 ac√∫mulos."},
  {nome:"Participa√ß√£o Defensiva", descricao:"Kotaro Bokuto (Garotos da Praia) recebe com [Recep√ß√£o] √ó 140/160/180% de poder. Ganha 3 ac√∫mulos de [Unidos]."},
  {nome:"Sempre Animado!", descricao:"Se estiver com [Melhor Condi√ß√£o], quando Kotaro Bokuto (Garotos da Praia) ativa o Superior, seu [Ataque Potente] aumenta em 1% por ac√∫mulo de [Unidos] (m√°x. +70%) at√© a bola cruzar a rede duas vezes. Al√©m disso, por ac√∫mulo de [Unidos], o poder do seu Ataque Potente aumenta em [Ataque Potente] √ó 1.5% (m√°x. +120%) at√© a bola cruzar a rede duas vezes. Ap√≥s o Superior, ele ganha [Altos e Baixos]."},
  {nome:"Cortada Milagrosa", descricao:"Kotaro Bokuto (Garotos da Praia) realiza uma Cortada com 260/280/300/320/340% do [Ataque Potente]. Para cada ac√∫mulo de [Unidos], a [T√©cnica de Ataque] dele aumenta em 0.75%, at√© 30%, at√© a bola cruzar a rede duas vezes."},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Aumenta os atributos b√°sicos em 13%.</li><li>S2: A cada 1 ac√∫mulo do efeito [Uni√£o], o atributo [Percep√ß√£o] do Bokuto aumenta em 0.4%, podendo chegar m√°ximo at√© 15% de aumento. Ao ativar a habilidade 4 do Bokuto, o atributo [For√ßa] aumenta em [Percep√ß√£o] x 85%, podendo chegar at√© no m√°ximo 100% de aumento.</li><li>S4: Quando o Refor√ßo de Moral do Time aliado encerrar, Bokuto recebe 8 ac√∫mulos do efeito [Uni√£o]. Quando Bokuto possui o efeito [Excelente Condi√ß√£o], a cada 1 ac√∫mulo do efeito [Uni√£o] aumenta em 3% o atributo [For√ßa] dele, podendo aumentar no m√°ximo at√© 150%.</li>"}
], symbols: [ "img/powersymbol.png", "img/receivesymbol.png" ] },

{ nome: "Akaashi SP", data: "06/11/26", funcao: "S", img: "img/akaashiSP.png", School: "Fukurodani", vinculo: ["Nata√ß√£o", "Ace Milagroso e Levantador Carinhoso"], Stats:{Serve:1848,Spike:1754,Set:1949,Receive:1581,Block:1758,Save:1489}, habilidades:[
  {nome: "Organizador de time", descricao:"O [Saque] do Akaashi Kyoji (Garotos da Praia) aumenta em 13/15/18%. Quando a moral do time de um aliado sobe, o Akaashi Kyoji (Garotos da Praia) ganha 1 ac√∫mulo do efeito [Mente Tranquila] a cada 10 pontos de moral. Cada ac√∫mulo de [Mente Tranquila] aumenta o [Levantamento] dele em 1,5%, at√© 10 ac√∫mulos. Enquanto o Despertar da Moral do Time n√£o estiver ativo, todos os ac√∫mulos de [Mente Tranquila] s√£o consumidos quando o Akaashi Kyoji (Beach Boy) toca na bola. Cada vez que um ac√∫mulo de [Mente Tranquila] √© consumido, o [Empenho] do Akaashi Kyoji (Garotos da Praia) aumenta em 3%, chegando a no m√°ximo 30%. Esse efeito dura por 2 passagens pela rede."}, {nome: "Aproveitamento Maximo", descricao:"Keiji Akaashi (Garotos da Praia) executa um Levantamento com poder de 140/155/170% do seu [Levantamento]. Depois dessa jogada, na pr√≥xima vez que ele ativar o Superior, o [Levantamento] dele aumenta em 15%. Esse efeito dura por 2 passagens pela rede."}, {nome: "Atacar", descricao:"Enquanto um aliado estiver com o Despertar da Moral do Time ativo, quando o Keiji Akaashi (Garotos da Praia) tocar na bola, 5 ac√∫mulos de [Mente Tranquila] s√£o consumidos e o [Empenho] dele aumenta em 70%. Esse efeito dura por 2 passagens pela rede.Se o levantamento do Keiji Akaashi (Garotos da Praia) for um Acerto Cr√≠tico, a [Percep√ß√£o] do primeiro jogador a cortar (Ataque Potente/Ataque R√°pido) depois dessa jogada aumenta em 50% da [Percep√ß√£o] do Keiji Akaashi (Garotos da Praia), at√© no m√°ximo 60%.Se essa cortada for um Ataque Potente, a [Percep√ß√£o] de quem realizou a cortada recebe mais 50% da [Percep√ß√£o] do Keiji Akaashi (Garotos da Praia), at√© no m√°ximo 60%. Quando [Mostre 100% do Seu Treino] for ativado, para cada ac√∫mulo de [Mente Tranquila] que ele tiver, o [Ataque Potente] de quem fizer a cortada aumenta em 3/3,5/4%, at√© no m√°ximo 24/28/32%."}, {nome: "Jogada Decisiva", descricao:"Akaashi Kyoji (Garotos da Praia) executa uma Largada do Levantador com poder de 260/280/300/320/340% do seu [Levantamento]. A Largada do Levantador n√£o pode ser bloqueada. Se essa largada for um Acerto Cr√≠tico, o tempo de recarga de [Mostre 100% do Seu Treino] √© reduzido em 4 passagens pela rede.Ganha 1 ac√∫mulo de [Mente Tranquila]."},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Aumenta os atributos b√°sicos em 13%.</li><li>S2: Atributo [For√ßa] do Akaashi aumenta em 30%. 1 - Quando Akaashi est√° em quadra, a cada t√©rmino de rally aumenta 40 de Moral do time aliado. 2 - Quando Akaashi est√° em quadra e enquanto o Refor√ßo de Moral do Time n√£o est√° ativado, os atributos [Recep√ß√£o] e [Bloqueio] dos aliados aumentam em 25%.</li><li>S4: 1 - Ao ativar a habilidade 2, juntamente com os buffs dessa habilidade, a cada 1 ac√∫mulo do efeito [Percep√ß√£o Calma], aumenta 0.3% do atributo [For√ßa] do membro a realizar um Ataque R√°pido/Potente, podendo aumentar no m√°ximo at√© 40% e permanecendo esse efeito por 2 cruzamentos de rede. 2 - Se esse Ataque for do tipo Potente, aumenta em mais 0.8% o atributo [For√ßa] desse aliado, podendo aumentar no m√°ximo at√© 80% e permanecendo o efeito por 2 cruzamentos de rede. 3 - Para cada 1 ac√∫mulo do efeito [Percep√ß√£o Calma], o aumento da for√ßa de Larga da habilidade 4 aumenta em mais [Passe] x 0.6%, podendo aumentar at√© no m√°ximo 100%. 4 - Enquanto o time aliado est√° com o Refor√ßo da Moral do Time ativado, a cada 5 de aumento da Moral aumenta em 1% do atributo [For√ßa] do primeiro aliado a ativar a habilidade 4 ap√≥s o t√©rmino do Refor√ßo da Moral do Time, podendo aumentar at√© no m√°ximo 30%.</li>"}
], symbols: [ "img/powersymbol.png", "img/settersymbol.png" ] },

{ nome: "Akaashi SSR", funcao: "S", img: "img/akaashiSR.png", School: "Fukurodani", vinculo: ["√Ås Milagroso e Levantador Carinhoso"], Stats:{Serve:1396,Spike:1331,Set:1476,Receive:1191,Block:1334,Save:1123}, habilidades:[
  {nome:"CLAREZA EM MOVIMENTO", descricao:"Enquanto KEIJI AKAASHI estiver em quadra, quando um colega de time realiza um Bloqueio ou Recep√ß√£o PERFEITOS, remove todas as penalidades desse jogador, aumenta a Percep√ß√£o do AKAASHI em 8% e aumenta o Moral do seu time em 3"},
  {nome:"CONTRAPONTO T√ÅTICO", descricao:"KEIJI AKAASHI realiza uma Largada do Levantador imposs√≠vel de bloquear com 120% do seu atributo Levantamento. Se esse ataque marcar, seu pr√≥ximo Saque ganha 10% de pot√™ncia adicional com base no atributo Saque do sacador"},
  {nome:"FLUXO ALTRU√çSTA", descricao:"Aumenta o atributo Levantamento de KEIJI AKAASHI em 8%. Enquanto seu time estiver em [Refor√ßo de Moral do Time], para cada 4 de Moral obtido, aumenta a Percep√ß√£o de AKAASHI em 1.2%. Quando AKAASHI realiza um Levantamento Superior, a pr√≥xima Cortada do seu time ter√° a garantia de ser Superior"},
  {nome:"CONJUNTO CONSISTENTE", descricao:"KEIJI AKAASHI realiza um Levantamento com 240% do seu atributo Levantamento"},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Atributos b√°sicos +10%.</li><li>S2: Se Keiji Akaashi estiver em quadra, sempre que a bola atravessar a rede a Moral da Equipe +10. Quando um aliado ativar a Moral da Equipe, redefine a recarga de <Toss Habitual>.</li><li>S4: Se o resultado do Toss do Akaashi n√£o for BAD, ap√≥s esta jogada o primeiro aliado a realizar um Spike (Power Attack/Quick Attack) remove todos os debuffs e recebe [Power Attack]/[Quick Attack] +4%, acumulando at√© 3 vezes por 3 trocas.</li>"}
], symbols: [ "img/powersymbol.png", "img/settersymbol.png" ] },

{ nome: "Konoha SSR", funcao: "OP", img: "img/konohaSR.png", School: "Fukurodani", vinculo: [], Stats:{Serve:1256,Spike:1462,Set:1196,Receive:1274,Block:1333,Save:1335}, habilidades:[
  {nome:"Recep√ß√£o Excelente", descricao:"A [Recep√ß√£o] de Akinori Konoha aumenta em 8/10/12%. Enquanto o Despertar de Moral estiver ativo, suas [Recep√ß√£o] e [Defesa] aumentam em 10%."},
  {nome:"Uma Combina√ß√£o Primorosa", descricao:"Akinori Konoha realiza uma Defesa com 120/135/150% de [Defesa] como poder."},
  {nome:"Bloqueio do Polivalente", descricao:"Quando Akinori Konoha est√° na linha de frente, o [Bloqueio] e o [Ataque Potente/Ataque R√°pido] de todos os aliados na linha de frente aumentam em 8/10/12%. Se ele estiver na linha de tr√°s, a [Recep√ß√£o] e a [Defesa] de todos os aliados na linha de tr√°s aumentam em 8/10/12%."},
  {nome:"Sr. Habilidoso (mas Pobre)", descricao:"Akinori Konoha recebe com 225/240/255/270/285% de [Recep√ß√£o] como poder. Se o resultado n√£o for RUIM, a Moral do Time aumenta em 20."},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Atributos b√°sicos +10%.</li><li>S2: Se o resultado da Recep√ß√£o do Akinori Konoha n√£o for BAD, ap√≥s esta jogada o primeiro aliado que fizer o Toss recebe [Toss] +10% e [Percep√ß√£o] +8%.</li><li>S4: Enquanto a Moral da Equipe estiver ativa e Akinori Konoha estiver em quadra, se o resultado da sua Recep√ß√£o n√£o for BAD, esta jogada n√£o consome a dura√ß√£o da Moral da Equipe.</li>"}
], symbols: [ "img/receivesymbol.png" ] },

{ nome: "Haruki SSR", funcao: "L", img: "img/harukiSR.png", School: "Fukurodani", vinculo: [], Stats:{Serve:1206,Spike:1206,Set:1328,Receive:1475,Block:1721,Save:1409}, habilidades:[
  {nome:"Mestre da Defesa", descricao:"A [Recep√ß√£o] de Haruki Komi aumenta em 8/10/12%. Se o resultado da sua recep√ß√£o n√£o for RUIM, a Moral do Time advers√°rio diminui em 12."},
  {nome:"Lubrificante da Equipe (0_0)", descricao:"Haruki Komi realiza uma Defesa que usa 110/125/140% de [Defesa] como poder. Se o resultado n√£o for RUIM, os atributos principais dos aliados aumentam em 5/6.5/8% por 1 rali."},
  {nome:"Recep√ß√£o Comprovada", descricao:"Quando Haruki Komi recebe e o oponente dispara um ataque poderoso, a pot√™ncia dessa recep√ß√£o aumenta em 30/40/50% de [Recep√ß√£o] como poder."},
  {nome:"Centro da Defesa", descricao:"Haruki Komi executa uma recep√ß√£o com 235/250/265/280/295% de [Recep√ß√£o] como poder."},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Atributos b√°sicos +10%.</li><li>S2: <Centro da Defesa> ‚Äî A recarga passa a ser de 6 passagens de rede. Quando <Centro da Defesa> ativar, os aliados recebem [Power Attack] +3%, acumulando at√© 5 vezes.</li><li>S4: Quando seu time marcar um ponto, o poder da pr√≥xima Recep√ß√£o do aliado da linha de tr√°s aumenta em [Recep√ß√£o] √ó 30% (do pr√≥prio aliado).</li>"}
], symbols: [ "img/receivesymbol.png" ] },

/* ==missing Stats== */{ nome: "Tatsuo SSR", funcao: "MB", img: "img/tatsuoSR.png", School: "Fukurodani", vinculo: [], Stats:{Serve:1304,Spike:1404,Set:1224,Receive:1258,Block:1473,Save:1176}, habilidades:[
  {nome:"Bloqueio Intimidante", descricao:"O [Bloqueio] de Tatsuki Washio aumenta em 8/10/12%. Ao bloquear, o poder da primeira recep√ß√£o do companheiro ap√≥s essa jogada aumenta em 20% de [Recep√ß√£o]. Se o bloqueio dele n√£o for RUIM, o pr√≥ximo bloqueio dele aumenta em 20% de [Bloqueio]."},
  {nome:"Ataque de Alta Pontua√ß√£o", descricao:"Tatsuki Washio executa um Ataque R√°pido com 120/135/150% de [Ataque R√°pido] como poder."},
  {nome:"Trabalhador de Talento Oculto", descricao:"Quando um oponente faz uma boa jogada, o [Bloqueio] e o [Ataque R√°pido] de Tatsuki Washio aumentam em 2/2.5/3%, at√© 5 ac√∫mulos."},
  {nome:"Bloqueio que Aproveita o Corpo Alto", descricao:"Tatsuki Washio bloqueia com 220/235/250/265/280% de [Bloqueio] como poder."},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Atributos b√°sicos +10%.</li><li>S2: Se este personagem estiver em quadra, sempre que seu time marcar ponto a Moral da Equipe +10. Enquanto a Moral da Equipe estiver ativa, sempre que o time marcar ponto, o [Bloqueio] deste personagem +5%, acumulando at√© 3 vezes.</li><li>S4: Se o resultado do Bloqueio deste personagem n√£o for BAD, ap√≥s esta jogada o primeiro aliado que fizer um Bloqueio recebe [Bloqueio] +15%.</li>"}
], symbols: [ "img/quicksymbol.png", "img/blocksymbol.png" ] },

{ nome: "Terushima SSR", funcao: "WS", img: "img/terushimaSR.png", School: "Jozenji", vinculo: [], Stats:{Serve:1401,Spike:1470,Set:1196,Receive:1335,Block:1263,Save:1196}, habilidades:[
  {nome:"Esp√≠rito Livre", descricao:"Aumenta o [Ataque Potente] de Terushima Yuji em 8/10/12%. Quando ele est√° em quadra e o resultado da recep√ß√£o, Defesa ou Passe de um aliado n√£o for RUIM, Terushima Yuji ganha 1 ac√∫mulo de [Brincar Mais, Brincar Mais]. Cada ac√∫mulo aumenta o [Ataque Potente/Ataque R√°pido] em 2.5%, at√© 4 ac√∫mulos."},
  {nome:"Saque Divertido", descricao:"Terushima Yuji executa um Saque em Suspens√£o com 120/135/150% de [Saque] como poder."},
  {nome:"Asoviva", descricao:"Para cada membro recebedor na sua equipe, a [Recep√ß√£o] de Terushima Yuji aumenta em 4/5/6%. Se ele errar uma recep√ß√£o, nenhum ponto √© perdido. O tempo de recarga desse efeito dura at√© a bola cruzar a rede 10 vezes."},
  {nome:"Cortada Empolgante", descricao:"Terushima Yuji executa uma Cortada Potente com 235/250/265/280/295% de [Ataque Potente]. Se marcar ponto, a [Recep√ß√£o] dos aliados aumenta em 10% por 3 cruzamentos de rede."},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Atributos b√°sicos +10%.</li><li>S2: Se Yuuji Terushima estiver em quadra, para cada membro de fun√ß√£o Recep√ß√£o no seu time em quadra, os aliados da linha de tr√°s recebem [Recep√ß√£o] e [Cobertura] +6%.</li><li>S4: Se o Terushima tiver 4 ac√∫mulos de <Motto Motto Meisou>, redefine a recarga de <Painfully Satisfying Spike>. Quando o Terushima realizar um Spike Normal, consome 4 ac√∫mulos: o poder deste Quick aumenta em [Quick] √ó 35%. Al√©m disso, por ac√∫mulo de <Motto Motto Meisou>, [Quick]/[Quick Attack] +2,5% (m√°x. 4 ac√∫mulos).</li>"}
], symbols: [ "img/powersymbol.png", "img/servesymbol.png" ] },

{ nome: "Atsumu UR", data: "10/14/25", funcao: "S", img: "img/atsumuUR.png", School: "Inarizaki", vinculo: ["A for√ßa dos G√™meos", "Cabe√ßa dos G√™meos"], Stats:{Serve:1705,Spike:1539,Set:1629,Receive:1376,Block:1530,Save:1290}, habilidades:[
  {nome:"Jogada Imprevis√≠vel", descricao:"Quando Miya Atsumu realiza um saque, se o alvo for um ponto fraco da defesa advers√°ria, o poder do saque aumenta em 30/40/50% de [Saque]. Se n√£o for em ponto fraco, a [Recep√ß√£o] dos seus jogadores da linha de tr√°s aumenta em 10/12/14% por 1 rali."},
  {nome:"Levantamento Delicado", descricao:"Miya Atsumu executa um Passe com 125/140/155% de [Passe] como poder. Esse Passe remove todas as penalidades do jogador que vai atacar (Potente/R√°pido)."},
  {nome:"Levantamento Devoto e Sincero", descricao:"Aumenta o [Passe] de Miya Atsumu em 8/11/14%. Quando um jogador seu realiza uma a√ß√£o e o resultado n√£o √© PERFEITO, Atsumu ganha 2 ac√∫mulos de [Timing Perfeito]. Cada ac√∫mulo aumenta o [Passe] em 2% (m√°x. 10). Ao levantar, ele consome 1 ac√∫mulo, aumentando a [T√©cnica de Ataque] e o [Ataque R√°pido] do atacante em 2.5. Dura por 10 cruzamentos."},
  {nome:"Saque das Duas Espadas", descricao:"Miya Atsumu alterna entre Saque em Suspens√£o e Saque Flutuante com Salto. Flutuante com Salto: 230/245/275/290% de [Saque] como poder; impede o uso de Superiores de [Ataque Potente/Ataque R√°pido] por 2 cruzamentos. Saque em Suspens√£o: 260/275/290/305/320% de [Saque] como poder; a cada 3 de Moral do Time, a [Percep√ß√£o] de Atsumu aumenta em 1% por 2 cruzamentos."},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Aumenta os atributos b√°sicos em 13%.</li><li>S2: [For√ßa] do Atsumu aumenta em 30%. Quando Atsumu est√° presente recebe 5 ac√∫mulos do efeito [Jogada Perfeita/Precisa]. A cada ac√∫mulo, aumenta 2% do atributo [Passe], acumulando at√© 10 vezes.</li><li>S4: A cada 1 ac√∫mulo do efeito [Jogada Perfeita/Precisa], aumenta em 3% o atributo [Passe] do Atsumu. Quando Atsumu utiliza o efeito [Jogada Perfeita/Precisa], recebe 5 ac√∫mulos do efeito. A cada ac√∫mulo, o atributo [Passe] aumenta em 2%, podendo acumular at√© 10 vezes.</li>"}
], symbols: [ "img/quicksymbol.png", "img/servesymbol.png", "img/settersymbol.png" ] },

{ nome: "Osamu UR", data: "10/29/25", funcao: "OP", img: "img/osamuUR.png", School: "Inarizaki", vinculo: ["A for√ßa dos G√™meos", "Cabe√ßa dos G√™meos"], Stats:{Serve:1621,Spike:1685,Set:1426,Receive:1459,Block:1428,Save:1373}, habilidades:[
  {nome:"Ataque Flex√≠vel", descricao:"Aumenta o [Ataque R√°pido] de Miya Osamu em 10/12/14%. In√≠cio da partida: a [Percep√ß√£o] de Osamu cai para 0% e, para cada 1% reduzido, a [T√©cnica de Ataque] aumenta em 1%. (Priorize empilhar [Percep√ß√£o] para esta habilidade)."},
  {nome:"Saque em Suspens√£o Frio", descricao:"Miya Osamu executa um Saque em Suspens√£o com 120/135/150% de [Saque]. Se o recebedor advers√°rio tiver [Supress√£o], a [T√©cnica de Ataque] de Osamu aumenta em 10% por 8 cruzamentos."},
  {nome:"Multitalentoso", descricao:"Aumenta a [T√©cnica de Ataque] de Miya Osamu em 10/13/16%. Quando ele ataca ou saca, aplica 1 ac√∫mulo de [Supress√£o] nos jogadores da linha de tr√°s advers√°ria (cada ac√∫mulo reduz a [Recep√ß√£o] em 10%). Dura por 10 cruzamentos."},
  {nome:"Contra-ataque Flex√≠vel", descricao:"Miya Osamu realiza um Ataque R√°pido com 260/275/290/305/320% de [Ataque R√°pido]. O [Ataque R√°pido] dele aumenta em 40% de [T√©cnica de Ataque] por 2 cruzamentos. (Sinergiza com a [T√©cnica de Ataque] ganha em Ataque Flex√≠vel)."},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Aumenta os atributos b√°sicos em 13%.</li><li>S2: Quando Osamu for realizar um Ataque R√°pido e o inimigo que for realizar a Recep√ß√£o estiver sob o efeito debuff [Controle], esse Ataque ser√° com uma for√ßa de [Ataque R√°pido] x 60%.</li><li>S4: Ap√≥s Osamu pontuar com um Ataque R√°pido, nas pr√≥ximas 2 vezes que um aliado ativar uma habilidade Suprema (skill 4), os atributos [T√©cnica de Ataque] e [T√©cnica de Defesa] desse aliado aumentam em 20% .</li>"}
], symbols: [ "img/quicksymbol.png", "img/servesymbol.png" ] },

{ nome: "Kita SSR", funcao: "WS", img: "img/kitaSR.png", School: "Inarizaki", vinculo: ["Cabe√ßa dos G√™meos"], Stats:{Serve:1238,Spike:1219,Set:1333,Receive:1476,Block:1198,Save:1409}, habilidades:[
  {nome:"Repeti√ß√£o, Continuidade e Cautela", descricao:"Aumenta os atributos B√°sicos de Kita Shinsuke em 6/8/10%. Se o resultado da [Recep√ß√£o] de Kita for RUIM, a [T√©cnica de Defesa] aumenta em 80% de [Reflexo] como poder."},
  {nome:"Jogada Calma", descricao:"Kita Shinsuke executa uma [Defesa] com 120/135/150% de [Defesa] como poder."},
  {nome:"Vou Fazer do Jeito Certo", descricao:"A [Recep√ß√£o] de Kita Shinsuke aumenta em 8/10/12%. Ele realiza uma [Recep√ß√£o]; se o resultado n√£o for Nice Play, ganha 1 ac√∫mulo de [A√ß√£o Segura] (+3% [Recep√ß√£o], at√© 3). Com 3 ac√∫mulos, consome 3 para aumentar a [T√©cnica de Ataque] dos jogadores da linha de frente em 10% por 8 cruzamentos."},
  {nome:"Jogada S√≥lida", descricao:"Kita Shinsuke realiza uma [Recep√ß√£o] com 235/250/265/280/295% de [Recep√ß√£o] como poder."},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Atributos b√°sicos +10%.</li><li>S2: <‚ÄúFa√ßa do Jeito Certo‚Äù> ‚Äî Mudan√ßa de efeito: a condi√ß√£o para obter [A√ß√£o Segura] muda de ‚Äúquando a Recep√ß√£o do Kita Shinsuke n√£o for Nice Play‚Äù para ‚Äúquando a Recep√ß√£o de um aliado n√£o for Nice Play‚Äù.</li><li>S4: Se o Kita Shinsuke n√£o errar a Recep√ß√£o, Moral da Equipe +10. Enquanto o Kita estiver em quadra, quando um aliado ativar o Ultimate, esse aliado recupera 10 de Stamina.</li>"}
], symbols: [ "img/receivesymbol.png" ] },

{ nome: "Rintaro SSR", funcao: "MB", img: "img/rintaroSR.png", School: "Inarizaki", vinculo: [], Stats:{Serve:1266,Spike:1476,Set:1186,Receive:1258,Block:1342,Save:1318}, habilidades:[
  {nome:"Fechar o √Çngulo", descricao:"Aumenta o [Bloqueio] de Rintaro Suna em 10/12/14%. Se ele estiver em quadra e o atacante advers√°rio estiver sob [Confus√£o], o poder de bloqueio do time aumenta em 15/20/25% do [Bloqueio] do bloqueador."},
  {nome:"Bloqueio H√°bil", descricao:"Rintaro Suna bloqueia com 20/35/50% do poder do ataque."},
  {nome:"Jogada que Pega o Oponente Desprevenido", descricao:"Aumenta o [Ataque R√°pido] de Rintaro Suna em 10/12/14%. Ao realizar Ataque R√°pido, aplica 1 ac√∫mulo de [Confus√£o] na linha de frente advers√°ria. Cada ac√∫mulo reduz o [Bloqueio] em 10%, por at√© 8 cruzamentos de rede."},
  {nome:"Cortadas com Amplo Ponto de Impacto", descricao:"Rintaro Suna realiza um Ataque R√°pido com 240/255/270/285/300% de [Ataque R√°pido] como poder."},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Atributos b√°sicos +10%.</li><li>S2: Quando o Ultimate do Rintaro Suna ativar, aplica 1 ac√∫mulo de [Confus√£o] na linha de frente inimiga. Para cada ac√∫mulo de [Confus√£o], o [Bloqueio] deles ‚àí10%. Dura por 8 passagens de rede.</li><li>S4: Quando o Rintaro Suna marcar com um Quick Attack, [T√©cnica de Ataque] +7%, acumulando at√© 5 vezes.</li>"}
], symbols: [ "img/quicksymbol.png", "img/blocksymbol.png" ] },

/* ==missing Stats== */{ nome: "Oshiro SSR", funcao: "WS", img: "img/oshiroSR.png", School: "Inarizaki", vinculo: [], Stats:{Serve:1411,Spike:1483,Set:1196,Receive:1332,Block:1264,Save:1198}, habilidades:[
  {nome:"Controle de Ritmo", descricao:"Sempre que Oshiro Alan consumir 10 de Vigor, ganha 1 ac√∫mulo de [Respira√ß√£o R√°pida]. Cada ac√∫mulo aumenta a [T√©cnica de Ataque] em 3/3.5/4%. Ao final do rali, todos os ac√∫mulos s√£o consumidos; para cada um, Oshiro recupera 4 de Vigor."},
  {nome:"Saque Altamente T√©cnico", descricao:"Ojiro Alan executa um Saque em Suspens√£o com 110/125/140% de [Saque] como poder. O recebedor advers√°rio ter√° a [Recep√ß√£o] reduzida em 10% por 6 cruzamentos."},
  {nome:"Investida Agressiva", descricao:"Aumenta o [Ataque Potente] de Oshiro Alan em 6/8/10% e o [Saque] em 6/8/10%. Ao realizar um Ataque Potente, consome 60% do Vigor atual e aumenta o poder do ataque em 30/40/50% de [Ataque Potente]."},
  {nome:"Cortada Trovejante", descricao:"Ojiro Alan executa um Ataque Potente com 240/255/270/285/300% de [Ataque Potente] como poder."},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Atributos b√°sicos +10%.</li><li>S2: No in√≠cio de cada troca, Ojiro Aran recebe 3 ac√∫mulos de [Breather Time]. Para cada ac√∫mulo, [T√©cnica de Ataque] aumenta.</li><li>S4: At√© 2 vezes por troca, se Ojiro Aran estiver em quadra, sempre que um aliado recuperar Stamina, Ojiro Aran tamb√©m recupera 8 de Stamina.</li>"}
], symbols: [ "img/powersymbol.png", "img/servesymbol.png" ] },

/* ==missing Stats== */{ nome: "Akagi SSR", funcao: "L", img: "img/akagiSR.png", School: "Inarizaki", vinculo: [], Stats:{Serve:1206,Spike:1206,Set:1330,Receive:1477,Block:1172,Save:1410}, habilidades:[
  {nome:"Defesa que Aumenta a Seriedade", descricao:"Aumenta a [Recep√ß√£o] e a [Defesa] de Akagi Michinari em 8/10/12%. Aumenta a Moral do Time em 10 quando Akagi recebe ou defende."},
  {nome:"Um L√≠bero Confi√°vel", descricao:"Akagi Michinari executa uma Defesa com poder igual a 120/135/150% de [Defesa]. Aumenta a [T√©cnica de Defesa] dos aliados em 4/6/8% at√© a bola cruzar a rede 6 vezes."},
  {nome:"Perseguir a Bola com a M√£o", descricao:"A [Recep√ß√£o] de Akagi Michinari aumenta em 10/12/14%. Quando ele est√° em quadra, um oponente que faz uma cortada poderosa recebe 1 ac√∫mulo de [Aproxima√ß√£o] (reduz [Ataque Potente] em 8/10/12% por ac√∫mulo at√© a bola cruzar a rede 3 vezes). Se o oponente j√° tiver [Aproxima√ß√£o], a [T√©cnica de Defesa] dos aliados aumenta em 4/6/8% por 3 cruzamentos."},
  {nome:"Recep√ß√£o Corajosa", descricao:"Akagi Michinari recebe com 240/255/270/285/300% de [Recep√ß√£o] como poder."},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Atributos b√°sicos +10%.</li><li>S2: [Recep√ß√£o] do Akagi Michinari +14%. Se o Akagi estiver em quadra e a jogada de um aliado da linha de tr√°s n√£o for Nice Play, as habilidades de Recep√ß√£o dos aliados da linha de tr√°s t√™m a recarga reduzida em 1 passagem de rede.</li><li>S4: [T√©cnica de Defesa] do Akagi Michinari +15%. Se o resultado da Recep√ß√£o ou Cobertura do Akagi n√£o for BAD, ap√≥s esta jogada o primeiro aliado a realizar um Spike (Power Attack/Quick Attack) recebe [T√©cnica de Ataque] +15% por 2 passagens de rede.</li>"}
], symbols: [ "img/receivesymbol.png" ] },

/* ==missing Stats== */{ nome: "Yui SSR", funcao: "WS", img: "img/yuiSR.png", School: "Inarizaki", vinculo: [], Stats:{Serve:1264,Spike:1467,Set:1185,Receive:1401,Block:1329,Save:1201}, habilidades:[
  {nome:"Ataque e Defesa Est√°veis", descricao:"Aumenta o [Ataque Potente] de Ginjima Yui em 6/8/10% e a [Recep√ß√£o] em 6/8/10%. Quando ele recebe, se o oponente realizar um Ataque Potente, a pot·∫Ωncia dessa recep√ß√£o aumenta em [Recep√ß√£o] √ó 15/25/35%."},
  {nome:"Recep√ß√£o Poderosa", descricao:"Ginjima Yui recebe com [Recep√ß√£o] √ó 120/135/150% de poder."},
  {nome:"Um Ataque Entusiasmado", descricao:"Sempre que houver um recebedor na equipe, a [T√©cnica de Ataque] de Ginjima Yui aumenta em 2/2.5/3%. Se a recep√ß√£o do companheiro n√£o for RUIM, o [Ataque Potente] de Ginjima Yui aumenta em 15% por at√© quatro cruzamentos de rede."},
  {nome:"Um Golpe Poderoso", descricao:"Ginjima Yui executa um ataque poderoso com [Ataque Potente] √ó 225/240/255/270/285% de poder. Se estiver na linha de tr√°s, a pot√™ncia aumenta em [Ataque Potente] √ó 30%."},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Atributos b√°sicos +10%.</li><li>S2: [Recep√ß√£o] do Tsumu Ginjima +15%. Al√©m disso, a primeira Recep√ß√£o do Ginjima em cada set n√£o erra (n√£o concede ponto).</li><li>S4: Enquanto o Ginjima estiver em quadra, quando a Recep√ß√£o de um aliado n√£o for BAD, a [Percep√ß√£o] do Ginjima +12% por 1 troca.</li>"}
], symbols: [ "img/powersymbol.png", "img/receivesymbol.png" ] },

{ nome: "Hoshiumi UR", data: "12/13/25", funcao: "WS", img: "img/hoshiumiUR.png", School: "Kamomedai", vinculo: ["Amigos de longa data"], Stats:{Serve:1621,Spike:1704,Set:1341,Receive:1541,Block:1581,Save:1305}, habilidades:[
  {nome:"Quebrar a Cadeia", descricao:"Quando Hoshiumi Korai est√° em quadra e um aliado bloqueia, a cada 50 de [Bloqueio] dos bloqueadores, a pot√™ncia da Cortada do advers√°rio (Potente/R√°pida) √© reduzida pelos jogadores atacantes do time [Ataque Potente/Ataque R√°pido] √ó 0.3/0.4/0.5% (m√°x. 30%). Para cada 1% reduzido na cortada do oponente, a pot√™ncia da pr√≥xima habilidade de Hoshiumi aumenta em 1%."},
  {nome:"√ìtimo Desempenho em Todas as √Åreas", descricao:"Hoshiumi Korai pode ativar m√∫ltiplas habilidades de jogadas (compartilham tempo de recarga).\nSaque-Cortada: Realiza um Saque-Cortada com a pot√™ncia de [Saque] √ó 140/160/180% de poder.\nRecep√ß√£o: Recebe com a pot√™ncia de [Recep√ß√£o] √ó 140/160/180% de poder.\nBloqueio: Bloqueia com a pot√™ncia de [Bloqueio] √ó 140/160/180% de poder."},
  {nome:"N¬∫ 1 em Pontuar", descricao:"Aumenta o [Ataque Potente] de Hoshiumi Korai em 16/20/24%. Ao ativar ganha 1 ac√∫mulo de [All-Rounder]. Quando a habilidade de Hoshiumi est√° ativada, o efeito [All-Rounder] √© consumido, e diferentes efeitos s√£o ativados dependendo da jogada.\nPancada Poderosa: Aumenta a[Aten√ß√£o] em 14/17/20% at√© a bola cruzar a rede duas vezes.\nSaque: reduz a [Recep√ß√£o] dos jogadores da linha de tr√°s do oponente em 14/17/20% at√© a bola cruzar a rede duas vezes."},
  {nome:"Lan√ßa Brilhante", descricao:"Executa um ataque poderoso com [Ataque Potente] √ó 265/280/295/310/325% de poder. Se estiver na linha de frente, a pot√™ncia desse ataque aumenta em [Ataque Potente] √ó 40/45/50/55/60%."},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Aumenta os atributos b√°sicos em 13%.</li><li>S2: Quando Korai for realizar um Ataque Potente, aumenta esse ataque em [Ataque R√°pido] x 100%. Quando Korai estiver em quadra e o aliado for realizar um Saque ou Bloqueio, aumenta em 10% os atributos [For√ßa] e [Empenho] dele. Esse efeito dura at√© 5 vezes.</li><li>S4: Ao iniciar a partida, os atributos [Percep√ß√£o] e [Empenho] do Korai aumentam em 85% do valor total da soma desses atributos. Se a jogada da habilidade 2 do Korai resultar em uma Jogada Cr√≠tica, reseta o CD dessa habilidade e Korai recupera 10 de vigor.</li>"}
], symbols: [ "img/powersymbol.png", "img/servesymbol.png", "img/blocksymbol.png", "img/receivesymbol.png" ] },

{ nome: "Hirugami UR", data: "12/28/25", funcao: "MB", img: "img/hirugamiUR.png", School: "Kamomedai", vinculo: ["Amigos de longa data"], Stats:{Serve:1623,Spike:1536,Set:1535,Receive:1377,Block:1704,Save:1377}, habilidades:[
  {nome:"O N√∫cleo do Sistema Kamomedai", descricao:"Quando Hirugami Sachiro saca, sua [Aten√ß√£o] aumenta em 12/16/20%. Estando em quadra, aliados ganham 1 ac√∫mulo de [Sistema] ao bloquear (cada ac√∫mulo aumenta os atributos b√°sicos dos aliados em 8%, at√© 5 ac√∫mulos; dura at√© o aliado pontuar). Cada ac√∫mulo tamb√©m aumenta os atributos b√°sicos de Hirugami em 10% adicionais."},
  {nome:"Saque Psicologicamente Pressionante", descricao:"Executa um Saque Flutuante com Salto com 140/160/180% de [Saque] como poder. Se for uma boa jogada, encerra o Despertar de Moral do oponente, impedindo-o de ganhar Moral por 1 rali."},
  {nome:"A Defesa √© o Melhor Ataque", descricao:"Quando Hirugami est√° em quadra, ganha 1 ac√∫mulo de [Bloqueio Forte] cada vez que a bola cruza a rede. Quando um aliado bloqueia, o efeito depende do n√∫mero de ac√∫mulos de [Bloqueio Forte].\n2 ac√∫mulos: poder de Bloqueio aumenta em 15/20/25% do [Bloqueio] dos bloqueadores por dois cruzamentos de rede.\n3 ac√∫mulos: poder de Recep√ß√£o aumenta em 15/20/25% da [Recep√ß√£o] dos recebedores."},
  {nome:"O Deus Im√≥vel do Dia", descricao:"Bloqueia com [Bloqueio] √ó 260/275/290/305/320% de poder. Se o oponente disparar um ataque poderoso, o bloqueio aumenta em [Bloqueio] √ó 40/45/50/55/60%."},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Aumenta os atributos b√°sicos em 13%.</li><li>S2: Enquanto o time advers√°rio est√° com o efeito Refor√ßo de Moral do Time ativo, quando Hirugami for sacar, aumenta o atributo [Percep√ß√£o] em 20% e recebe 1 ac√∫mulo do efeito [Bloqueio Forte]. Quando o time advers√°rio pontua, recebe 1 ac√∫mulo do efeito [Bloqueio Forte] e os atributos b√°sicos do Hirugami aumentam em 10%, esse efeito dura at√© 4 cruzamentos de rede. Se o time aliado pontuar, o CD da habilidade 4 √© reduzida para 6 cruzamentos de rede.</li><li>S4: O atributo [T√©cnica de Defesa] do Hirugami aumenta em 20%. Quando Hirugami est√° em quadra, aplica 1 ac√∫mulo da penalidade [Perturbar] ao advers√°rio que for realizar um Ataque R√°pido/Potente. A cada 1 ac√∫mulo de [Pertubar], reduz em 5% o atributo [Ataque R√°pido/Potente]. Esse efeito permanece at√© 4 cruzamentos de rede.</li>"}
], symbols: [ "img/servesymbol.png", "img/blocksymbol.png" ] },

{ nome: "Sakusa UR", data: "08/10/26", funcao: "WS", img: "img/sakusaUR.png", School: "Itachiyama", vinculo: ["Top Spiker e Top Libero"], Stats:{Serve:1774,Spike:2012,Set:1583,Receive:1902,Block:1680,Save:1575}, habilidades:[
  {nome:"Ataque Persistente", descricao:"O [Ataque Potente] de Kiyoomi Sakusa aumenta em 10/12.5/15% e sua [Recep√ß√£o] em 20/22/25%. Quando ele recebe um ataque, o [Ataque Potente] aumenta em 6% (at√© 3 ac√∫mulos), durando at√© o seu pr√≥ximo Ataque Potente. Quando ele acerta uma Jogada Potente, a [Recep√ß√£o] aumenta em 15% at√© a sua pr√≥xima recep√ß√£o."},
  {nome:"Tomar Todas as Precau√ß√µes", descricao:"Realiza uma Recep√ß√£o √ó1 com 50/70/90% de poder. Se ao receber exceder [Recep√ß√£o] √ó 170%, o [Reflexo] aumenta em 10% e o tempo de recarga √© reduzido em 2√ó os cruzamentos. Se ao receber exceder a [Recep√ß√£o] √ó 200%, a [T√©cnica de Defesa] aumenta em 15% at√© o fim da partida."},
  {nome:"Ponta Superior", descricao:"Estando em quadra, quando aliados fazem boa jogada (receber, defender, bloquear), ganha 1 ac√∫mulo de [Perfeccionismo]. Cada ac√∫mulo aumenta a [Recep√ß√£o] e o [Ataque Potente] em 6%, at√© 20 ac√∫mulos. Ao atacar, a [Percep√ß√£o] aumenta em 10% por ac√∫mulo, at√© a bola cruzar a rede duas vezes."},
  {nome:"Cortadas que Mudam a Trajet√≥ria pela Rota√ß√£o", descricao:"Executa um [Ataque Potente] com √ó 260/280/300/320/340% de poder. Se estiver na linha de tr√°s, a pot√™ncia aumenta em [Ataque Potente] √ó 40%. Em caso de boa jogada, a pr√≥xima recep√ß√£o do oponente √© reduzida em [Recep√ß√£o] √ó 15%."},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Aumenta os atributos b√°sicos em 13%.</li><li>S2: Ao iniciar a partida, Sakusa recebe 5 ac√∫mulos do efeito [Perfeccionismo]. A cada 1 ac√∫mulo do efeito [Perfeccionismo], aumenta seus atributos [Recep√ß√£o] x 6% e [Ataque Potente] x 6%. Esse efeito ocorre at√© 20 vezes.</li><li>S4: Quando Sakusa est√° em quadra e as jogadas Recep√ß√£o/Defesa/Bloqueio dos aliados s√£o uma Jogada Cr√≠tica, a cada 10% do atributo [Reflex] do aliado que realizou uma Recep√ß√£o/Defesa/Bloqueio Cr√≠tico, Sakusa recebe 1 ac√∫mulo do efeito [Atravessar]. A cada 1 ac√∫mulo do efeito [Atravessar], aumenta 10% do atributo [For√ßa] do Sakusa, podendo ocorrer esse efeito at√© no m√°ximo 15 vezes. O efeito permanece at√© o pr√≥ximo Ataque Potente do Sakusa.</li>"}
], symbols: [ "img/receivesymbol.png", "img/powersymbol.png" ] },

{ nome: "Komori UR", data: "09/09/26", funcao: "L", img: "img/komoriUR.png", School: "Itachiyama", vinculo: ["Top Spiker e Top Libero"], Stats:{Serve:1580,Spike:1579,Set:1904,Receive:2012,Block:1580,Save:1866}, habilidades:[
  {nome:"Pe√ßa-chave da Equipe", descricao:"Estando em quadra, a [T√©cnica de Defesa] de todos os jogadores aliados da linha de tr√°s aumenta em 10/13/16%. No in√≠cio do rali, ganha 6 ac√∫mulos de [Conectar ao Pr√≥ximo]; cada ac√∫mulo aumenta o [Passe] em 3% e o [Reflexo] em 5%, at√© 10."},
  {nome:"Levantamento Habilidoso", descricao:"Realiza Passe com [Passe] √ó 140/160/180% de poder, aumentando a Moral do time em 10. A primeira Cortada (Potente/R√°pida) de um aliado ap√≥s isso aumenta a [Aten√ß√£o] do atacante em 15% at√© a bola cruzar a rede duas vezes."},
  {nome:"Criar o Fluxo do Jogo", descricao:"A [Recep√ß√£o] aumenta em 12/16/20%. Quando um aliado ativa uma recep√ß√£o n√£o-especial ou Komori ativa uma recep√ß√£o especial, consome 2 ac√∫mulos de [Conectar ao Pr√≥ximo] para aumentar a recep√ß√£o em [Recep√ß√£o] √ó 30% e a primeira Cortada de um aliado depois disso aumenta o poder dessa cortada (Potente/R√°pida) em 20%."},
  {nome:"Recep√ß√£o que Cria Impulso", descricao:"Recebe com [Recep√ß√£o] √ó 260/275/290/305/320% de poder. A primeira Cortada de um aliado ap√≥s isso (Potente/R√°pida) aumenta a [T√©cnica de Ataque] do atacante em 20% at√© a bola cruzar a rede duas vezes."},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Aumenta os atributos b√°sicos em 13%.</li><li>S2: 1 - Quando Komori est√° em quadra e ele possui mais que 5 ac√∫mulos do efeito [Conectar ao Pr√≥ximo], a cada 1 ac√∫mulo do efeito [Conectar ao Pr√≥ximo], aumenta a for√ßa de Recep√ß√£o das habilidades de Recep√ß√£o (apenas skill 1, 2 ou 3) em atributo [Recep√ß√£o do aliado a receber] x 4% e aumenta a for√ßa de Passe do Komori em [Passe] x 5%.</li><li>S4: 1 - Quando Komori est√° em quadra, aumenta em 15% o atributo [Reflexo] dos aliados da Linha de Defesa/Tr√°s. 2 - Quando Komori est√° em quadra e o aliado realiza uma Recep√ß√£o, o atributo [For√ßa] do aliado que realizou uma Recep√ß√£o aumenta em [Reflexo do aliado que recebeu] x 50%, podendo aumentar at√© 60%. Esse efeito permanece por 2 cruzamentos de rede.</li>"}
], symbols: [ "img/receivesymbol.png", "img/settersymbol.png" ] },

{ nome: "Kuro SP", funcao: "MB", img: "img/kuroSP.png", School: "Nekoma", vinculo: ["Festival Fogos de Artificio","C√©rebro e Comandante SP"], Stats:{Serve:1753,Spike:1665,Set:1577,Receive:1858,Block:1946,Save:1577}, habilidades:[
  {nome:"A Torre de Comando Imbat√≠vel", descricao:"Quando Kuro Tetsuro (Hanabi) est√° em quadra, o [Empenho] dos aliados na mesma linha de Kuro Tetsuro (Hanabi) aumenta em 20/25/30%. Depois que ele toca na bola, o poder da pr√≥xima jogada do mesmo tipo que a jogada de Kuro Tetsuro (Hanabi) √© aumentado em 40% √ó o par√¢metro correspondente do membro que far√° a jogada. Se a jogada de Kuro Tetsuro (Hanabi) for cr√≠tica, um membro aleat√≥rio do time advers√°rio recebe a desvantagem [Raiva] ([Ataque Potente/Ataque R√°pido] ser√° reduzido em 10%)."},
  {nome:"Recep√ß√£o Habilidosa", descricao:"Kuro Tetsuro (Hanabi) realiza uma recep√ß√£o com poder igual a [Recep√ß√£o] √ó 140/160/180%. Se essa jogada for cr√≠tica, o poder dessa recep√ß√£o aumenta em [Recep√ß√£o] √ó 20%."},
  {nome:"Um Jogador Completo, Sem Falhas", descricao:"Quando Kuro Tetsuro (Hanabi) est√° na linha de frente/tr√°s e toca na bola, seu [Reflexo] aumenta em 50% √ó o [Reflexo] de cada outro aliado na linha de frente/tr√°s (m√°ximo 100%), e seu [Empenho] aumenta em 50% √ó o [Empenho] de cada outro aliado na linha de frente/tr√°s (m√°ximo 100%). Al√©m disso, quando Kuro Tetsuro (Hanabi) est√° na linha de frente, a [T√©cnica de Ataque] dos aliados aumenta em 14/17/20%, e seu poder de bloqueio aumenta em [Bloqueio] √ó 45%. Al√©m disso, quando Kuro Tetsuro est√° na linha de tr√°s, a [T√©cnica de Defesa] dos aliados aumenta em 14/17/20%, e seu poder de recep√ß√£o aumenta em [Recep√ß√£o] √ó 45%."},
  {nome:"Bloqueio Desagrad√°vel", descricao:"Kuro Tetsuro (Hanabi) realiza um bloqueio com poder de [Bloqueio] √ó 280/300/320/340/360%. Se esse bloqueio n√£o devolver a bola para a quadra advers√°ria, a primeira recep√ß√£o de um aliado ap√≥s essa jogada n√£o resultar√° em ponto. Se esse bloqueio devolver a bola para a quadra advers√°ria, os atributos principais de todos os aliados aumentam em 15%. Esse efeito dura at√© a bola atravessar a rede 8 vezes."},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Aumenta os atributos b√°sicos em 13%.</li><li>S2: 1 - Logo ap√≥s Kuroo tocar na bola, o pr√≥ximo aliado a realizar Ataque R√°pido/Potente ter√° a for√ßa de seu atributo [Ataque R√°pido/Potente] aumentado em atributo [Bloqueio do Kuroo] x 20%, podendo aumentar no m√°ximo at√© 1600 de for√ßa. 2 - Se o aliado a realizar o Ataque estiver na Linha de Defesa/Tr√°s, o atributo [T√©cnica de Ataque] desse aliado √© aumentado em 20%. Esse efeito permanece por 2 cruzamentos de rede.</li><li>S4: 1 - Quando Kuroo realiza um Saque, o atributo [Ataque R√°pido/Potente] dos aliados aumenta em 40% e o atributo [Recep√ß√£o] dos aliados da Linha de Defesa/Tr√°s aumenta em 30%. Esse efeito permanece por 1 rally. 2 - O atributo [T√©cncia de Defesa] do Kuroo aumenta em 15%. Se Kuroo estiver na Linha de Defesa/Tr√°s, aumenta em mais 15% seu atributo [T√©cnica de Defesa].</li>"}
], symbols: [ "img/receivesymbol.png", "img/blocksymbol.png" ] },

{ nome: "Kunimi SP", funcao: "OP", img: "img/kunimiSP.png", School: "Aoba Johsai", vinculo: ["Festival de Esporte"], Stats:{Serve:1674,Spike:1950,Set:1573,Receive:1857,Block:1762,Save:1570}, habilidades:[
  {nome:"Conservar Energia", descricao:"Kunimi Akira (Festival de Esporte) ganha +10%/13%/16% de [Ataque Potente]. Se o Vigor de Kunimi for abaixo de 80, seu [Ataque Potente] ganha um adicional de 12%. Enquanto Kunimi estiver na quadra, no final de cada rali, se seu limite de Vigor exceder 80, seu limite de Vigor √© reduzido em 10 e recupera 120 de Vigor. Enquanto Kunimi estiver na quadra, cada vez que o Vigor de um aliado diminuir por 10, Kunimi ganha 1 ac√∫mulo de [Reserva de Vigor]. Para cada ac√∫mulo de [Reserva de Vigor], sua [Percep√ß√£o] cresce em 7%, at√© 30 ac√∫mulos. At√© 10 ac√∫mulos por rali."},
  {nome:"Defesa Precisa", descricao:"Kunimi Akira (Festival de Esporte) realiza uma recep√ß√£o com pot√™ncia de [Recep√ß√£o] x 140%/160%/180%, e os atributos principais dos aliados aumentam em 10%. Esse efeito dura at√© a bola cruzar a rede duas vezes."},
  {nome:"Dar Tudo de Si", descricao:"Cada vez que Kunimi Akira (Festival de Esporte) recupera Vigor, seu [Ataque Potente] cresce em 0.8%/1.1%/1.4% (at√© +16%/22%/28%). No come√ßo de um rali, se o limite de Vigor de Kunimi for 80 ou menos, ele ganha [Momento de Embreagem]. Enquanto [Momento de Embreagem] estiver ativo, o tempo de recarga dele vira em 6 cruzamentos de rede. Se a [Percep√ß√£o] de Kunimi exceder 100%, para cada 1% acima, sua [For√ßa] cresce em 0.9% (at√© 90%). Depois de ganhar [Momento de Embreagem], para as duas primeiras ativa√ß√µes, cada vez que √© usado, o seu tempo de recarga √© zerado."},
  {nome:"Esp√≠rito de Luta Ardente", descricao:"Kunimi Akira (Festival de Esporte) consome +8 de Vigor e realiza um [Ataque Potente] com pot√™ncia de [Ataque Potente] x 295%/315%/335%/375%. Se o Vigor do Kunimi exceder 50, a pot√™ncia do seu ataque cresce em [Ataque Potente] x 50%."},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Aumenta os atributos b√°sicos em 13%.</li><li>S2: Mudan√ßa na habilidade 3: A condi√ß√£o para o aumento do [Ataque Potente] altera de [A cada vez que Kunimi restaura Vigor] para [Quando Kunimi est√° em quadra e os aliados restauram Vigor]. 1 - Ao possuir o efeito [Momento Crucial] e ativar a habilidade 4, restaura 3 de Vigor dos aliados e o aliado com menor Vigor dispon√≠vel recebe 8 a mais de Vigor. 2 - Quando Kunimi est√° como Jogador de Banco, a cada t√©rmino de rally, os aliados recuperam 8 de Vigor.</li><li>S4: 1 - Se o Kunimi est√° posicionado na Escala√ß√£o do Time inicial, os atributos principais dos aliados aumentam em 5%. 2 - Quando Kunimi est√° em quadra, ao iniciar a partida seu limite de Vigor reduz para 80 e a cada 1 de redu√ß√£o, o atributo [For√ßa] do Kunimi aumenta em 1%, podendo aumentar no m√°ximo at√© 120%. 3 - A cada t√©rmino de rally, Kunimi recupera 15 de Vigor. Se Kunimi estiver com menos de 40 de Vigor, ele recupera mais 15 de Vigor.</li>"}
], symbols: [ "img/receivesymbol.png", "img/powersymbol.png" ] },

{ nome: "Koganegawa SP", funcao: "S", img: "img/koganegawaSP.png", School: "Dateko", vinculo: ["Festival de Esporte","Aliados no Campo de Treinamento","Parede de Ferro"], Stats:{Serve:1766,Spike:1661,Set:1858,Receive:1661,Block:1946,Save:1573}, habilidades:[
  {nome:"Bloqueio de Suporte", descricao:"Levantamento do Koganegawa +10%/13%/16%. Quando ele estiver em quadra e um aliado sacar, a [Percep√ß√£o] do membro que sacou aumenta em +20% por 1 cruzamento (m√°x. 1 ac√∫mulo). Tamb√©m ganha 1 ac√∫mulo de [Criar Muralha de Ferro]. Se uma habilidade de Saque for ativada durante esse saque, ganha 1 ac√∫mulo adicional de [Criar Muralha de Ferro]. Quando Koganegawa estiver em quadra, se os aliados executarem um bloqueio duplo ou triplo, ent√£o na pr√≥xima vez que Koganegawa realizar um Levantamento, a [Percep√ß√£o] aumenta em 30% e o [Levantamento] em 10%."},
  {nome:"Setup de Curta Dist√¢ncia", descricao:"Koganegawa realiza um Levantamento com poder [Levantamento] √ó 140%/160%/180%.Durante a primeira cortada de um aliado (Ataque Potente / Ataque R√°pido) ap√≥s esta habilidade ativar, a [Percep√ß√£o] do membro que cortou +10% e [Ataque Potente] / [Ataque R√°pido] +15% por 2 cruzamentos de rede.Al√©m disso, o [Moral da Equipe] +6."},
  {nome:"Canto da Parede de Ferro", descricao:"Enquanto Koganegawa estiver em quadra, no in√≠cio de um rali, os aliados com [Reflexo] ‚â• 200% recebem +10% de [T√©cnica de Ataque] e +10% de [T√©cnica de Defesa].Quando os aliados executarem um bloqueio duplo ou triplo, ou quando a habilidade de [Bloqueio] de um aliado ativar, ganha 1 ac√∫mulo de [Criar Muralha de Ferro] (m√°x. 12).Com ‚â• 3 ac√∫mulos: [Percep√ß√£o] e [Reflexo] dos aliados +20%, e a [Percep√ß√£o] e [Reflexo] do Koganegawa +30%.Com ‚â• 7 ac√∫mulos: no in√≠cio de um rali, o [Bloqueio] da fila da frente dos aliados aumenta em [Bloqueio] do Koganegawa √ó 12% (limite 800/900/1000).Com ‚â• 10 ac√∫mulos: aliados com [Percep√ß√£o] > 100% recebem +15% de [For√ßa], e aliados com [Reflexo] > 100% recebem +25% de [Mental] por 1 set."},
  {nome:"Parede Alta", descricao:"Executa um Bloqueio com poder [Bloqueio] √ó 260%/275%/290%/305%/320%.Se for um bloqueio duplo ou triplo, o [Reflexo] de Koganegawa +40%.Se Parede Alta n√£o estiver em recarga, quando o Supremo de [Bloqueio] de outro aliado ativar, o poder desse bloqueio aumenta em [Bloqueio] do membro que bloqueou √ó 100%, ent√£o Parede Alta entra em recarga."},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Aumenta os atributos b√°sicos em 13%.</li><li>S2: 1 - Quando  Koganegawa est√° em quadra, se o Bloqueio do aliado n√£o resultar em PERFECT, reduz o atributo [Ataque R√°pido/Ataque Potente] do advers√°rio em 16%. Esse efeito permanece por 2 cruzamentos de rede. 2 - Quando a habilidade 4 entra em CD,  o CD da habilidade 2 diminui em 4 cruzamentos de rede. Koganegawa recupera 2 de Vigor. 3 - Koganegawa realiza um Saque com for√ßa de [Saque] x 180% e aumenta o atributo [T√©cnica de Defesa] dos aliados em 10%. Esse efeito permanece por 1 set.</li><li>S4: 1 - Quando Koganegawa est√° na Linha de Ataque/Frente, o CD da habilidade 4 reduz para 4 cruzamentos de rede. 2 - Quando o aliado ativa a habilidade 4 (Suprema), aumenta os atributos [For√ßa] e [Empenho] desse alaido em 2%, at√© no m√°ximo 10%. Se esse aliado possui uma habilidade de Bloqueio, aumenta em mais 35% os atributos [For√ßa] e [Empenho] dele.</li>"}
], symbols: [ "img/blocksymbol.png","img/settersymbol.png" ] },

{ nome: "Oikawa SP", funcao: "S", img: "img/oikawaSP.png", School: "Aoba Johsai", vinculo: ["Rei e Grande Rei","Respira√ß√£o em Harmonia","Rivais de Aoba Jousai","Cultural Festival"], Stats:{Serve:1862,Spike:1766,Set:1950,Receive:1577,Block:1748,Save:1476}, habilidades:[
  {nome:"Performance 100%", descricao:"Atributo [Passe] do Oikawa aumenta em (Lv1: 10%, Lv2: 13%, Lv3: 16%). Ao iniciar o rally, o aliado na diagonal oposta ao Oikawa recebe o efeito 'Performance'. Esse efeito permanece at√© o aliado na diagonal oposta ao Oikawa sair da quadra. Enquanto aliado possuir o efeito 'Performance', os atributos [Percep√ß√£o], [Reflexo] e atributos b√°sicos desse aliado aumentam em 30%. Ao tocar na bola, os aliados recebem 1 ac√∫mulo do efeito 'Tempo do Ataque'. A cada 1 ac√∫mulo do efeito 'Tempo do Ataque', aumenta o atributo [Percep√ß√£o] dos aliados em quadra em 1%, at√© 10 ac√∫mulos. Quando Oikawa est√° em quadra e o aliado ativa uma habilidade Suprema, recebe 1 ac√∫mulo do efeito 'Tempo do Ataque'."},
  {nome:"Saque Sniper", descricao:"Oikawa realiza um Saque com for√ßa de [Saque] x (Lv1: 160%, Lv2:180%, Lv3: 200%). Se essa Saque resultar em Ace, o tempo de recarga da habilidade 2 √© resetado. Ao possuir 5 ac√∫mulos do efeito 'Liderar', a for√ßa desse Saque aumenta em [Saque] x 150%."},
  {nome:"Torre de Comando", descricao:"Quando Oikawa est√° em quadra, no momento em que o aliado for realizar um Ataque R√°pido/Potente, se possuir mais de 6 ac√∫mulos do efeito 'Tempo do Ataque', todos os ac√∫mulos s√£o consumidos e Oikawa recebe 1 ac√∫mulo do efeito 'Liderar', at√© 5 ac√∫mulos. A cada 1 ac√∫mulo consumido do efeito 'Tempo do Ataque', a for√ßa desse Ataque do aliado √© aumentada em atributo [Ataque R√°pido/Potente do aliado] x (Lv1: 15%, Lv2: 17.5%, Lv3: 20%). 3 - A cada 1 ac√∫mulo do efeito 'Liderar', o atributo [Percep√ß√£o] do aliado aumenta em (1 ac√∫mulo: 40%, 2 ac√∫mulos: 30%, 3 ac√∫mulos: 20%, 4 ac√∫mulos: 10%) e o atributo [For√ßa] do Oikawa aumenta em 15%, at√© 60%. Ao possuir 5 ac√∫mulos do efeito 'Liderar', quando o aliado que possui o efeito 'Performance' pontuar, o tempo de recarga das habilidades do Oikawa √© resetado."},
  {nome:"Passe Perfeito", descricao:"Oikawa realiza um Levantamento com for√ßa de [Passe] x (Lv1: 260%, Lv2: 275%, Lv3: 290%, Lv4: 305%, Lv5: 320%). Os advers√°rios da Linha de Defesa/Tr√°s tem sua Recep√ß√£o reduzida em 20%. Esse efeito permanece por 2 cruzamentos de rede. Ap√≥s a ativa√ß√£o da habilidade de Levantamento do Oikawa, se o primeiro Ataque R√°pido/Potente logo ap√≥s esse levantamento for de um aliado que possui o efeito 'Performance', os advers√°rios da Linha de Ataque/Frente tem seu Bloqueio reduzido em 20%. Esse efeito permanece por 2 cruzamentos de rede. A cada set, ao ativar pela vez essa habilidade, os aliados recebem 5 ac√∫mulos do efeito 'Tempo do Ataque'."},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Aumenta os atributos b√°sicos em 13%.</li><li>S2: 1 - Atributo [For√ßa] do Oikawa aumenta em 20%. 2 - Os toques do Oikawa ser√£o todos Cr√≠ticos. 3 - Quando um aliado realizar uma Jogada Cr√≠tica, o tempo de recarga da habilidade Suprema do Oikawa √© reduzido em 1 cruzamente de rede. 4 - A cada 1 ac√∫mulo do efeito [Tempo do Ataque] adquirido pelos aliados, o levantador aliado que tocar na bola ter√° seus atributos [Passe] e [Saque] aumentado em 2%, at√© 20%. Esse efeito permanece por 2 cruzamentos de rede.</li><li>S4: 1 - Atributo [For√ßa] do Oikawa aumenta em 40%. 2 - O membro que possuir ac√∫mulo do efeito [Performance] ter√° seus atributos de Ataque (Ataque R√°pido/Potente, Passe, Saque, Percep√ß√£o, For√ßa e T√©cnica de Ataque) aumentados em 50% dos atributos correspondentes do Oikawa. Aumenta no m√°ximo at√© 1500 dos atributo b√°sicos (Ataque R√°pido/Potente, Passe e Saque), 100% do atributo [For√ßa] e 10% do atributo [T√©cnica de Ataque]</li>"}
], symbols: [ "img/powersymbol.png","img/settersymbol.png","img/servesymbol.png"] },

{ nome: "Iwaizumi SP", funcao: "WS", img: "img/iwaizumiSP.png", School: "Aoba Johsai", vinculo: ["Respira√ß√£o em Harmonia","Cultural Festival"], Stats:{Serve:1665,Spike:1766,Set:1577,Receive:1947,Block:1753,Save:1670}, habilidades:[
  {nome:"Alta Concentra√ß√£o", descricao:"Atributo [Ataque Potente] do Iwaizumi aumenta 10%/13%/16%) e [Recep√ß√£o] aumenta em 15%/20%/25%. Ao iniciar o rally, se o atributo [Percep√ß√£o] do Iwaizumi passar de 100%, aumenta em mais 20% seu atributo [Recep√ß√£o]. Esse efeito permanece por 1 rally. Ao final do rally, remove aleatoriamento 1 efeito debuff aplicado no Iwaizumi."},
  {nome:"Atravessar o Bloqueio", descricao:" Iwaizumi realiza um Ataque Potente com for√ßa de [Ataque Potente] 140%/160%/180%). Se o Bloqueio do advers√°rio for um Bloqueio Duplo/Triplo, esse Ataque aumenta em mais [Ataque Potente] x 60%."},
  {nome:"Pilar Espiritual", descricao:"Quando Iwaizumi est√° em quadra, os aliados presentes em quadra tem seu atributo [For√ßa] aumentado em 20%/25%/30%. Quando Iwaizumi ativa uma habilidade, seu atributo [Percep√ß√£o] √© aumentado em 20%. At√© 10 ac√∫mulos. Ao ativar a habilidade Suprema do Iwaizumi, sua for√ßa de Recep√ß√£o √© reduzida em [Recep√ß√£o] x 50%. Esse efeito permanece por 1 rally. O tempo de recarga da habilidade Suprema √© resetado."},
  {nome:"Reflexos Divinos", descricao:"Iwaizumi realiza uma Recep√ß√£o com for√ßa de [Recep√ß√£o] x 360%/375%/390%/405%/420%. O atributo [Reflexo] do Iwaizumi aumenta em [Percep√ß√£o] x 100%. Esse efeito permanece por 2 cruzamentos de rede. O atributo [Empenho] do Iwaizumi aumenta em 20%. At√© 3 ac√∫mulos. Esse efeito permanece por 1 rally."},
{nome:"Resson√¢ncias",descricao:"<li>S1/3/5: Aumenta os atributos b√°sicos em 13%.</li><li>S2: Quando Iwaizumi est√° em quadra, aumenta o atributo [For√ßa] dos aliados em 20%. Ao ativar a habilidade Suprema, os aliados recuperam 5 de vigor e o time aliado recebe 20 de Moral. A Moral recebida durante a ativa√ß√£o da habilidade Suprema √© resetada ao final do rally.</li><li>S4: Ao ativar a habilidade Suprema, o atributo [Recep√ß√£o] do Iwaizumi aumenta em 15%. At√© 3 ac√∫mulos. Esse efeito permanece por 2 cruzamentos de rede. Se o atributo [Percep√ß√£o] do Iwaizumi estiver passado de 100%, a cada 1% a mais o atributo [Empenho] √© aumentado em 1%. M√°ximo de 80% de aumento.</li>"}
], symbols: [ "img/powersymbol.png","img/receivesymbol.png"] },

{ nome: "Ushijima SP", funcao: "OP", img: "img/ushijimaSP.png", School: "Shiratorizawa", vinculo: ["Rivais de Aoba Jousai","Cultural Festival","Amigo de Vida Inteira"],Stats:{Serve:1854,Spike:1968,Set:1748,Receive:1573,Block:1759,Save:1482}, habilidades:[
  {nome:"Poder Nacional",descricao:"Quando Ushijima [Festival Cultural] adquire um efeito desfavor√°vel, o [Ataque Potente] e o [Saque] aumentam em 2/ 2,5/ 3%. M√°ximo de 6 ac√∫mulos.Quando Ushijima [Festival Cultural] est√° em quadra, sempre que o toque de bola de um membro da equipe for cr√≠tico, o [Awareness] de Ushijima aumenta em 8%. Acumula at√© 99 vezes."},
  {nome:"Saque Destrutivo",descricao:"<li>CD: 6 cruzamentos de rede.</li> Ushijima Wakatoshi [Festival Cultural] realiza um saque em salto com poder igual a [Saque] x 140/160/180%. O poder de recep√ß√£o do oponente √© reduzido em [Recep√ß√£o] x 100%. Esse efeito dura at√© a bola cruzar a rede duas vezes."},
  {nome:"Esmagar",descricao:"<li>A [Percep√ß√£o] de Ushijima [Festival Cultural] √© dobrado.</li><li>Se a [Percep√ß√£o] de Ushijima [Festival Cultural] for 200% ou superior, o limite de recarga de [Poder de Classe Canh√£o] (Skill 4) √© reduzido em 4 cruzamentos de rede.</li><li>Se a [Recep√ß√£o] de Ushijima [Festival Cultural] for 50% ou superior, o poder do primeiro [Poder de Classe Canh√£o] (Skill 4) do rali √© aumentado em [Ataque Potente] x 40/55/70%.</li><li>Se a [Percep√ß√£o] de Ushijima [Festival Cultural] for 400% ou superior, para cada 1% de [Percep√ß√£o] acima de 400%, a [For√ßa] aumenta em 0,7%. O aumento m√°ximo poss√≠vel √© de 70%.</li>"},
  {nome:"Poder de Classe Canh√£o",descricao:"<li>CD: 8 cruzamentos de rede</li><li>Ushijima [Festival Cultural] realiza um ataque de poder com for√ßa igual a [Ataque Potente] x 260/275/290/305/320%.</li><li>Se a recep√ß√£o do oponente for realizada por um jogador diferente daquele que recebeu o ataque anterior de Ushijima, o poder dessa recep√ß√£o ser√° reduzido em [Recep√ß√£o] x 50%. Esse efeito dura at√© a bola cruzar a rede duas vezes.</li>"},
  {nome:"Ressonances",descricao:"<li>S1/3/5: Aumenta os atributos b√°sicos em 13%.</li><li>S2: O tempo de recarga de [Poder de Classe Canh√£o] (Skill 4) √© reduzido em 4 cruzamentos de rede.Quando Ushijima [Festival Cultural] realiza um ataque de poder e o resultado excede [Ataque Potente] x 300%, o poder desse ataque aumenta em 30% x [Ataque Potente].</li><li>S4:No in√≠cio da partida, a [Percep√ß√£o] de Ushijima [Festival Cultural] aumenta em 100%.Ao final de cada rali, a [Percep√ß√£o] de Ushijima [Festival Cultural] √© reduzido em 20% e o [Ataque Potente] aumenta em 6%. Acumula at√© 5 vezes.</li>"}
], symbols: [ "img/powersymbol.png", "img/servesymbol.png" ] },
     { nome: "Tendo SP", funcao: "MB", img: "img/tendoSP.png", School: "Shiratorizawa", vinculo: ["Amigo de Vida Inteira","F√©rias de Inverno"],Stats:{Serve:1754,Spike:1881,Set:1748,Receive:1577,Block:1951,Save:1489}, habilidades:[
  {nome:"Bloqueio Intuitivo",descricao:"O [Bloqueio] do Tendo SP aumenta em 12/15/18%.Quando ele usa [Percep√ß√£o], a chance de ativar uma Jogada Superior em Recep√ß√£o / Cobertura / Bloqueio aumenta.No in√≠cio da partida, a [Reflexo] do Tendo (Winter Break) √© reduzida para 0%, e para cada 1% reduzido, o seu [Empenho] aumenta em 2%."},
  {nome:"Ataque Afiado",descricao:"Tendo SP realiza um ataque r√°pido com poder igual a [Ataque R√°pido] √ó 140/150/160%.Se o poder desse ataque r√°pido ultrapassar [Ataque R√°pido] √ó 200%, ent√£o [Ataque R√°pido] aumenta em 20%.Esse efeito dura at√© a bola cruzar a rede 8 vezes."},
  {nome:"Estilo N√£o Convencional",descricao:"No in√≠cio da partida, a [Percep√ß√£o] do Tendo SP aumenta em 50%.Quando ele realiza uma Jogada Superior, sua [Percep√ß√£o] diminui em 10%, e seu [Bloqueio] aumenta em 3/4/5%.Esse efeito pode acumular at√© 6 stacks.Quando o Tendo SP faz uma Jogada Superior, o poder da habilidade aumenta em 65% do atributo correspondente ao tipo da jogada.Se n√£o for uma Jogada Superior, o poder da habilidade diminui em 85% do atributo correspondente.Quando um aliado ativa sua Ultimate, esse aliado recebe 1 stack de [Sinergia].Ao atingir 2 stacks, todos os stacks de [Sinergia] s√£o removidos e o aliado recebe +15% em [T√©cnica de Ataque] e [T√©cnica de Defesa].Esse efeito dura 2 rallies.A Moral da sua equipe aumenta em 10."},
  {nome:"Parede Intranspon√≠vel",descricao:"Tendo SP realiza um bloqueio com poder igual a [Bloqueio] √ó 240/255/270/285/300%. Cada vez que ele ativa sua Ultimate, o poder da Ultimate aumenta em [Bloqueio] √ó 20%, e o limite de cooldown aumenta em +2 cruzamentos de rede."},
  {nome:"Ressonances",descricao:"<li>S1/3/5: Aumenta os atributos b√°sicos em 13%.</li><li>S2:[Percep√ß√£o] do Tendo SP +25% e [Empenho] do Tendo + (For√ßa √ó 60%), at√© um m√°ximo de 60%</li><li>S4:Quando o Tendo est√° em quadra e um aliado usa a Ultimate, todos os aliados recebem +1% no atributo principal, acumulando at√© 20 stacks.Esse efeito dura um set.Na primeira vez que o Tendo sair da quadra, o jogador que entrar no lugar dele recebe +15% em [T√©cnica de Defesa] por 1 rally.A pr√≥xima recep√ß√£o realizada se tornar√° automaticamente uma Jogada Superior e n√£o causar√° ponto perdido.</li>"}
], symbols: [ "img/blocksymbol.png","img/quicksymbol.png" ] },
    { nome: "Ginjima SP", funcao: "WS", img: "img/ginjimaSP.png", School: "Inarizaki", vinculo: ["ZZZ"],Stats:{Serve:1762,Spike:1964,Set:1573,Receive:1855,Block:1667,Save:1564}, habilidades:[
  {nome:"Skill 1",descricao:"O [Power Attack] de Ginjima aumenta em 10/15/20%.Quando Ginjima est√° em quadra e a recep√ß√£o do oponente n√£o √© BAD, o ataque potente de Ginjima √© executado com +10% do seu [Ataque Potente], acumulando at√© 5 stacks.Esse efeito dura pelo restante do set."},
  {nome:"Skill 2",descricao:"Ginjima realiza uma recep√ß√£o com 140/160/180% da sua [Recep√ß√£o].O pr√≥ximo ataque potente de Ginjima √© executado com +40% do seu [Ataque Potente]."},
  {nome:"Skill 3",descricao:"Quando Ginjima realiza um Ataque Potente, seu [Ataque Potente] aumenta baseado no [Ataque R√°pido], at√© um aumento m√°ximo de 1500/1750/2000.Para as duas primeiras investidas de cada set, sua [Percep√ß√£o] aumenta em 100% e sua [For√ßa] aumenta em 30/40/50%.Esse efeito dura at√© a bola cruzar a rede duas vezes.Se o Ataque Potente de Ginjima for a primeira Cortada Ultimate (skill 4 de corte) do set, o [Ataque Potente] dele aumenta em 100%, durando at√© a bola cruzar a rede duas vezes."},
  {nome:"Skill 4",descricao:"Ginjima executa um Ataque Potente com 260/280/300/320/340% do seu [Ataque Potente].O bloqueador e/ou o recebedor inimigo perdem 8 de stamina.Se o atributo da equipe dele estiver em vantagem, a [Tecnica de Ataque] de Ginjima aumenta em 20%."},
  {nome:"Ressonances",descricao:"<li>S1/3/5: Aumenta os atributos b√°sicos em 13%.</li><li>S2:Ginjima n√£o √© afetado por efeitos negativos. Quando o ataque potente de Ginjima resulta em um acerto cr√≠tico, o pr√≥ximo power spike √© executado com +60% do seu [Ataque Potente].</li><li>S4:O cooldown da ultimate dele √© alterado para 4 cruzamentos de rede.Mudan√ßa no efeito de [Ataque Ilimitado]:A condi√ß√£o para aumentar [Percep√ß√£o] e [For√ßa] muda de [duas primeiras investidas por set] para [tr√™s primeiras investidas por set]. Quando Ginjima realiza um ataque potente, o pr√≥ximo aliado a realizar uma cortada (Potente ou R√°pida) executar√° o golpe com +50% adicional do seu respectivo [Ataque Potente] / [Ataque R√°pido].</li>"}
], symbols: [ "img/powersymbol.png","img/receivesymbol.png" ] },
    { nome: "Atsumu SP", funcao: "S", img: "img/atsumuSP.png", School: "Inarizaki", vinculo: ["F√©rias de Inverno","G√™meos Mais Fortes do Ensino M√©dio"],Stats:{Serve:1887,Spike:1744,Set:1951,Receive:1578,Block:1755,Save:1485}, habilidades:[
  {nome:"Jogo Livre",descricao:"O [Passe] e o [Saque] de Atsumu SP aumentam em 10/15/20%.No in√≠cio de cada ponto, qualquer jogador com [Percep√ß√£o] abaixo de 30% recebe o efeito [Insight].Esse efeito aumenta a [T√©cnica de Ataque] e a [T√©cnica de Defesa] do jogador em 10%.Todos os stacks de [Insight] s√£o removidos ao final do ponto."},
  {nome:"Saque Avassalador",descricao:"Atsumu SP alterna entre um saque flutuante e um saque por cima (de forma semelhante √† sua vers√£o UR).Saque Flutuante: Atsumu SP executa um saque flutuante com 140/160/180% do seu [Saque]. Os oponentes n√£o podem usar skills de ATAQUE por 2 cruzamentos de rede.Saque por cima: Atsumu SP executa um saque por cima com 160/180/200% do seu [Saque]. Os oponentes n√£o podem usar skills de RECEP√á√ÉO por 2 cruzamentos de rede."},
  {nome:"Passe por Intui√ß√£o",descricao:"O primeiro passe de Atsumu SP em cada ponto tem seu [Passe] aumentado em 20/25/30%.Quando Atsumu SP ativa ‚ÄúPasse Reflexivo‚Äù, a [T√©cnica de Ataque] e a [T√©cnica de Defesa] dos aliados que possuem o efeito [Insight] aumentam em 20% e 15%, respectivamente.Ap√≥s usar ‚ÄúPasse Reflexivo‚Äù, se a [T√©cnica de Ataque] do aliado que realizar o corte seguinte for superior a 60%, esse core ser√° uma jogada cr√≠tica."},
  {nome:"Passe Reflexivo",descricao:"Atsumu SP realiza um passe com poder equivalente a 260/275/290/305/320% do seu [Passe].Se a [T√©cnica de Ataque] de Atsumu SP for superior a 40%, esse passe ser√° cr√≠tico."},
  {nome:"Ressonances",descricao:"<li>S1/3/5: Aumenta os atributos b√°sicos em 13%.</li><li>S2: No in√≠cio de cada ponto, aliados com [Percep√ß√£o] abaixo de 30% t√™m o tempo de recarga de suas skills reduzido em 2 cruzamentos de rede.Sempre que um aliado ativa uma skill de passe, o tempo de recarga de [Passe Reflexivo] √© reduzido em 1 cruzamento de rede, e o [Passe] de Atsumu SP aumenta em 10%, acumulando infinitamente.</li><li>S4: Enquanto Atsumu SP estiver em quadra, todos os aliados com [T√©cnica de Ataque] acima de 40% recebem +35% de [T√©cnica de Ataque] e +25% de [T√©cnica de Defesa].O primeiro saque de Atsumu SP na partida ser√° garantidamente cr√≠tico e ter√° os efeitos combinados de float e top spin, fazendo com que os oponentes n√£o possam usar skills de recep√ß√£o nem de ataque por 2 cruzamentos de rede.</li>"}
], symbols: [ "img/quicksymbol.png","img/servesymbol.png","img/settersymbol.png" ] },
    { nome: "Osamu SP", funcao: "OP", img: "img/osamuSP.png", School: "Inarizaki", vinculo: ["F√©rias de Inverno","G√™meos Mais Fortes do Ensino M√©dio"],Stats:{Serve:1766,Spike:1967,Set:1841,Receive:1573,Block:1750,Save:1490}, habilidades:[
  {nome:"Ataque de Alta Velocidade",descricao:"O [Ataque R√°pido] de Osamu SP aumenta em [Passe] √ó 30/40/50%, podendo aumentar at√© o m√°ximo de 1000/1250/1500. No in√≠cio da partida, a [Percep√ß√£o] de Osamu SP √© reduzido para 0% e, para cada 1% reduzido, o [Ataque R√°pido] aumenta em 2%, podendo aumentar at√© o m√°ximo de 100%. Ao final de cada rally, a [Percep√ß√£o] de Osamu SP √© novamente reduzido para 0%."},
  {nome:"Passe Especialista",descricao:"Osamu SP realiza um passe com 150% do seu [Passe]. Quando um aliado ativa uma skill de passe enquanto Osamu SP est√° em quadra, o poder do \"Passe Especialista\" (skill 2) aumenta em [Passe] √ó 30/40/50%, podendo aumentar at√© o m√°ximo de 210/240/250%."},
  {nome:"Ajuste T√°tico",descricao:"Quando um aliado ativa uma skill de passe enquanto Osamu SP est√° em quadra, a [T√©cnica de Ataque] e a [T√©cnica de defesa] do aliado que utilizou o set aumentam em 2/2,5/3%. Acumula at√© 4 stacks. Quando Osamu SP ativa sua Ultimate, A [T√©cnica de Ataque] aumenta em [T√©cnica de Ataque] √ó 50%, podendo aumentar at√© o m√°ximo de 100%. Este efeito dura por 2 cruzamentos de rede. (Se o poder do \"Passe Especialista\" for igual ou superior a [Passe] √ó 300%, o [Passe] de Osamu SP aumenta em 50% e o \"Set Especialista\" se torna um movimento especial.)"},
  {nome:"Ataque R√°pido que Atrai o Oponente",descricao:"Osamu SP executa um ataque r√°pido com [Ataque R√°pido] √ó 255/270/285/300/315%. Se a [T√©cnica de Ataque] de Osamu SP for 40% ou maior, o poder desse ataque r√°pido aumenta em [Ataque R√°pido] √ó 60% e ele n√£o pode ser bloqueado."},
  {nome:"Ressonances",descricao:"<li>S1/3/5: Aumenta os atributos b√°sicos em 13%.</li><li>S2:Quando um aliado ativa uma skill de passe enquanto Osamu SP est√° em quadra, o [Ataque R√°pido] do aliado aumenta em 10%, podendo aumentar at√© o m√°ximo de 30%. Esse efeito dura por 1 rally. O [Ataque R√°pido] de Osamu SP aumenta adicionalmente em 5%, podendo aumentar at√© 15%.</li><li>S4:No in√≠cio da partida, o poder do \"Passe Especialista\" aumenta em [Passe] √ó 150%. Quando Osamu SP realiza um passe, a [T√©cnica de Ataque] do membro que realiza o spike (Ataque Potente/R√°pido) aumenta em [T√©cnica de Ataque] de Osamu SP √ó 60%, podendo aumentar at√© o m√°ximo de 60%. Este efeito dura por 2 cruzamentos de rede.</li>"}
], symbols: [ "img/quicksymbol.png","img/settersymbol.png" ] },
    { nome: "Korai SP", funcao: "WS", img: "img/koraiSP.png", School: "Kamomedai", vinculo: ["Esportes de Inverno"],Stats:{Serve:1854,Spike:1952,Set:1529,Receive:1766,Block:1810,Save:1494}, habilidades:[
  {nome:"Jogador Principal",descricao:"Quando um aliado com skill de Bloqueio toca na bola, os atributos desse aliado [Bloqueio], [Ataque Potente] e [Ataque R√°pido] aumentam em 4/5/6%.Este efeito acumula at√© 3 vezes e dura 2 rallies.Se esse aliado possuir uma Ultimate de Bloqueio, seus atributos [Bloqueio], [Ataque Potente] e [Ataque R√°pido] aumentam em 4/5/6% adicionais.Este efeito tamb√©m acumula at√© 3 vezes e dura 2 rallies."},
  {nome:"Jogada Vers√°til",descricao:"CD: 8 . Saque:Korai Hoshiumi (Esportes de Inverno) realiza um saque com [Saque] √ó 140/160/180%.Se o tipo de time for Bloqueio ou Ataque R√°pido, seus [Ataque Potente] e [Ataque R√°pido] aumentam em 100%.Este efeito dura 1 rally.Recep√ß√£o:Korai Hoshiumi (Esportes de Inverno) realiza uma recep√ß√£o com [Recep√ß√£o] √ó 140/160/180%.Se o tipo de time for Bloqueio ou Ataque R√°pido, o [Bloqueio] de Korai Hoshiumi aumenta em 3000 (n√£o acumula).Bloqueio:Korai Hoshiumi (Esportes de Inverno) realiza um bloqueio com [Bloqueio] √ó 140/160/180%.Se o tipo de time for Ataque Potente ou Recep√ß√£o, a [Recep√ß√£o] de Korai Hoshiumi aumenta em 3000 (n√£o acumula)."},
  {nome:"Vers√°til Completo",descricao:"Quando um aliado ativa uma skill que corresponde ao tipo do time, Korai Hoshiumi (Esportes de Inverno) ganha 2 stacks de [Versatilidade].Cada stack de [Versatilidade] aumenta os atributos principais em 2,5%.M√°ximo de 10 stacks.Quando Korai Hoshiumi (Esportes de Inverno) ativa uma Ultimate que corresponde ao tipo do time, ele ganha 1 stack adicional de [Versatilidade].Quando Korai Hoshiumi (Esportes de Inverno) ativa uma skill, seus [Percep√ß√£o] e [Reflexo] aumentam em 40/50/70%.Para cada stack de [Versatilidade], [Percep√ß√£o] e [Reflexo] aumentam em 20% adicionais.Este efeito dura 2 cruzamentos de rede.Se a [Percep√ß√£o] de Korai Hoshiumi (Esportes de Inverno) ultrapassar 105%, sua [For√ßa] aumenta em 50%.Este efeito dura 1 rally.Se o [Reflexo] de Korai Hoshiumi ultrapassar 100%, sua [For√ßa] aumenta em 70%.Este efeito dura 1 rally (n√£o acumula).Se o tipo de time for Bloqueio ou Ataque R√°pido, o [Bloqueio] de Korai Hoshiumi aumenta em 200%.Se o tipo de time for Ataque Potente ou Recep√ß√£o, a [Recep√ß√£o] de Korai Hoshiumi aumenta em 200%."},
  {nome:"Marcador de Pontos",descricao:"CD: 8 . Korai Hoshiumi (Esportes de Inverno) realiza um ataque com [Ataque Potente] √ó 275/290/305/320/335%.Se o tipo de time for Bloqueio ou Ataque R√°pido, o [Ataque Potente] de Korai Hoshiumi aumenta em 5% a cada 500 pontos de [Ataque R√°pido], at√© um m√°ximo de 60%.Este efeito dura 2 cruzamentos de rede e tamb√©m √© tratado como Ataque R√°pido.Se o tipo de time for Ataque Potente ou Recep√ß√£o, o poder deste ataque aumenta em [Ataque Potente] √ó 50%.Se resultar em cr√≠tico, o poder aumenta em [Ataque Potente] √ó 50% adicionais."},
  {nome:"Ressonances",descricao:"<li>S1/3/5: Aumenta os atributos b√°sicos em 13%.</li><li>S2:Quando Korai Hoshiumi (Esportes de Inverno) usa Jogada Vers√°til, seu [Ataque Potente] aumenta em 50%, at√© no m√°ximo 150%.Este efeito dura 1 rally.Quando Korai Hoshiumi (Esportes de Inverno) usa Point Getter, seu [Ataque Potente] aumenta em mais 50%, at√© no m√°ximo 150%.Este efeito tamb√©m dura 1 rally.Se o tipo de time for vantajoso, o [Ataque Potente] de Korai Hoshiumi (Esportes de Inverno) aumenta em 20%.Atributos que coincidirem com o tipo do time recebem +20% adicionais.</li><li>S4:Quando Korai Hoshiumi (Esportes de Inverno) ativa Jogada Vers√°til (Skill 2), o resultado ser√° sempre um cr√≠tico.Todas as skills, incluindo a Ultimate, passam a ser tratadas como skills de [Versatilidade] ativadas.Quando Korai Hoshiumi (Esportes de Inverno) ativa uma skill, seus [For√ßa] e [Esp√≠rito] aumentam em 40%, at√© um m√°ximo de 200%.Este efeito dura 1 rally.</li>"}
], symbols: [ "img/blocksymbol.png","img/servesymbol.png","img/receivesymbol.png","img/quicksymbol.png","img/powersymbol.png" ] },
    { nome: "Hirugami SP", funcao: "MB", img: "img/hirugamiSP.png", School: "Kamomedai", vinculo: ["Esportes de Inverno"],Stats:{Serve:1762,Spike:1880,Set:1748,Receive:1573,Block:1952,Save:1490}, habilidades:[
  {nome:"Skill 1",descricao:"O [Bloqueio] de Sachir≈ç Hirugami (Esportes de Inverno) aumenta em 6/8/10% no in√≠cio de cada rally, at√© 6 stacks.Enquanto Sachir≈ç Hirugami (Esportes de Inverno) estiver em quadra, no in√≠cio de um rally:Se o rally anterior teve 8 ou mais cruzamentos de rede, a recarga das Ultimates de Bloqueio dos seus jogadores √© reduzida em 4 cruzamentos de rede.Se o rally anterior teve menos de 8 cruzamentos de rede, os Atributos B√°sicos dos seus jogadores aumentam em 15%.Ambos os efeitos duram at√© o final do set e n√£o acumulam."},
  {nome:"Ataque de Continua√ß√£o",descricao:"Sachir≈ç Hirugami (Esportes de Inverno) realiza um Ataque R√°pido com 140/160/180% do [Ataque R√°pido].Quando Sachir≈ç Hirugami (Esportes de Inverno) usa Parede Anti-Ataque, se Ataque de Continua√ß√£o n√£o estiver em recarga, o [T√©cnica de Defesa] de Sachir≈ç Hirugami aumenta em 10% por 2 cruzamentos de rede, e Ataque de Continua√ß√£o entra em recarga."},
  {nome:"Skill 3",descricao:"Enquanto Sachir≈ç Hirugami (Esportes de Inverno) estiver em quadra, ele ganha 1 stack de [Troca] quando um jogador do seu time toca na bola.Para cada stack de [Troca], o [Bloqueio] de Sachir≈ç Hirugami (Esportes de Inverno) aumenta em 5%.No final de cada rally, todos os stacks de [Troca] s√£o consumidos, e para cada stack consumido, todos os jogadores do seu time t√™m [T√©cnica de Ataque] e [T√©cnica de Defesa] aumentados em 4,5/5/5,5%, at√© um m√°ximo de 60%, por 1 ponto.No in√≠cio da partida, a recarga inicial de Parede Anti-Ataque √© reduzida em 2 cruzamentos de rede (reduz a recarga para 10)."},
  {nome:"Parede Anti-Ataque",descricao:"Sachir≈ç Hirugami (Esportes de Inverno) realiza um Bloqueio com 275/290/305/320/335% do [Bloqueio].Se o oponente realizar um Ataque Cr√≠tico, o [Reflexo] de Sachir≈ç Hirugami (Esportes de Inverno) aumenta em 100%."},
  {nome:"Ressonances",descricao:"<li>S1/3/5: Aumenta os atributos b√°sicos em 13%.</li><li>S2:Se o oponente realizar um Ataque Cr√≠tico, a recarga de Parede Anti-Ataque √© reduzida em 2 cruzamentos de rede, e o [Esp√≠rito] de Sachir≈ç Hirugami (Esportes de Inverno) aumenta em 40% por 2 cruzamentos de rede.Sachir≈ç Hirugami (Esportes de Inverno) realiza um Saque Flutuante com Salto com 200% de seu [Saque].A Moral do Time do oponente √© reduzida em 40, e eles n√£o podem ganhar Moral do Time por 1 rally.Esta a√ß√£o √© tratada como uma skill de Saque e possui recarga de 6 cruzamentos de rede.</li><li>S4:Quando Sachir≈ç Hirugami (Esportes de Inverno) participa de um bloqueio duplo ou triplo, os atributos b√°sicos dos seus jogadores com skills de Bloqueio aumentam em 20%.Seus 4 jogadores da linha de frente t√™m [Bloqueio] e [Ataque R√°pido] aumentados em 2000 adicionais.Este efeito dura 1 rally.Para cada stack de [Troca] consumido, o [Reflexo] dos seus jogadores aumenta em 10% e o [Esp√≠rito] aumenta em 6%, ambos durando 1 rally.</li>"}
], symbols: [ "img/blocksymbol.png","img/quicksymbol.png" ] },
];
window.charactersPT = characters;

// se EN n√£o estiver carregado aqui, faz fallback pra PT (n√£o quebra nada)
window.charactersEN = window.charactersEN || window.charactersPT;

// ponteiro "oficial" que o resto do site usa
window.characters   = window.charactersPT;
window.allCharacters = window.charactersPT;

// (opcional) util de acesso usado por buscas/imports
window.getAllCharacters = function(){
  return window.allCharacters || window.characters || window.charactersEN || [];
};
const descricoesSinergia = {
  "Karasuno": "Aumenta em 10% os Stats de Ataque Potente e Ataque R√°pido de TODOS os jogadores.",
  "Nekoma": "Aumenta em 15% o Stat de Recep√ß√£o de TODOS os jogadores.",
  "Dateko": "Aumenta em 15% o Stat de Bloqueio de TODOS os jogadores.",
  "Aoba Johsai": "Aumenta em 15% o Stat de Ataque Potente de TODOS os jogadores.",
  "Shiratorizawa": "Aumenta em 10% os Stats de Percep√ß√£o e For√ßa de TODOS os jogadores.",
  "Fukurodani": "A Moral do Time aumenta em 20.",
  "Inarizaki": "Aumenta em 5% os Stats de For√ßa e Defesa de TODOS os jogadores.",
  "Dupla Exc√™ntrica": "Aumenta o poder de Ataque R√°pido e a Percep√ß√£o de Hinata e Kageyama.",
  "G√™nios Karasuno": "Aumenta o Reflexo e a Recep√ß√£o de Nishinoya SP. Quando Nishinoya usa o especial, Kageyama UR ganha um ac√∫mulo de Competitive Spirit*. Se o especial for PERFECT, o primeiro corte (Power ou Quick) depois disso tem poder aumentado em 20% do Power do atacante.",
  "Observa√ß√£o de flores de cerejeira": "Aumenta o Percep√ß√£o de Kenma SP. Aumenta o Ataque R√°pido de Hinata SP quando a jogada for PERFECT.",
  "Sol vs Lua": "Quando um aliado faz um levantamento (Passe), a [Percep√ß√£o] dele aumenta em 10%.Dura at√© a bola atravessar a rede 2 vezes.Se o Ataque R√°pido do Shoyo Hinata (Hanami) virar um PERFECT, o tempo de recarga de „ÄàPulo Alto„Äâ √© reduzido em 2 contagens de atravessar a rede.Kei Tsuki (Festival de Fogos) recebe [Percep√ß√£o] igual a 50% da [Percep√ß√£o] do Hinata (Hanami), at√© +50%.Esse efeito dura at√© a bola atravessar a rede 4 vezes.",
  "Depois da Escola": "Aumenta o Reflexo de Nishinoya SP; quando a Stamina dele estiver baixa, aumenta ainda mais.",
  "Deus Guardi√£o e Ponta": "Quando Nishinoya SSR ou Azumane SSR usam habilidade, ambos aumentam T√©cnica de Ataque e T√©cnica de Defesa.",
  "Esquadr√£o de Kiyoko": "Ao pontuar, aumenta a Moral do Time.",
  "C√©rebro e Comandante": "Quando Kenma SSR faz o passe, Kuroo UR realiza um Ataque R√°pido fortalecido.",
  "Orienta√ß√£o Educacional": "Aumenta a Recep√ß√£o de Yaku SSR e o Ataque R√°pido de Lev SSR.",
  "Nata√ß√£o": "Aumenta a Moral do Time. Com Moral ativa, aumenta o Reflexo dos aliados em bloqueios duplos ou triplos.",
  "O Silencioso e o Sarc√°stico": "Permite que Aone SSR e Futakuchi SSR usem a habilidade [Bloqueio Duplo]*.",
  "O Novo Capit√£o e o Novato Alt√£o": "Aumenta o Bloqueio dos jogadores na linha de frente.",
  "Harmonia Perfeita": "Quando Oikawa UR faz o passe, Iwaizumi SSR realiza um corte com Ataque Potente aumentado. Ganha 2 ac√∫mulos de [Ritmo de Ataque]*, cada um aumentando o Percep√ß√£o da equipe em 1% (m√°x. 10).",
  "A Matilha": "Aumenta o Ataque Potente de Iwaizumi SSR e Kentaro SSR.",
  "Bests para a vida": "Aumenta o Ataque Potente de Ushijima UR e o T√©cnica de Defesa de Tendo SSR.",
  "Campe√£o Absoluto e Levantador S√≥lido": "Quando Shirabu SSR faz o passe, Ushijima UR realiza um corte com 10% mais poder.",
  "WS de Shiratorizawa": "Aumenta o Ataque Potente de TODOS os jogadores presentes.",
  "√Ås Milagroso e Levantador Carinhoso": "Bokuto UR sai da depress√£o. Quando Akaashi SSR faz o passe e Bokuto UR spika, aumenta o Ataque Potente desse golpe em 20% e eleva a Moral do Time em 15.",
  "Ace Milagroso e Levantador Carinhoso": "Aumenta o Passe de Akaashi SP. Com Moral ativa, aumenta o Ataque Potente de Bokuto SP em 18% e o Passe de Akaashi SP em 5%.",
  "A for√ßa dos G√™meos": "Quando Atsumu UR faz o passe e Osamu UR faz um Ataque R√°pido Minus Tempo, aumenta o Ataque R√°pido dessa jogada. Aumenta o T√©cnica de Ataque em 15%. O ataque n√£o pode ser bloqueado.",
  "Cabe√ßa dos G√™meos": "Aumenta o T√©cnica de Ataque de Osamu UR. Aumenta os Stats de Kita SSR. No in√≠cio da partida, Atsumu ganha 3 ac√∫mulos de Perfect Hit* (+2% de Passe cada, m√°x. 10). Kita SSR ganha b√¥nus similar em Recep√ß√£o (m√°x. 3). O primeiro Ataque R√°pido dos g√™meos em cada set recebe +[Ataque R√°pido] √ó 12%.",
  "Amigos de longa data": "Aumenta os Stats de Hoshiumi UR. Aumenta o Bloqueio para os jogadores da linha de frente. Hoshiumi UR e Hirugami UR recebem um buff (sem info).",
  "Top Spiker e Top Libero": "Sakusa UR aumenta seu Ataque Potente. Komori UR aumenta seu Recep√ß√£o. Aumenta a Recep√ß√£o dos aliados em 20%.",
  "C√©rebro e Comandante SP": "Quando Kenma SP e Kuroo SP est√£o em quadra, podem usar a habilidade de ataque r√°pido C√©rebro e Comandante*",
  "Festival Fogos de Artificio": "Atributos principais dos aliados aumentam em 6%.Ao fim de cada rali, aplica [Raiva] na linha de frente do oponente (os [Cortada Potente]/[Ataque R√°pido] deles ficam ‚Äì10%).Dura at√© a bola atravessar a rede 8 vezes.Se o alvo j√° tiver [Raiva], aplica [Distra√ß√£o] em vez disso (os [Cortada Potente]/[Ataque R√°pido] ficam ‚Äì20%).Tamb√©m dura at√© a bola atravessar a rede 8 vezes.[Distra√ß√£o] n√£o pode ser removido.",
  "Festival de Esporte":"Quando um aliado tocar na bola, consome 1 de [Stamina] e aumenta os atributos principais desse membro em 3%/3,5%/4%/4,5%/5% por 2 cruzamentos de rede.Se esse toque de bola for um [Bloqueio], o [Bloqueio] desse membro aumenta em +5% adicionais por 2 cruzamentos de rede.",
  "Aliados no Campo de Treinamento":"Aliados em quadra que possuam habilidade de [Bloqueio] recebem +6%/7%/8%/9%/10% [Bloqueio].O tempo de recarga de <Block System> √© reduzido em 2 cruzamentos de rede.Quando um aliado ativa uma habilidade de [Saque], aplica [Raiva] na linha de tr√°s do oponente ([Ataque Potente]/[Ataque R√°pido] ‚àí10%) por 8 cruzamentos de rede.",
  "Parede de Ferro" :"Quando Koganegawa estiver em quadra, se pelo menos 2 membros inclu√≠dos neste V√≠nculo estiverem presentes, a Habilidade de V√≠nculo √© ativada.Quando os aliados executarem um bloqueio duplo/triplo, os aliados da linha de frente recebem [T√©cnica de Defesa] +3%/4%/5%/6%/7% por 1 cruzamento de rede.Quando um aliado ativa uma habilidade de [Saque], o saque n√£o falhar√°.Durante ralis em que um aliado ativa uma habilidade de [Saque], se os aliados executarem bloqueio duplo/triplo, ganha 1 ac√∫mulo de [Poderoso Bloqueio] e [Criar Muralha de Ferro] (s√≥ ativa se o membro correspondente estiver em quadra).",
  "Rei e Grande Rei" : "Kageyama e Oikawa disputam pelo direito do Saque, o primeiro a ativar uma habilidade de Saque vence. Caso o Oikawa ven√ßa, Kageyama recebe o efeito 'Performance'. Esse efeito permanece por por 1 set. Caso o Kageyama ven√ßa, a cada vez que Oikawa tocar na bola, Kageyama recebe 1 ac√∫mulo do efeito 'Competitivo'. Quando Oikawa ativa uma habilidade, Kageyama recebe mais 1 ac√∫mulo do efeito 'Competitivo'.",
  "Respira√ß√£o em Harmonia":"Quando Iwaizumi corta a bola levantada por Oikawa, esse ataque ter√° a for√ßa de [Ataque Potente] do Iwaizumi x 360%. 2 - Iwaizumi recebe o efeito [Performance] (skill 1 Oikawa). Esse efeito permanece por 1 set.",
  "Rivais de Aoba Jousai":"Quando Ushijima SP e Oikawa SP est√£o em quadra, o [Passe] e o [Saque] de Oikawa aumentam.Quando Oikawa SP faz o levantamento e Ushijima SP realiza um ataque poderoso, ganha 1 ac√∫mulo do efeito [Ritmo de Ataque].",
  "Cultural Festival":"Quando h√° um membro em quadra com o buff de [Posse de Bola], Oikawa (Festival Cultural) e Ushijima (Festival Cultural) aumentam a recupera√ß√£o de stamina de todos os membros da equipe em 2%.Durante os ralis, quando a bola cruza a rede duas vezes, todos os membros em quadra recebem +4% em [For√ßa] e [Recep√ß√£o].Pode acumular at√© 4 vezes.",
  "Amigo de Vida Inteira":"Quando Ushijima SP recebe um efeito negativo, o [Bloqueio] e o [Ataque R√°pido] de Tendo SP aumentam em 4%.Pode aumentar at√© 12% no m√°ximo. Quando o bloqueio de Tendo SP resulta em uma Jogada Superior, o poder do Ataque Potente de Ushijima SP aumenta em [Ataque Potente] √ó 10%.Esse efeito dura por 1 rally.",
  "F√©rias de Inverno":"Se Atsumu SP e Osamu SP estiverem separados entre a linha de frente e a linha de tr√°s, a [For√ßa] de ambos aumenta em 30%. Ao final de cada rally, a [Percep√ß√£o] de Tendo SP ser√° reduzida para 0 e sua [T√©cnica de defesa] aumentar√° em 10%. Acumula at√© 3 stacks. Quando Tendo SP tocar na bola pela primeira vez em cada rally, ser√° sempre cr√≠tico. No in√≠cio de um rally, a [T√©cnica de ataque] e a [T√©cnica de defesa] de todos os membros do time aumentam em 2% √ó o n√∫mero de membros (Winter Break). √â poss√≠vel aumentar at√© 12%.",
  "G√™meos Mais Fortes do Ensino M√©dio":"No in√≠cio da partida, Osamu SP ganha 1 stack de [Engenhosidade]. Depois que Atsumu SP e Osamu SP fizerem 1 set cada, a [T√©cnica de ataque] e a [T√©cnica de defesa] dos aliados aumentam em 12,5%. Esse efeito dura por 1 rally.",
  "Esportes de Inverno":"Quando o tipo do seu time estiver em vantagem, todos os jogadores ganham 15% nos atributos principais.Membros de Esportes de Inverno recebem +20% adicionais.",
};
    
/** Cat√°logo de MEM√ìRIAS (exemplos; ajuste/expanda √† vontade) */
const memoryCatalog = [
  {
    id:"mem_op",
    name:"Mem√≥ria de OP",
    positions:["OP"],
    bonus:{
      Serve:{flat:518}, Spike:{flat:663}, Set:{flat:461},
      Receive:{flat:663}, Block:{flat:605}, Save:{flat:490}
    },
    desc:"Quando um membro com esta mem√≥ria joga pela primeira vez em cada set, sua [Recep√ß√£o] aumenta em 24%. Este efeito dura por 3 ralis.",
    img:"img/memories/MemoOP.png"
  },
  {
    id:"mem_l",
    name:"Mem√≥ria de L",
    positions:["L"],
    bonus:{
      Serve:{flat:490}, Spike:{flat:518}, Set:{flat:605},
      Receive:{flat:663}, Block:{flat:461}, Save:{flat:663}
    },
    desc:"Os Par√¢metros Principais do membro que equipa esta mem√≥ria aumentam em 6.4%. Se o resultado de recep√ß√£o do respectivo membro n√£o for BAD, o poder do pr√≥ximo Ataque Potente do aliado ser√° aumentado em 24% √ó [Ataque Potente] do membro que executar√° o Ataque Potente.",
    img:"img/memories/MemoL.png"
  },
  {
    id:"mem_ws",
    name:"Mem√≥ria de WS",
    positions:["WS"],
    bonus:{
      Serve:{flat:605}, Spike:{flat:663}, Set:{flat:461},
      Receive:{flat:663}, Block:{flat:518}, Save:{flat:490}
    },
    desc:"O membro que equipa esta mem√≥ria tem seu [Ataque Potente] aumentado em 12%. Quando o membro realiza um Ataque Potente, o [Bloqueio] do oponente √© reduzido em 6.4% at√© a bola cruzar a rede uma vez. Se o resultado do bloqueio do oponente nesta jogada for BAD, o membro oponente que bloqueou ter√° seu [Bloqueio] reduzido em 6.4%. Este efeito dura at√© a bola cruzar a rede duas vezes.",
    img:"img/memories/MemoWS.png"
  },
  {
    id:"mem_s",
    name:"Mem√≥ria de S",
    positions:["S"],
    bonus:{
      Serve:{flat:663}, Spike:{flat:518}, Set:{flat:663},
      Receive:{flat:490}, Block:{flat:605}, Save:{flat:461}
    },
    desc:"Enquanto houver um membro com esta mem√≥ria em quadra, o [Passe] dos aliados aumenta em 8%. Uma vez por set, quando a Stamina de um membro cair abaixo de 30, a Stamina desse membro ser√° restaurada em 24.",
    img:"img/memories/MemoS.png"
  },
  {
    id:"mem_mb",
    name:"Mem√≥ria de MB",
    positions:["MB"],
    bonus:{
      Serve:{flat:605}, Spike:{flat:663}, Set:{flat:461},
      Receive:{flat:518}, Block:{flat:663}, Save:{flat:490}
    },
    desc:"O [Ataque R√°pido] do membro que equipa esta mem√≥ria √© aumentado em 12%. Para cada membro de Bloqueio na linha de frente do oponente, o [Ataque R√°pido] desse membro aumenta em mais 6.4%.",
    img:"img/memories/MemoMB.png"
  },
  {
    id:"mem_up_consciencia_wakatoshi_ushijima",
    name:"Ushijima UR",
    positions:["OP"],
    bonus:{
      Serve:{flat:570}, Spike:{flat:729}, Set:{flat:507},
      Receive:{flat:729}, Block:{flat:665}, Save:{flat:539}
    },
    desc:"A [Percep√ß√£o] do membro que equipa esta mem√≥ria √© aumentada em 20%. Se a [Percep√ß√£o] do membro exceder 20%, para cada 1% adicional de [Percep√ß√£o], a [For√ßa] aumenta em 1% (at√© 100%).",
    img:"img/memories/MemoUshijimaUR.png"
  },
  {
    id:"mem_ofensive_up_osamu_miya",
    name:"Osamu UR",
    positions:["OP"],
    bonus:{
      Serve:{flat:570}, Spike:{flat:729}, Set:{flat:507},
      Receive:{flat:729}, Block:{flat:665}, Save:{flat:539}
    },
    desc:"O [Ataque R√°pido] do membro que equipa esta mem√≥ria √© aumentado em 24%. Se a [T√©cnica de Ataque] do membro exceder 40%, o [Ataque R√°pido] aumenta em 48% √ó [Ataque R√°pido].",
    img:"img/memories/MemoOsamuUR.png"
  },
  {
    id:"mem_receba_reforco_hard_hit_daichi_sawamura",
    name:"Daichi SSR",
    positions:["OP"],
    bonus:{
      Serve:{flat:518}, Spike:{flat:663}, Set:{flat:461},
      Receive:{flat:663}, Block:{flat:605}, Save:{flat:490}
    },
    desc:"A [Recep√ß√£o] do membro que equipa esta mem√≥ria √© aumentada em 20%. Se o membro estiver em quadra, ganhe 1 ac√∫mulo de [Determina√ß√£o] sempre que um aliado do tipo For√ßa consumir 20 de Stamina. Cada ac√∫mulo aumenta o poder do Ataque Potente em 4% do atributo [Ataque Potente], at√© 10 ac√∫mulos.",
    img:"img/memories/MemoDaichiSSR.png"
  },
  {
    id:"mem_reacao_para_cima_akinori_konoha",
    name:"Konoha SSR",
    positions:["OP"],
    bonus:{
      Serve:{flat:518}, Spike:{flat:663}, Set:{flat:461},
      Receive:{flat:663}, Block:{flat:605}, Save:{flat:490}
    },
    desc:"Os Par√¢metros Principais dos membros que equipam esta mem√≥ria aumentam em 12%. O [Reflexo] do membro eleva a Moral da Equipe dos aliados em 10%. Enquanto um aliado estiver com [Despertar de Moral da Equipe] ativo, o [Reflexo] desse membro aumenta em 8%.",
    img:"img/memories/MemoKonohaSSR.png"
  },
  {
    id:"mem_ofensive_up_kentaro_kyotani",
    name:"Kentaro MAD DOG SSR",
    positions:["OP"],
    bonus:{
      Serve:{flat:518}, Spike:{flat:663}, Set:{flat:461},
      Receive:{flat:663}, Block:{flat:605}, Save:{flat:490}
    },
    desc:"Se o membro com esta mem√≥ria estiver em quadra, a [For√ßa] do aliado que estiver atacando aumenta em 12%. Enquanto o membro estiver em quadra e a Stamina do oponente estiver abaixo de 60, o [Bloqueio] do oponente √© reduzido em 16%. Este efeito dura at√© a bola cruzar a rede 3 vezes e pode ser ativado uma vez por set por membro.",
    img:"img/memories/MemoKentaroSSR.png"
  },
  {
    id:"mem_param_main_e_hard_hit_takehito_sasaya",
    name:"Sasaya SSR",
    positions:["OP"],
    bonus:{
      Serve:{flat:518}, Spike:{flat:663}, Set:{flat:461},
      Receive:{flat:663}, Block:{flat:605}, Save:{flat:490}
    },
    desc:"O [Ataque Potente] e o [Bloqueio] dos membros que equipam esta mem√≥ria aumentam em 12%. Se o placar estiver favor√°vel ao oponente, o poder do seu Spike aumenta em 28% √ó [Ataque Potente].",
    img:"img/memories/MemoSasayaSSR.png"
  },
  {
    id:"mem_defense_up_yu_nishinoya_depois_da_escola",
    name:"Nishinoya SP",
    positions:["L"],
    bonus:{
      Serve:{flat:619}, Spike:{flat:656}, Set:{flat:765},
      Receive:{flat:838}, Block:{flat:583}, Save:{flat:838}
    },
    desc:"O membro que equipa esta mem√≥ria tem sua [Recep√ß√£o] aumentada em 24%. Quando a Habilidade Especial do respectivo membro √© ativada, o [Reflexo] aumenta em 1.2% e o [Empenho] aumenta em 2.4% (at√© 5 ac√∫mulos). Se o membro usar uma Habilidade Especial mais de duas vezes durante um rali, ele recupera 10 de Stamina e, na pr√≥xima Habilidade Especial que usar, sua [T√©cnica de Defesa] aumenta em 16%. Este efeito dura at√© a bola cruzar a rede duas vezes.",
    img:"img/memories/MemoNishinoyaSP.png"
  },
  {
    id:"mem_defense_offensive_up_motoya_komori",
    name:"Komori UR",
    positions:["L"],
    bonus:{
      Serve:{flat:619}, Spike:{flat:656}, Set:{flat:838},
      Receive:{flat:838}, Block:{flat:583}, Save:{flat:765}
    },
    desc:"O membro que equipa esta mem√≥ria tem sua [Recep√ß√£o] aumentada em 24%. Quando o respectivo membro recebe, a [T√©cnica de Defesa] dos aliados na retaguarda aumenta em 2% (at√© 3 ac√∫mulos). Se o membro estiver em quadra, quando um aliado ativar uma habilidade de Recep√ß√£o, quem receber recupera 2 de Stamina e tem seu [Ataque Potente/Ataque R√°pido] aumentado em 15%. Este efeito dura at√© a bola cruzar a rede duas vezes.",
    img:"img/memories/MemoKomoriUR.png"
  },
  {
    id:"mem_defense_up_yu_nishinoya",
    name:"Nishinoya SSR",
    positions:["L"],
    bonus:{
      Serve:{flat:490}, Spike:{flat:518}, Set:{flat:605},
      Receive:{flat:663}, Block:{flat:461}, Save:{flat:663}
    },
    desc:"Se o membro que equipa esta mem√≥ria estiver em quadra, aumenta a [Defesa] dos jogadores da linha de tr√°s do seu lado em 8%. Se o consumo de Stamina do equipador for 8 ou mais ao ativar a habilidade de recep√ß√£o, a [Recep√ß√£o] do equipador aumenta em 20% e ele recupera 2 de Stamina.",
    img:"img/memories/MemoNishinoyaSSR.png"
  },
  {
    id:"mem_receba_morisuke_yaku",
    name:"Yaku SSR",
    positions:["L"],
    bonus:{
      Serve:{flat:490}, Spike:{flat:518}, Set:{flat:605},
      Receive:{flat:663}, Block:{flat:461}, Save:{flat:663}
    },
    desc:"Quando um membro com esta mem√≥ria recebe, a [Recep√ß√£o] aumenta em 4% (at√© 5 ac√∫mulos). Se a recep√ß√£o do membro for PERFECT, o poder do pr√≥ximo Ataque R√°pido de um aliado aumenta em 32% √ó [Ataque R√°pido] do membro que executar√° o ataque r√°pido.",
    img:"img/memories/MemoYakuSSR.png"
  },
  {
    id:"mem_receba_haruki_komi",
    name:"Haruki SSR",
    positions:["L"],
    bonus:{
      Serve:{flat:490}, Spike:{flat:518}, Set:{flat:605},
      Receive:{flat:663}, Block:{flat:461}, Save:{flat:663}
    },
    desc:"A [Recep√ß√£o] e a [Defesa] dos membros que equipam esta mem√≥ria aumentam em 16%. Se a recep√ß√£o ou a defesa do membro n√£o for BAD, a Moral da Equipe aumenta em 10. Al√©m disso, o poder do pr√≥ximo Ataque Potente de um aliado aumenta em 10% √ó [Ataque Potente] do membro.",
    img:"img/memories/MemoHarukiSSR.png"
  },
  {
    id:"mem_receba_yamagata_hayato",
    name:"Memo Yamagata SSR",
    positions:["L"],
    bonus:{
      Serve:{flat:490}, Spike:{flat:518}, Set:{flat:605},
      Receive:{flat:663}, Block:{flat:461}, Save:{flat:663}
    },
    desc:"A [Recep√ß√£o] do membro que equipa esta mem√≥ria √© aumentada em 20%. Quando o membro ativa a Habilidade Especial de Recep√ß√£o, o [Reflexo] aumenta em 12%.",
    img:"img/memories/MemoYamagataSSR.png"
  },
  {
    id:"mem_defense_up_michinari_akagi",
    name:"Memo Akagi SSR",
    positions:["L"],
    bonus:{
      Serve:{flat:490}, Spike:{flat:518}, Set:{flat:605},
      Receive:{flat:663}, Block:{flat:461}, Save:{flat:663}
    },
    desc:"A [Recep√ß√£o] do membro que equipa esta mem√≥ria √© aumentada em 20%. Se o resultado de recep√ß√£o ou defesa do membro n√£o for BAD, a [T√©cnica de Defesa] do aliado aumenta em 16% (at√© 3 ac√∫mulos). Este efeito dura por 1 rali.",
    img:"img/memories/MemoAkagiSSR.png"
  },
  {
    id:"mem_power_up_shouyou_hinata_hanami",
    name:"Hinata SP",
    positions:["MB"],
    bonus:{ Serve:{flat:619}, Spike:{flat:838}, Set:{flat:656}, Receive:{flat:838}, Block:{flat:765}, Save:{flat:583} },
    desc:"A [For√ßa] do membro que equipa esta mem√≥ria aumenta em 24%. Se o Ataque R√°pido do membro for PERFECT, aumente a [For√ßa] do membro em 2% (at√© 5 ac√∫mulos). Se o Ataque R√°pido de um aliado for PERFECT e o bloqueador oponente n√£o tocar na bola, a [Reflexo] e o [Empenho] da linha de frente inimiga ser√£o reduzidos em 8% cada. Este efeito dura at√© a bola cruzar a rede 10 vezes.",
    img:"img/memories/MemoHinataSP.png"
  },
  {
    id:"mem_hast_attack_block_up_Tsuki_firefly_display_de_fogos_de_artificio",
    name:"Tsuki SP",
    positions:["MB"],
    bonus:{ Serve:{flat:619}, Spike:{flat:838}, Set:{flat:656}, Receive:{flat:765}, Block:{flat:838}, Save:{flat:583} },
    desc:"O [Ataque R√°pido] do membro que equipa esta mem√≥ria aumenta em 24%. Se o membro fizer um PERFECT, o [Bloqueio] aumenta em 9% (at√© 3 ac√∫mulos). Aplica aleatoriamente o efeito negativo [Supress√£o] a um membro do time advers√°rio em quadra (Par√¢metros Principais reduzidos em 5%). Este efeito dura at√© a bola cruzar a rede 8 vezes.",
    img:"img/memories/MemoTsukiSP.png"
  },
  {
    id:"mem_kurosp",
    name:"Kuroo SP",
    positions:["MB"],
    bonus:{ Serve:{flat:765}, Spike:{flat:656}, Set:{flat:619}, Receive:{flat:838}, Block:{flat:838}, Save:{flat:583} },
    desc:"O [Bloqueio] aumenta em 12%. Quando o membro bloquear ou receber, se houver um inimigo em quadra com efeito negativo, a [T√©cnica de Defesa] do respectivo membro aumenta em 20%. Este efeito dura at√© a bola cruzar a rede quatro vezes.",
    img:"img/memories/MemoKuroSP.png"
  },
  {
    id:"mem_tecnica_de_defesa_bloqueio_takashi_aone_banho_de_mar",
    name:"Aone SP",
    positions:["MB"],
    bonus:{ Serve:{flat:838}, Spike:{flat:765}, Set:{flat:656}, Receive:{flat:619}, Block:{flat:838}, Save:{flat:583} },
    desc:"A [T√©cnica de Defesa] do membro que equipa esta mem√≥ria aumenta em 12.8%. Quando este membro participa de um bloqueio de 2 ou 3 jogadores, o [Bloqueio] da linha de frente aliada aumenta em 12% at√© a bola cruzar a rede duas vezes. Quando o membro bloquear, se a jogada resultar em bloqueio de 2/3, o [Bloqueio] do membro aumenta em mais 15% at√© a bola cruzar a rede duas vezes.",
    img:"img/memories/MemoAoneSP.png"
  },
  {
    id:"mem_hast_attack_blockup_tetsuro_kuroo",
    name:"Kuroo UR",
    positions:["MB"],
    bonus:{ Serve:{flat:665}, Spike:{flat:729}, Set:{flat:507}, Receive:{flat:570}, Block:{flat:729}, Save:{flat:539} },
    desc:"O membro que equipa esta mem√≥ria tem seu [Bloqueio] aumentado em 24%. Cada vez que o membro receber um aumento de [Ataque R√°pido] proveniente de uma habilidade de aliado, ganha 1 ac√∫mulo de [Ajuste]. Cada ac√∫mulo de [Ajuste] aumenta o [Bloqueio] em 2.4% (m√°x. 10). Quando a Habilidade Especial de Bloqueio do membro for ativada, consuma 10 ac√∫mulos do efeito [Constri√ß√£o] e reduza a recarga da Habilidade Especial de Bloqueio do membro em 10 cruzadas de rede.",
    img:"img/memories/MemoKuroUR.png"
  },
  {
    id:"mem_block_up_hirugami_yukoro",
    name:"Hirugami UR",
    positions:["MB"],
    bonus:{ Serve:{flat:729}, Spike:{flat:665}, Set:{flat:507}, Receive:{flat:570}, Block:{flat:729}, Save:{flat:539} },
    desc:"O membro que equipa esta mem√≥ria tem seu [Bloqueio] aumentado em 20%. Quando um aliado pontua, o [Bloqueio] dele aumenta em 4.8% (at√© 3 ac√∫mulos). Se um aliado possuir o efeito [Bloqueio Forte], ao bloquear sua [T√©cnica de Defesa] aumenta em 2.4% at√© a bola cruzar a rede quatro vezes (at√© 3 ac√∫mulos).",
    img:"img/memories/MemoHirugamiUR.png"
  },
  {
    id:"mem_increase_consciousness_shoyo_hinata",
    name:"Hinata SSR",
    positions:["MB"],
    bonus:{ Serve:{flat:605}, Spike:{flat:663}, Set:{flat:461}, Receive:{flat:518}, Block:{flat:663}, Save:{flat:490} },
    desc:"A [Percep√ß√£o] dos membros que equipam esta mem√≥ria aumenta em 16%. Se a [Percep√ß√£o] do membro for 40% ou maior, a [Percep√ß√£o] aumenta em mais 16% e sofrer bloqueio √© reduzido em 8%.",
    img:"img/memories/MemoHinataSSR.png"
  },
  {
    id:"mem_block_up_Tsuki",
    name:"Tsuki SSR",
    positions:["MB"],
    bonus:{ Serve:{flat:605}, Spike:{flat:663}, Set:{flat:461}, Receive:{flat:518}, Block:{flat:663}, Save:{flat:490} },
    desc:"O [Bloqueio] do membro que equipa esta mem√≥ria aumenta em 20%. Quando o membro ativa a Habilidade Especial de Bloqueio, se o oponente que realizou o spike (Ataque Potente/R√°pido) tiver um efeito negativo, o poder deste bloqueio aumenta em 32% √ó [Bloqueio] do membro.",
    img:"img/memories/MemoTsukiSSR.png"
  },
  {
    id:"mem_offensive_up_tetsuro_kuroo_pratica",
    name:"Kuroo SSR",
    positions:["MB"],
    bonus:{ Serve:{flat:605}, Spike:{flat:663}, Set:{flat:461}, Receive:{flat:518}, Block:{flat:663}, Save:{flat:490} },
    desc:"A [Percep√ß√£o] dos membros que equipam esta mem√≥ria aumenta em 16%. Quando o membro for bloqueado, sua [T√©cnica de Defesa] aumenta em 24% da sua [For√ßa].",
    img:"img/memories/MemoKuroSSR.png"
  },
  {
    id:"mem_block_up_tatsuo",
    name:"Tatsuo SSR",
    positions:["MB"],
    bonus:{ Serve:{flat:605}, Spike:{flat:663}, Set:{flat:461}, Receive:{flat:518}, Block:{flat:663}, Save:{flat:490} },
    desc:"O [Bloqueio] do membro que equipa esta mem√≥ria aumenta em 24%. Quando o membro bloquear, se o spike do oponente (potente/r√°pido) for PERFECT, este bloqueio ser√° garantidamente PERFECT. Se o resultado deste bloqueio n√£o for BAD, o [Bloqueio] do membro aumenta em 5% (at√© 3 ac√∫mulos).",
    img:"img/memories/MemoTatsuoSSR.png"
  },
  {
    id:"mem_receive_up_ataque_rapido_reforco_haiba_lev",
    name:"Lev SSR",
    positions:["MB"],
    bonus:{ Serve:{flat:605}, Spike:{flat:663}, Set:{flat:461}, Receive:{flat:518}, Block:{flat:663}, Save:{flat:490} },
    desc:"Se o membro que equipa esta mem√≥ria estiver em quadra, a [Recep√ß√£o] dos defensores aliados aumenta em 12%. Se o membro estiver em quadra e o resultado da recep√ß√£o aliada for PERFECT, o poder da pr√≥xima Habilidade Especial de Ataque R√°pido do membro aumenta em 24% √ó [Ataque R√°pido].",
    img:"img/memories/MemoLevSSR.png"
  },
  {
    id:"mem_defense_up_takanobu_aone",
    name:"Aone SSR",
    positions:["MB"],
    bonus:{ Serve:{flat:605}, Spike:{flat:663}, Set:{flat:461}, Receive:{flat:518}, Block:{flat:663}, Save:{flat:490} },
    desc:"A [T√©cnica de Defesa] dos membros que equipam esta mem√≥ria aumenta em 16%. Se o resultado de bloqueio do membro n√£o for BAD, a Stamina do oponente √© reduzida em 2 ap√≥s o spike (potente/r√°pido). Se o atacante oponente for um membro de Ataque Potente, ele perde mais 1 de Stamina.",
    img:"img/memories/MemoAoneSSR.png"
  },
  {
    id:"mem_block_up_tendo_satoru",
    name:"Tendo SSR",
    positions:["MB"],
    bonus:{ Serve:{flat:605}, Spike:{flat:663}, Set:{flat:461}, Receive:{flat:518}, Block:{flat:663}, Save:{flat:490} },
    desc:"O [Bloqueio] do membro que equipa esta mem√≥ria aumenta em 28%. Se o bloqueio do membro for PERFECT, a recarga da Habilidade Especial de Bloqueio √© reduzida em 3 cruzadas de rede.",
    img:"img/memories/MemoTendoSSR.png"
  },
  {
    id:"mem_fast_attack_up_rintaro_suna",
    name:"Rintaro SSR",
    positions:["MB"],
    bonus:{ Serve:{flat:605}, Spike:{flat:663}, Set:{flat:461}, Receive:{flat:518}, Block:{flat:663}, Save:{flat:490} },
    desc:"O [Ataque R√°pido] do membro que equipa esta mem√≥ria aumenta em 20%. Se o bloqueador oponente tiver um efeito negativo quando o membro atacar rapidamente, o poder deste Ataque R√°pido aumenta em 40% √ó [Ataque R√°pido] do membro.",
    img:"img/memories/MemoRintaroSSR.png"
  },
  {
id:"mem_akaashi_sp",
name:"Akaashi SP",
positions:["S"],
bonus:{ Serve:{flat:838}, Spike:{flat:656}, Set:{flat:838}, Receive:{flat:619}, Block:{flat:765}, Save:{flat:583} },
desc:"O [Passe] do equipador aumenta em 24%. Enquanto o [Despertar de Moral da Equipe] de um aliado estiver ativo, a [Percep√ß√£o] do equipador aumenta em 10%. Aliados com o efeito [Condi√ß√£o Excelente] recebem +15% em seus Par√¢metros Principais. Quando um aliado perde o efeito [Condi√ß√£o Excelente], o [Reflexo] de todos os aliados aumenta em 10% at√© a bola cruzar a rede 8 vezes.",
img:"img/memories/MemoAkaashiSP.png"
},
  {
id:"mem_sugawara_sp",
name:"Sugawara SP",
positions:["S"],
bonus:{ Serve:{flat:838}, Spike:{flat:656}, Set:{flat:838}, Receive:{flat:619}, Block:{flat:765}, Save:{flat:583} },
desc:"Os Par√¢metros Principais do equipador aumentam em 16%. Quando o equipador realiza um Passe, para cada 6 de Stamina atual que possuir, o [Ataque Potente/Ataque R√°pido] do atacante aumenta em 2% (at√© 30%). Este efeito dura at√© a bola cruzar a rede duas vezes. Quando o equipador ativa uma Habilidade e consome Stamina, restaure 10 de Stamina ao aliado com a menor Stamina.",
img:"img/memories/MemoSugawaraSP.png"
},
  {
id:"mem_kenma_sp",
name:"Kenma SP",
positions:["S"],
bonus:{ Serve:{flat:765}, Spike:{flat:656}, Set:{flat:838}, Receive:{flat:838}, Block:{flat:619}, Save:{flat:583} },
desc:"O [Reflexo] aumenta em 16%. Quando um Ataque Potente/R√°pido do oponente for PERFECT, um aliado que ativar uma habilidade de Bloqueio ou Recep√ß√£o ganha 1 ac√∫mulo de [Ades√£o]; para cada ac√∫mulo, o [Reflexo] aumenta em 4% (m√°x. 3). Se tal aliado atingir 3 ac√∫mulos, consuma-os para aumentar em 100% o [Reflexo] desse aliado at√© a bola cruzar a rede uma vez.",
img:"img/memories/MemoKenmaSP.png"
},
  {
id:"mem_oikawa_ur",
name:"Oikawa UR",
positions:["S"],
bonus:{ Serve:{flat:729}, Spike:{flat:570}, Set:{flat:729}, Receive:{flat:539}, Block:{flat:665}, Save:{flat:507} },
desc:"O [Saque] aumenta em 24%. Quando o saque deste membro for [PERFECT], ganhe 2 ac√∫mulos de [Ritmo de Ataque]. Para cada ac√∫mulo, aliados em quadra recebem +1% de [Percep√ß√£o], at√© 10 ac√∫mulos. Se o saque resultar em ace, ganhe 4 ac√∫mulos adicionais. Enquanto este membro estiver em quadra, cada vez que o [Ritmo de Ataque] atingir 6 ac√∫mulos, a [For√ßa] e o [Empenho] dos aliados aumentam em 4% (at√© 3 ac√∫mulos).",
img:"img/memories/MemoOikawaUR.png"
},
  {
id:"mem_kageyama_ur",
name:"Kageyama UR",
positions:["S"],
bonus:{ Serve:{flat:729}, Spike:{flat:570}, Set:{flat:729}, Receive:{flat:539}, Block:{flat:665}, Save:{flat:507} },
desc:"O [Passe] aumenta em 24%. Quando este membro ativar uma habilidade de Ataque de Dois Toques, sua [For√ßa] aumenta em 40% da [Percep√ß√£o], at√© +100%. Al√©m disso, quando este membro ativar uma habilidade de Dois Toques, o poder do pr√≥ximo Spike aliado (Potente/R√°pido) aumenta em 28% do [Ataque Potente/Ataque R√°pido] do atacante.",
img:"img/memories/MemoKageyamaUR.png"
},
  {
id:"mem_atsumu_ur",
name:"Atsumu UR",
positions:["S"],
bonus:{ Serve:{flat:729}, Spike:{flat:570}, Set:{flat:729}, Receive:{flat:539}, Block:{flat:665}, Save:{flat:507} },
desc:"O [Passe] aumenta em 24%. Enquanto o equipador estiver em quadra, aliados em quadra cuja [Percep√ß√£o] e [Reflexo] estejam abaixo de 20% recebem +6.4% em [T√©cnica de Ataque] e [T√©cnica de Defesa]. Se a jogada de um aliado n√£o for [PERFECT], a [T√©cnica de Ataque] e a [T√©cnica de Defesa] do equipador aumentam em 2% por ac√∫mulo (m√°x. 5), durando por 1 rali.",
img:"img/memories/MemoAtsumuUR.png"
},
  {
id:"mem_kageyama_ssr_serve",
name:"Kageyama SSR",
positions:["S"],
bonus:{ Serve:{flat:663}, Spike:{flat:518}, Set:{flat:663}, Receive:{flat:490}, Block:{flat:605}, Save:{flat:461} },
desc:"O [Saque] aumenta em 20%. Quando este membro ativar um Supremo de Dois Toques, a [Percep√ß√£o] dos aliados aumenta em 20% e a [Percep√ß√£o] deste membro aumenta em mais 15%.",
img:"img/memories/MemoKageyamaSSR.png"
},
  {
id:"mem_kenma_ssr",
name:"Kenma SSR",
positions:["S"],
bonus:{ Serve:{flat:663}, Spike:{flat:518}, Set:{flat:663}, Receive:{flat:490}, Block:{flat:605}, Save:{flat:461} },
desc:"O [Passe] aumenta em 8%. Enquanto o equipador estiver em quadra, a [Recep√ß√£o] dos aliados da linha de tr√°s aumenta em 12%. Enquanto o equipador estiver em quadra, quando as pilhas de [Conex√£o] de um aliado diminu√≠rem, os aliados ganham 1 ac√∫mulo de [Conex√£o]; para cada ac√∫mulo, aliados em quadra recebem +1% de [Recep√ß√£o], at√© 6 ac√∫mulos.",
img:"img/memories/MemoKenmaSSR.png"
},
  {
id:"mem_akaashi_ssr",
name:"Akaashi SSR",
positions:["S"],
bonus:{ Serve:{flat:663}, Spike:{flat:518}, Set:{flat:663}, Receive:{flat:490}, Block:{flat:605}, Save:{flat:461} },
desc:"O [Passe] aumenta em 12%. Enquanto o [Despertar de Moral da Equipe] de um aliado estiver ativo, quando este membro realizar um Passe, o aliado que for atacar (Potente/R√°pido) recupera 4 de Stamina e esse Spike recebe +16% de [T√©cnica de Ataque]. Quando este membro dissipar um debuff de um aliado, tamb√©m remove o efeito [Modo de Baixa] desse aliado.",
img:"img/memories/MemoAkaashiSSR.png"
},
  {
id:"mem_oikawa_ssr",
name:"Oikawa SSR",
positions:["S"],
bonus:{ Serve:{flat:663}, Spike:{flat:518}, Set:{flat:663}, Receive:{flat:490}, Block:{flat:605}, Save:{flat:461} },
desc:"O [Passe] aumenta em 20%. Na primeira vez em cada set que o [Ritmo de Ataque] dos aliados atingir 10 ou mais ac√∫mulos, o [Passe] deste membro aumenta em mais 20% (dura 1 set). Para cada ac√∫mulo de [Ritmo de Ataque], aliados em quadra recebem +1% de [Percep√ß√£o], at√© 10 ac√∫mulos.",
img:"img/memories/MemoOikawaSSR.png"
},
  {
id:"mem_koganegawa_ssr",
name:"Koganegawa SSR",
positions:["S"],
bonus:{ Serve:{flat:663}, Spike:{flat:518}, Set:{flat:663}, Receive:{flat:490}, Block:{flat:605}, Save:{flat:461} },
desc:"O [Passe] aumenta em 16%. Enquanto o equipador estiver em quadra, se o resultado de Bloqueio de um aliado n√£o for [BAD], o poder do pr√≥ximo Ataque Potente do oponente diminui em 20% do atributo [Ataque Potente] do atacante. Enquanto o equipador estiver em quadra, se o resultado de Bloqueio de um aliado for [BAD], o poder do pr√≥ximo Bloqueio aliado aumenta em 32% do [Bloqueio] do bloqueador.",
img:"img/memories/MemoKoganegawaSSR.png"
},
  {
id:"mem_shirabu_ssr",
name:"Shirabu SSR",
positions:["S"],
bonus:{ Serve:{flat:663}, Spike:{flat:518}, Set:{flat:663}, Receive:{flat:490}, Block:{flat:605}, Save:{flat:461} },
desc:"O [Passe] aumenta em 16%. Quando o Passe deste membro for [PERFECT], o aliado que executar um Ataque Potente recebe +32% de [For√ßa] at√© a bola cruzar a rede uma vez.",
img:"img/memories/MemoShirabuSSR.png"
},
  {
id:"mem_semi_ssr",
name:"Semi SSR",
positions:["S"],
bonus:{ Serve:{flat:663}, Spike:{flat:518}, Set:{flat:663}, Receive:{flat:490}, Block:{flat:605}, Save:{flat:461} },
desc:"Quando este membro sacar, a [Percep√ß√£o] aumenta em 16%. Ao ativar um Supremo de Saque, o [Saque] aumenta em 6.4%, at√© 3 ac√∫mulos.",
img:"img/memories/MemoSemiSSR.png"
},
    {
    id:"mem_bokuto_sp",
    name:"Bokuto SP",
    positions:["WS"],
    bonus:{ Serve:{flat:765}, Spike:{flat:838}, Set:{flat:583}, Receive:{flat:838}, Block:{flat:656}, Save:{flat:619} },
    desc:"A [For√ßa] do membro que equipa esta mem√≥ria aumenta em 24%. Quando o membro atacar com for√ßa, a [T√©cnica de Ataque] aumenta em 5%. Se a dura√ß√£o restante do [Despertar de Moral da Equipe] de um aliado for de 6 ou mais cruzadas de rede, a [T√©cnica de Ataque] aumenta em mais 20%.",
    img:"img/memories/MemoBokutoSP.png"
},
  {
    id:"mem_offense_defense_up_hoshiumi_ur",
    name:"Hoshiumi UR",
    positions:["WS"],
    bonus:{ Serve:{flat:665}, Spike:{flat:729}, Set:{flat:507}, Receive:{flat:729}, Block:{flat:570}, Save:{flat:539} },
    desc:"A [T√©cnica de Ataque] e a [T√©cnica de Defesa] aumentam em 6.4%. Quando a Habilidade/Habilidade Especial do membro √© ativada, seus [Par√¢metros Principais] aumentam em 2% (m√°x. 10 ac√∫mulos). Se a jogada for [PERFECT], ganhe 1 ac√∫mulo adicional.",
    img:"img/memories/MemoHoshiumiUR.png"
},
  {
    id:"mem_bokuto_ur",
    name:"Bokuto UR",
    positions:["WS"],
    bonus:{ Serve:{flat:665}, Spike:{flat:729}, Set:{flat:507}, Receive:{flat:729}, Block:{flat:570}, Save:{flat:539} },
    desc:"O membro que equipa esta mem√≥ria tem seu [Ataque Potente] aumentado em 24%. Cada vez que um aliado ativar o [Despertar de Moral da Equipe], o [Ataque Potente] desse membro aumenta em 8% (at√© 3 ac√∫mulos). Enquanto o membro estiver em quadra, a dura√ß√£o do b√¥nus de Moral da Equipe dos aliados √© aumentada em 2 cruzadas de rede.",
    img:"img/memories/MemoBokutoUR.png"
    },
  {
    id:"mem_Sakusa_ur",
    name:"Sakusa UR",
    positions:["WS"],
    bonus:{ Serve:{flat:765}, Spike:{flat:838}, Set:{flat:583}, Receive:{flat:838}, Block:{flat:656}, Save:{flat:619} },
    desc:"O membro que equipa esta mem√≥ria tem seu [Ataque Potente] aumentado em 24%. Quando o membro receber, a [T√©cnica de Ataque] aumenta em 15% at√© a bola cruzar a rede duas vezes. Ap√≥s receber, o [Empenho] do membro aumenta em 8% (at√© 4 ac√∫mulos).",
    img:"img/memories/MemoSakusaUR.png"
    },
   {
    id:"mem_yui_ssr",
    name:"Yui SSR",
    positions:["WS"],
    bonus:{ Serve:{flat:605}, Spike:{flat:663}, Set:{flat:461}, Receive:{flat:663}, Block:{flat:518}, Save:{flat:490} },
    desc:"A [Recep√ß√£o] aumenta em 20%. Quando este membro receber, o [Ataque Potente] aumenta em 16% e dura at√© a bola cruzar a rede seis vezes. Se a recep√ß√£o deste membro for [PERFECT], seu pr√≥ximo Ataque Potente ser√° garantidamente [PERFECT].",
    img:"img/memories/MemoYuiSSR.png"
    },
   {
    id:"mem_oshiro_ssr",
    name:"Oshiro SSR",
    positions:["WS"],
    bonus:{ Serve:{flat:605}, Spike:{flat:663}, Set:{flat:461}, Receive:{flat:663}, Block:{flat:518}, Save:{flat:490} },
    desc:"O [Ataque Potente] aumenta em 20%. Para cada 6 de Stamina recuperada por este membro, o [Ataque Potente] aumenta em 6.3%. Este efeito dura at√© a bola cruzar a rede cinco vezes. Se a Stamina recuperada em uma √∫nica inst√¢ncia exceder 10, a [T√©cnica de Ataque] aumenta em 6.4% at√© a bola cruzar a rede cinco vezes.",
    img:"img/memories/MemoOshiroSSR.png"
},
    {
    id:"mem_kita_ssr",
    name:"Kita SSR",
    positions:["WS"],
    bonus:{ Serve:{flat:605}, Spike:{flat:663}, Set:{flat:461}, Receive:{flat:663}, Block:{flat:518}, Save:{flat:490} },
    desc:"A [Recep√ß√£o] aumenta em 20%. Se a recep√ß√£o deste membro n√£o for [PERFECT], o poder da pr√≥xima recep√ß√£o de um aliado aumenta em 40% da [Recep√ß√£o] do membro que receber.",
    img:"img/memories/MemoKitaSSR.png"
},
    {
    id:"mem_tanaka_ssr",
    name:"Tanaka SSR",
    positions:["WS"],
    bonus:{ Serve:{flat:605}, Spike:{flat:663}, Set:{flat:461}, Receive:{flat:663}, Block:{flat:518}, Save:{flat:490} },
    desc:"O [Ataque Potente] aumenta em 20%. Para este membro, at√© o segundo Ataque Potente de cada set, o poder de finaliza√ß√£o aumenta em 36% do [Ataque Potente].",
    img:"img/memories/MemoTanakaSSR.png"
},
    {
id:"mem_azumane_ssr",
name:"Azumane SSR",
positions:["WS"],
bonus:{ Serve:{flat:605}, Spike:{flat:663}, Set:{flat:461}, Receive:{flat:663}, Block:{flat:518}, Save:{flat:490} },
desc:"Se o membro que equipa esta mem√≥ria tiver 50 ou mais de Stamina, o [Ataque Potente] aumenta em 36%. Quando este membro ativar uma habilidade de Ataque Potente e a Stamina consumida for 20 ou mais, o poder desse Ataque Potente aumenta em 32% do [Ataque Potente].",
img:"img/memories/MemoAzumaneSSR.png"
},
    {
id:"mem_iwaizumi_ssr",
name:"Iwaizumi SSR",
positions:["WS"],
bonus:{ Serve:{flat:605}, Spike:{flat:663}, Set:{flat:461}, Receive:{flat:663}, Block:{flat:518}, Save:{flat:490} },
desc:"Exclusivo de [WS]: aumenta a [Recep√ß√£o] em 10%. Quando o equipador executar um Supremo de Ataque Potente Cr√≠tico, aumenta o [Ataque Potente] em 8% da [Recep√ß√£o] por 3 cruzadas de rede.",
img:"img/memories/MemoIwaizumiSSR.png"
},
    {
id:"mem_futakuchi_ssr",
name:"Futakuchi SSR",
positions:["WS"],
bonus:{ Serve:{flat:605}, Spike:{flat:663}, Set:{flat:461}, Receive:{flat:663}, Block:{flat:518}, Save:{flat:490} },
desc:"O [Bloqueio] aumenta em 20%. Para cada aliado do tipo Bloqueio em quadra, o poder de finaliza√ß√£o da Habilidade Especial deste membro aumenta em 6.4% do par√¢metro correspondente a essa Especial.",
img:"img/memories/MemoFutakuchiSSR.png"
},
    {
id:"mem_goshiki_ssr",
name:"Goshiki SSR",
positions:["WS"],
bonus:{ Serve:{flat:605}, Spike:{flat:663}, Set:{flat:461}, Receive:{flat:663}, Block:{flat:518}, Save:{flat:490} },
desc:"O [Ataque Potente] aumenta em 20%. Enquanto o [Despertar de Moral da Equipe] de um aliado estiver ativo, o [Ataque Potente] deste membro aumenta em 32%.",
img:"img/memories/MemoGoshikiSSR.png"
},
    {
id:"mem_awareness_reaction_up_oshiro_ssr",
name:"Oshiro SSR",
positions:["WS"],
bonus:{ Serve:{flat:605}, Spike:{flat:663}, Set:{flat:461}, Receive:{flat:663}, Block:{flat:518}, Save:{flat:490} },
desc:"Quando este membro ativar uma Habilidade, a [Percep√ß√£o] aumenta em 3.2% e o [Reflexo] aumenta em 3.2%, at√© 5 ac√∫mulos.",
img:"img/memories/MemoOshiroSSR.png"
},
    {
id:"mem_terushima_ssr",
name:"Terushima SSR",
positions:["WS"],
bonus:{ Serve:{flat:605}, Spike:{flat:663}, Set:{flat:461}, Receive:{flat:663}, Block:{flat:518}, Save:{flat:490} },
desc:"O [Ataque Potente] aumenta em 24%. Quando este membro ativar o efeito [Escolha Mais], ganhe 2 ac√∫mulos de [Escolha Mais] e aumente a [Recep√ß√£o] dos aliados da linha de tr√°s em 12% por 1 rali. Para cada ac√∫mulo de [Escolha Mais], o [Ataque Potente]/[Ataque R√°pido] aumenta em 2.5%, at√© 4 ac√∫mulos.",
img:"img/memories/MemoTerushimaSSR.png"
},
{
    id:"mem_kunimi",
    name:"Kunimi SP",
    positions:["OP"],
    bonus:{
      Serve:{flat:765}, Spike:{flat:838}, Set:{flat:583},
      Receive:{flat:838}, Block:{flat:656}, Save:{flat:619}
    },
    desc:"Enquanto esta mem√≥ria estiver equipada, o [Ataque Potente] do membro aumenta em 24%.Se a Stamina desse membro estiver abaixo de 80, sua [T√©cnica de Ataque] aumenta em 12%.Sempre que a Stamina desse membro for recuperada, o [Poder] dele aumenta em 6% (m√°x. 5 ac√∫mulos).",
    img:"img/memories/MemoKunimiSP.png"
  },
{
    id:"mem_koganegawa",
    name:"Koganegawa SP",
    positions:["S"],
    bonus:{
      Serve:{flat:765}, Spike:{flat:656}, Set:{flat:838},
      Receive:{flat:619}, Block:{flat:838}, Save:{flat:583}
    },
    desc:"O [Bloqueio] do membro que equipa esta mem√≥ria +24%.Quando esse membro participar de bloqueio duplo ou triplo, o [Levantamento] dele +3% (m√°x. 5 ac√∫mulos).Enquanto esse membro estiver em quadra, quando um aliado sacar, os aliados da linha de frente recebem [T√©cnica de Defesa] +16% por 1 rali.",
    img:"img/memories/MemoKoganegawaSP.png"
  },
{
    id:"mem_oikawaSP",
    name:"Oikawa SP",
    positions:["S"],
    bonus:{
      Serve:{flat:838}, Spike:{flat:656}, Set:{flat:838},
      Receive:{flat:619}, Block:{flat:765}, Save:{flat:583}
    },
    desc:"Aumenta [Passe] do equipador em 24%;Ao iniciar o rally, se o aliado possuir mais de 2 ac√∫mulos do efeito 'Tempo do Ataque' , os atributos de Ataque (Ataque R√°pido/Potente, Passe, Saque, Percep√ß√£o, For√ßa e T√©cnica de Ataque) do equipador aumentam em 10%. Esse efeito permanece por 1 rally.",
    img:"img/memories/MemoOikawaSP.png"
  },
{
    id:"mem_iwaizumiSP",
    name:"Iwaizumi SP",
    positions:["WS"],
    bonus:{
      Serve:{flat:838}, Spike:{flat:656}, Set:{flat:838},
      Receive:{flat:619}, Block:{flat:765}, Save:{flat:583}
    },
    desc:"Aumenta a [Recep√ß√£o] do membro equipado com esta mem√≥ria em 24%.O poder da habilidade especial de Recep√ß√£o do membro aumenta em [Recep√ß√£o] √ó 70%.Quando a habilidade especial de Recep√ß√£o √© ativada, o [Power Attack] aumenta em 5% (m√°ximo de ac√∫mulos).Este efeito persiste at√© o pr√≥ximo Spike (Power Attack ou Quick Attack) do membro.",
    img:"img/memories/MemoIwaizumiSP.png"
  },
{
    id:"mem_ushijimaSP",
    name:"Ushijima SP",
    positions:["OP"],
    bonus:{
      Serve:{flat:838}, Spike:{flat:838}, Set:{flat:656},
      Receive:{flat:583}, Block:{flat:765}, Save:{flat:619}
    },
    desc:"Quando esta mem√≥ria est√° equipada, a [For√ßa] do membro aumenta em 12% e a [Percep√ß√£o] aumenta em 50%.Quando esse membro realiza um ataque (Ataque Potente ou Ataque R√°pido), a [Percep√ß√£o] diminui em 10% e a [For√ßa] aumenta em 10%.Pode acumular at√© 3 vezes.",
    img:"img/memories/MemoUshijimaSP.png"
  },
{
    id:"mem_tendoSP",
    name:"Tendo SP",
    positions:["MB"],
    bonus:{
      Serve:{flat:765}, Spike:{flat:838}, Set:{flat:583},
      Receive:{flat:656}, Block:{flat:838}, Save:{flat:619}
    },
    desc:"O membro que tiver essa mem√≥ria equipada ter√° sua [Percep√ß√£o] aumentado em 20%. Quando esse membro ativar sua Ultimate, seus [Ataque Rapido] e [Bloqueio] aumentar√£o em 4/8%, e sua [T√©cnica de Defesa] tamb√©m aumentar√° em 4/8%.M√°ximo de 2 stacks.Esse efeito dura at√© a bola cruzar a rede 6 vezes.",
    img:"img/memories/MemoTendoSP.png"
  },
{
    id:"mem_ginjimaSP",
    name:"Ginjima SP",
    positions:["WS"],
    bonus:{
      Serve:{flat:765}, Spike:{flat:838}, Set:{flat:583},
      Receive:{flat:838}, Block:{flat:656}, Save:{flat:619}
    },
    desc:"O membro que tiver essa mem√≥ria equipada ter√° sua [For√ßa] aumentado em 12/24%.Para as primeiras tr√™s investidas (R√°pido ou Potente) de cada set desse membro, sua [For√ßa] e [Ataque R√°pido] aumentam em 15%.Quando esse membro acerta um corte (R√°pido ou Potente), os par√¢metros principais de todos os aliados aumentam em 2%, acumulando at√© 6 stacks.",
    img:"img/memories/MemoGinjimaSP.png"
  },
{
    id:"mem_atsumuSP",
    name:"Atsumu SP",
    positions:["S"],
    bonus:{
      Serve:{flat:765}, Spike:{flat:838}, Set:{flat:583},
      Receive:{flat:838}, Block:{flat:656}, Save:{flat:619}
    },
    desc:"O membro que estiver com esta Mem√≥ria equipada recebe [Passe] +24%. No in√≠cio de um rally, aliados com [Percep√ß√£o] de 50% ou menos recebem Par√¢metros Principais +7%, e aliados com [Percep√ß√£o] de 30% ou menos recebem adicionalmente [Potente]/[R√°pido] +10%.",
    img:"img/memories/MemoAtsumuSP.png"
  },
{
    id:"mem_osamuSP",
    name:"Osamu SP",
    positions:["OP"],
    bonus:{
      Serve:{flat:656}, Spike:{flat:838}, Set:{flat:838},
      Receive:{flat:583}, Block:{flat:765}, Save:{flat:619}
    },
    desc:"O membro que equipa esta Mem√≥ria recebe [Ataque R√°pido] +12%.Quando um aliado realiza um Passe, a [For√ßa] desse membro aumenta em 2%, at√© o m√°ximo de 15 stacks.Quando esse membro realiza um Passe, ele ganha mais 2 stacks adicionais.",
    img:"img/memories/MemoOsamuSP.png"
  },
    {
    id:"mem_koraiSP",
    name:"Korai SP",
    positions:["WS"],
    bonus:{
      Serve:{flat:765}, Spike:{flat:838}, Set:{flat:583},
      Receive:{flat:838}, Block:{flat:656}, Save:{flat:619}
    },
    desc:"O membro que estiver com esta mem√≥ria equipada tem seus Atributos Principais aumentados em 6/12 %.Quando esse membro ativa uma skill, se o tipo de jogada da skill for diferente da √∫ltima skill ativada, esse membro recebe +2% de [T√©cnica de Ataque] e +2% de [T√©cnica de Defesa].Acumula at√© 10 stacks.",
    img:"img/memories/MemoKoraiSP.png"
  },
     {
    id:"mem_hirugamiSP",
    name:"Hirugami SP",
    positions:["MB"],
    bonus:{
      Serve:{flat:838}, Spike:{flat:765}, Set:{flat:656},
      Receive:{flat:619}, Block:{flat:838}, Save:{flat:583}
    },
    desc:"O membro que estiver com esta mem√≥ria equipada tem seu [Bloqueio] aumentado em 12/24 %.Se houver 4 ou mais aliados do tipo Bloqueio, todos os aliados recebem +10% de [Bloqueio] e +10% de [Ataque R√°pido].Este efeito dura por 1 rally.",
    img:"img/memories/MemoHirugamiSP.png"
  },
];

/** Cat√°logo de SETS (POTENTIAL)  * */
const setCatalog = [
  {
  id:"set_rapid_quick_attack",
  name:"Rapid Quick Attack",
  twoPiece:{ Spike:{ pct:15 } },
  fourPiece:{Spike:{ pct:15 }}, // condicional
  img:"img/sets/rapid_quick_attack.png",
  desc2:"2p: Aumenta o atributo de Ataque R√°pido em 15%.",
  desc4:"2p: Aumenta o atributo de Ataque R√°pido em 15%. 4p: Cada vez que um Ataque R√°pido for usado, aumenta o atributo de Ataque R√°pido em 5%, at√© 5 ac√∫mulos."
},
{
  id:"set_sharp_sense",
  name:"Sharp Sense",
  twoPiece:{ Spike:{ pct:15 } },
  fourPiece:{Spike:{ pct:15 }}, // condicional
  img:"img/sets/sharp_sense.png",
  desc2:"2p: Aumenta o atributo de Ataque R√°pido em 15%.",
  desc4:"2p: Aumenta o atributo de Ataque R√°pido em 15%. 4p: Aumenta a Percep√ß√£o em 15%; quando um Ataque R√°pido for Cr√≠tico, aumenta a For√ßa em 10%."
},
{
  id:"set_power_vibe",
  name:"Power Vibe",
  twoPiece:{ Spike:{ pct:15 } },
  fourPiece:{Spike:{ pct:15 }}, // condicional
  img:"img/sets/power_vibe.png",
  desc2:"2p: Aumenta o atributo de Ataque Potente em 15%.",
  desc4:"2p: Aumenta o atributo de Ataque Potente em 15%. 4p: Aumenta a Percep√ß√£o em 15%; quando um Ataque Potente for Cr√≠tico, aumenta a For√ßa em 10%."
},
{
  id:"set_power_rise",
  name:"Power Rise",
  twoPiece:{ Spike:{ pct:15 } },
  fourPiece:{Spike:{ pct:15 }}, // condicional
  img:"img/sets/power_rise.png",
  desc2:"2p: Aumenta o atributo de Ataque Potente em 15%.",
  desc4:"2p: Aumenta o atributo de Ataque Potente em 15%. 4p: Aumenta a T√©cnica de Ataque em 10% ao usar Ataque Potente; ao pontuar com Ataque Potente, recupera 5 de Stamina."
},
{
  id:"set_precise_serve",
  name:"Precise Serve",
  twoPiece:{ Set:{ pct:15 } },
  fourPiece:{Set:{ pct:15 }}, // condicional
  img:"img/sets/precise_serve.png",
  desc2:"2p: Aumenta o atributo de Passe em 15%.",
  desc4:"2p: Aumenta o atributo de Passe em 15%. 4p: Os saques nunca falham e a T√©cnica de Ataque aumenta em 15% ao sacar."
},
{
  id:"set_precise_set",
  name:"Precise Set",
  twoPiece:{ Set:{ pct:15 } },
  fourPiece:{Set:{ pct:15 } }, // condicional
  img:"img/sets/precise_set.png",
  desc2:"2p: Aumenta o atributo de Passe em 15%.",
  desc4:"2p: Aumenta o atributo de Passe em 15%. 4p: Aumenta o poder do passe em 15% do atributo de Passe." 
},
{
  id:"set_precise_block",
  name:"Precise Block",
  twoPiece:{ Block:{ pct:15 } },
  fourPiece:{Block:{ pct:15 }}, // efeito condicional descrito abaixo
  img:"img/sets/precise_block.png",
  desc2:"2p: Aumenta o atributo de Bloqueio em 15%.",
  desc4:"2p: Aumenta o atributo de Bloqueio em 15%. 4p: Ao bloquear um Ataque Potente, aumenta o poder deste bloqueio em 20% do atributo de Bloqueio."
},
{
  id:"set_block_movement",
  name:"Block Movement",
  twoPiece:{ Block:{ pct:15 } },
  fourPiece:{Block:{ pct:15 }}, // efeito condicional descrito abaixo
  img:"img/sets/block_movement.png",
  desc2:"2p: Aumenta o atributo de Bloqueio em 15%.",
  desc4:"2p: Aumenta o atributo de Bloqueio em 15%. 4p: Ao bloquear um ataque com outros jogadores do tipo Bloqueio presentes na linha de frente, aumenta o poder deste bloqueio em 20% do atributo de Bloqueio."
},
 {
    id:"set_assist_receive",
    name:"Assist Receive",
    twoPiece:{ Receive:{ pct:15 } },
    fourPiece:{Receive:{ pct:15 }}, // efeito condicional descrito abaixo
    img:"img/sets/assist_receive.png",
    desc2:"2p: Aumenta o atributo de Recep√ß√£o em 15%.",
    desc4:"2p: Aumenta o atributo de Recep√ß√£o em 15%. 4p: Ao obter uma recep√ß√£o PERFECT, aumenta o poder do pr√≥ximo Spike do seu lado em 30% do atributo de Ataque Potente/Ataque R√°pido do atacante."
  },
  {
    id:"set_supreme_receive",
    name:"Supreme Receive",
    twoPiece:{ Receive:{ pct:15 } },
    fourPiece:{Receive:{ pct:15 }}, // efeito condicional descrito abaixo
    img:"img/sets/supreme_receive.png",
    desc2:"2p: Aumenta o atributo de Recep√ß√£o em 15%.",
    desc4:"2p: Aumenta o atributo de Recep√ß√£o em 15%. 4p: Ao receber um Ataque R√°pido, aumenta o poder desta recep√ß√£o em 30% do atributo de Recep√ß√£o."
  }
];
window.STATS_BONDS = {
  "Aoba Johsai's Sophomore": { "Watari SR": "Receive +5/7/9/12/15, Receive +1/2/3/4/5%", "Yahaba SR": "Receive +5/7/9/12/15, Receive +1/2/3/4/5%", "Kentaro SSR": "No buff" },
  "Behind the Smile": { "Daichi SSR": "Receive +5/7/9/12/15, Receive +1/2/3/4/5%", "Kuro UR": "Receive +5/7/9/12/15, Receive +1/2/3/4/5%" },
  "Bench cheer": { "Hisashi R": "Serve +5/7/9/12/15, Serve +1/2/3/4/5%", "Kazuhito R": "Block +5/7/9/12/15, Block +1/2/3/4/5%" },
  "Building Team Chemistry": { "Kageyama SSR": "Serve +5/7/9/12/15, Serve +1/2/3/4/5%", "Tanaka SR": "Receive +5/7/9/12/15, Receive +1/2/3/4/5%" },
  "Cannon \\& Iron Wall": { "Azumane SSR": "Power Attack +5/7/9/12/15, Power Attack +1/2/3/4/5%", "Aone SSR": "No buff" },
  "Cannon and Iron Wall": { "Aone SP": "Serve +5/7/9/12/15, Serve +1/2/3/4/5%", "Azumane SSR": "" },
  "Classmates": { "Suna SSR": "Quick Attack +5/7/9/12/15, Quick Attack +1/2/3/4/5%", "Osamu UR": "Block +5/7/9/12/15, Block +1/2/3/4/5%" },
  "Date Kogyo's Captains": { "Kaname SR": "No buff", "Kenji SSR": "Power Attack +5/7/9/12/15, Power Attack +1/2/3/4/5%" },
  "Date Kogyo's Junior": { "Jingo R": "Receive +5/7/9/12/15, Receive +1/2/3/4/5%", "Sakunami R": "Quick Attack +5/7/9/12/15, Quick Attack stat by 6/7/8/9/10%" },
  "Date Kogyo's Setter": { "Kaname SR": "No buff", "Kaji SSR": "Set +5/7/9/12/15, Set +1/2/3/4/5%" },
  "Fated Rivals": { "Oikawa UR": "Toss +5/7/9/12/15, Toss +1/2/3/4/5%", "Ushijima UR": "" },
  "Flexible Aces": { "Hinata SSR": "Block +5/7/9/12/15, Block +1/2/3/4/5%", "Lev SSR": "Quick Attack +5/7/9/12/15, Quick Attack +1/2/3/4/5%" },
  "Formidable Opponent": { "Nishinoya SR": "Save +5/7/9/12/15, Save +1/2/3/4/5%", "Yaku SR": "Set +5/7/9/12/15, Set +1/2/3/4/5%" },
  "Friends from Volleyball Class": { "Atsumu UR": "Serve +5/7/9/12/15, Serve +1/2/3/4/5%", "Osamu UR": "Quick Attack +5/7/9/12/15, Quick Attack +1/2/3/4/5%", "Oshiro SSR": "Power Attack +5/7/9/12/15, Power Attack +1/2/3/4/5%" },
  "Fukurodani 3rd Years": { "Bokuto UR": "", "Komi SR": "Receive +5/7/9/12/15, Receive +1/2/3/4/5%", "Konoha": "Receive +5/7/9/12/15, Receive +1/2/3/4/5%", "Sarukui SSR": "Power +5/7/9/12/15, Power +1/2/3/4/5%", "Washio SSR": "Block +5/7/9/12/15, Block +1/2/3/4/5%" },
  "Fukurodani MBs": { "Washio SSR": "Quick Attack +5/7/9/12/15, Quick Attack +1/2/3/4/5%", "Onaga R": "" },
  "Fukurodani WS": { "Bokuto UR": "", "Sarukui": "Serve +5/7/9/12/15, Serve +1/2/3/4/5%" },
  "Grit and Competitive": { "Yamamoto SR": "No buff", "Kenma SSR": "Set +5/7/9/12/15, Set +1/2/3/4/5%" },
  "Hidden Fire": { "Kentaro SSR": "Receive +5/7/9/12/15, Receive +1/2/3/4/5%", "Yahaba SR": "No buff" },
  "Inarizaki 2nd Years": { "Suna SSR": "Quick Spike +5/7/9/12/15, Quick Spike +1/2/3/4/5%", "Ginjima SSR": "Power Spike +5/7/9/12/15, Power Spike +1/2/3/4/5%", "Osamu UR": "Quick Spike +5/7/9/12/15, Quick Spike +1/2/3/4/5%", "Atsumu UR": "", "Kosaku R": "" },
  "Inarizaki WS Teammates": { "Kita SSR": "Cover +5/7/9/12/15, Cover +1/2/3/4/5%", "Oshiro SSR": "Serve +5/7/9/12/15, Serve +1/2/3/4/5%", "Ginjima SSR": "Receive +5/7/9/12/15, Receive +1/2/3/4/5%", "Kosaku R": "Serve +5/7/9/12/15, Serve +1/2/3/4/5%", "Riseki R": "Serve +5/7/9/12/15, Serve +1/2/3/4/5%" },
  "Japan Youth Training Camp Teammates": { "Kageyama UR": "", "Atsumu UR": "Toss +5/7/9/12/15, Toss +1/2/3/4/5%", "Sakusa UR": "Strong Spike +5/7/9/12/15, Strong Spike +1/2/3/4/5%", "Komori UR": "Receive +5/7/9/12/15, Receive +1/2/3/4/5%", "Hoshiumi UR": "Strong Spike +5/7/9/12/15, Strong Spike +1/2/3/4/5%" },
  "Karasuno 3rd Years": { "Azumane SSR": "Power +5/7/9/12/15, Power +1/2/3/4/5%", "Daichi SSR": "Receive +5/7/9/12/15, Receive +1/2/3/4/5%", "Sugawara SP": "Block +5/7/9/12/15, Block +1/2/3/4/5%" },
  "Karasuno's Failing Grades Group": { "Hinata SSR": "", "Kageyama UR": "", "Nishinoya SSR": "", "Tanaka SSR": "Strong Attack +5/7/9/12/15, Strong Attack +1/2/3/4/5%" },
  "Karasuno's Red Mark Squad (Hanami ver.)": { "Hinata SP": "Receive +5/7/9/12/15, Receive +1/2/3/4/5%", "Nishinoya SP": "Toss +5/7/9/12/15, Toss +1/2/3/4/5%", "Tanaka SSR": "", "Kageyama UR": "" },
  "Karasuno's Setters": { "Sugawara SR": "Toss +5/7/9/12/15, Toss +1/2/3/4/5%", "Kageyama UR": "" },
  "Karasuno's Wing Spiker": { "Tanaka SR": "Power Attack +5/7/9/12/15, Power Attack +1/2/3/4/5%", "Azumane SR": "Serve +5/7/9/12/15, Serve +1/2/3/4/5%", "Chikara SR": "Power Attack +5/7/9/12/15, Power Attack +1/2/3/4/5%" },
  "Leaders Cut from the Same Cloth": { "Daichi SR": "Receive +5/7/9/12/15, Receive +1/2/3/4/5%", "Kuro SSR": "Block +5/7/9/12/15, Block +1/2/3/4/5%" },
  "Master and Apprentice": { "Tsuki SSR": "Block +5/7/9/12/15, Block +1/2/3/4/5%", "Kuro UR": "Block +5/7/9/12/15, Block +1/2/3/4/5%" },
  "Nekoma's Junior": { "Teshiro SR": "Receive +5/7/9/12/15, Receive +1/2/3/4/5%", "Inuoka SR": "No buff", "Lev SSR": "No Buff" },
  "Number One Disciple": { "Bokuto UR": "Spike +5/7/9/12/15, Spike +1/2/3/4/5%", "Hinata SSR": "" },
  "Number One Disciple SP": { "Hinata SP": "Quick Attack +5/7/9/12/15, Quick Attack +1/2/3/4/5%", "Bokuto SP": "Strong Attack +5/7/9/12/15, Strong Attack +1/2/3/4/5%" },
  "One-on-One Training": { "Lev SR": "Block +5/7/9/12/15, Block +1/2/3/4/5%", "Yaku SR": "Receive +5/7/9/12/15, Receive +1/2/3/4/5%" },
  "Perseverance and Tenacity": { "Kenma SP": "Toss +5/7/9/12/15, Toss +1/2/3/4/5%", "Yamamoto SR": "Receive +5/7/9/12/15, Receive +1/2/3/4/5%" },
  "Prediction VS System": { "Tsuki SSR": "No buff", "Tendo SSR": "Block +5/7/9/12/15, Block +1/2/3/4/5%" },
  "Promising Senpai": { "Tendo SSR": "Quick Attack +5/7/9/12/15, Quick Attack +1/2/3/4/5%", "Goshiki SSR": "Power Attack +5/7/9/12/15, Power Attack +1/2/3/4/5%" },
  "Reliable Seniors": { "Kuro UR": "Quick Attack +5/7/9/12/15, Quick Attack +1/2/3/4/5%", "Yaku SSR": "", "Kai SR": "" },
  "Rival Friends": { "Hinata SSR": "Quick Attack +5/7/9/12/15, Quick Attack +1/2/3/4/5%", "Kenma SSR": "Set +5/7/9/12/15, Set +1/2/3/4/5%" },
  "Shiratorizawa 2nd Years": { "Shirabu SSR": "Toss +5/7/9/12/15, Toss +1/2/3/4/5%", "Taichi SR": "Quick +5/7/9/12/15, Quick +1/2/3/4/5%" },
  "Shiratorizawa 3rd Years": { "Ushijima UR": "", "Yamagata SSR": "Receive +5/7/9/12/15, Receive +1/2/3/4/5%", "Ohira SSR": "Spike +5/7/9/12/15, Spike +1/2/3/4/5%", "Semi SSR": "Serve +5/7/9/12/15, Serve +1/2/3/4/5%", "Tendo SSR": "Block +5/7/9/12/15, Block +1/2/3/4/5%" },
  "Silence and Sarcasm": { "Aone SP": "Block +5/7/9/12/15, Block +1/2/3/4/5%", "Futakuchi SSR": "" },
  "Simulated Junior Training Teamate": { "Kanji SR": "Set +5/7/9/12/15, Set +1/2/3/4/5%", "Tsuki SR": "No buff" },
  "Strange Friendship": { "Hinata SP": "Quick Attack +5/7/9/12/15, Quick Attack +1/2/3/4/5%", "Aone SP": "Block +5/7/9/12/15, Block +1/2/3/4/5%" },
  "Team's Guardians": { "Nishinoya SSR": "Receive +5/7/9/12/15, Receive +1/2/3/4/5%", "Yaku SSR": "Receive +5/7/9/12/15, Receive +1/2/3/4/5%" },
  "Team's Guardians (After School)": { "Nishinoya SP": "Receive +5/7/9/12/15, Receive +1/2/3/4/5%", "Yaku SSR": "Receive +5/7/9/12/15, Receive +1/2/3/4/5%" },
  "The \"Enigmatic\" Teammate": { "Lev SSR": "Block +5/7/9/12/15, Block +1/2/3/4/5%", "Kenma SSR": "No buff" },
  "The Absolute King VS the Freak Duo": { "Ushijima UR": "Spike +5/7/9/12/15, Spike +1/2/3/4/5%", "Hinata SSR": "", "Kageyama UR": "" },
  "The King and The Great King": { "Kageyama UR": "Serve +5/7/9/12/15, Serve +1/2/3/4/5%", "Oikawa UR": "Serve +5/7/9/12/15, Serve +1/2/3/4/5%" },
  "The Moment They Fell for Volleyball": { "Bokuto SP": "Spikes +5/7/9/12/15, Spikes +1/2/3/4/5%", "Tsuki SP": "Quick +5/7/9/12/15, Quick +1/2/3/4/5%" },
  "Third Year from Inarizaki": { "Kita SSR": "Receive +5/7/9/12/15, Receive +1/2/3/4/5%", "Oshiro SSR": "Power Attack +5/7/9/12/15, Power Attack +1/2/3/4/5%", "Akagi SSR": "Cover +5/7/9/12/15, Cover +1/2/3/4/5%", "Omimi SR": "Block +5/7/9/12/15, Block +1/2/3/4/5%" },
  "To Greater Heights": { "Kindaichi SR": "", "Oikawa UR": "Toss +5/7/9/12/15, Toss +1/2/3/4/5%" },
  "Tokyo Training Camp Buddies": { "Bokuto SP": "Receive +5/7/9/12/15, Receive +1/2/3/4/5%", "Akaashi SP": "Toss +5/7/9/12/15, Toss +1/2/3/4/5%", "Tsuki SP": "Block +5/7/9/12/15, Block +1/2/3/4/5%", "Kuro SP": "Block +5/7/9/12/15, Block +1/2/3/4/5%" },
  "Tokyo Training Camp Self-Practice Buddies": { "Bokuto UR": "Serve +5/7/9/12/15, Serve +1/2/3/4/5%", "Akaashi SSR": "Toss +5/7/9/12/15, Toss +1/2/3/4/5%", "Kuro UR": "", "Tsuki SSR": "" },
  "Two High-Energy Guys": { "Bobata R": "", "Terushima SSR": "Attack +5/7/9/12/15, Attack +1/2/3/4/5%" },
  "Undisputed Aces": { "Goshiki SSR": "Receive +5/7/9/12/15, Receive +1/2/3/4/5%", "Ushijima UR": "Power Attack +5/7/9/12/15, Power Attack +1/2/3/4/5%" },
  "Ushiwaka and Benkei": { "Ushijima UR": "Block +5/7/9/12/15, Block +1/2/3/4/5%", "Ohira SSR": "Receive +5/7/9/12/15, Receive +1/2/3/4/5%" },
  "Worthy Rival": { "Hinata SSR": "Receive +5/7/9/12/15, Receive +1/2/3/4/5%", "Inuoka SR": "Receive +5/7/9/12/15, Receive +1/2/3/4/5%" },
  "Youth Camp Setters": { "Kageyama UR": "Toss +5/7/9/12/15, Toss +1/2/3/4/5%", "Atsumu UR": "Toss +5/7/9/12/15, Toss +1/2/3/4/5%" },
  "Youth Training Camp": { "Hoshiumi UR": "Serve +5/7/9/12/15, Serve +1/2/3/4/5%", "Kageyama UR": "" },
  "Similar Builds": { "Hinata SP": "Quick Attack +5/7/9/12/15, Quick Attack +1/2/3/4/5%", "Hoshiumi UR": "Strong Attack +5/7/9/12/15, Strong Attack +1/2/3/4/5%" },
  "Similar Physique Teammates": { "Hinata SSR": "", "Hoshiumi UR": "Power Strike +5/7/9/12/15, Power Strike +1/2/3/4/5%" },
  "Kiyoko's Protection Group": {"Tanaka SSR":"Strong Attack +5/7/9/12/15, Strong Attack +1/2/3/4/5%", "Nishinoya SP":"Receive +5/7/9/12/15, Receive +1/2/3/4/5%"},
  "Date Tech‚Äôs Setters": {"Koganegawa SP":"Toss +5/7/9/12/15, Toss +1/2/3/4/5%", "Moniwa SR":"Toss +5/7/9/12/15, Toss +1/2/3/4/5%"},
  "New-type Rookie & the New Captain": {"Koganegawa SP":"Block +5/7/9/12/15, Block +1/2/3/4/5%","Futakuchi SSR":"Block +5/7/9/12/15, Block +1/2/3/4/5%"},
  "Calm and Honest":{"Kunimi SP":"Power Attack +5/7/9/12/15, Power Attack +1/2/3/4/5%","Kindaichi SR":"Quick Attack +5/7/9/12/15, Quick Attack +1/2/3/4/5%"},
  "To Greater Heights":{"Oikawa SP":"Serve +5/7/9/12/15, Serve +1/2/3/4/5%","Kindaichi SR":"Quick Attack +5/7/9/12/15, Quick Attack +1/2/3/4/5%"},
  "Ruthless Trust":{"Oikawa SP":"Power Attack +5/7/9/12/15, Power Attack +1/2/3/4/5%","Kentaro MAD DOG SSR":"Power Attack +5/7/9/12/15, Power Attack +1/2/3/4/5%"},
  "Aoba Johsai Third Years":{"Oikawa SP":"Toss +5/7/9/12/15, Toss +1/2/3/4/5%","Iwaizumi SP":"Power Attack +5/7/9/12/15, Power Attack +1/2/3/4/5%", "Hanamaki SR":"Power Attack +5/7/9/12/15, Power Attack +1/2/3/4/5%", "Matsukawa SR":"Block +5/7/9/12/15, Block +1/2/3/4/5%"},
  "Wolf Society":{"Iwaizumi SP":"Power Attack +5/7/9/12/15, Power Attack +1/2/3/4/5%","Kentaro MAD DOG SSR":"Power Attack +5/7/9/12/15, Power Attack +1/2/3/4/5%"},
  "Aoba Johsai‚Äôs Wing Spikers":{"Iwaizumi SP":"Receive +5/7/9/12/15, Receive +1/2/3/4/5%","Kunimi SP":"Power Attack +5/7/9/12/15, Power Attack +1/2/3/4/5%","Kentaro MAD DOG SSR":"Receive +5/7/9/12/15, Receive +1/2/3/4/5%","Hanamaki SR":"Receive +5/7/9/12/15, Receive +1/2/3/4/5%"},
  "‚ÄòAbsolute King‚Äô VS Genius Combo": {"Hinata SP": "Quick Attack +5/7/9/12/15, Quick Attack +1/2/3/4/5%","Kageyama UR": "Set +5/7/9/12/15, Set +1/2/3/4/5%","Ushijima SP": "Power Attack +5/7/9/12/15, Power Attack +1/2/3/4/5%"},
  "‚ÄòAbsolute King‚Äô and Changeable Setter": {"Ushijima SP": "Power Attack +5/7/9/12/15, Power Attack +1/2/3/4/5%","Shirabu SSR": "Set +5/7/9/12/15, Set +1/2/3/4/5%"},
  "From Great Ace to Ace": {"Ushijima SP": "Power Attack +5/7/9/12/15, Power Attack +1/2/3/4/5%","Goshiki SSR": "Power Attack +5/7/9/12/15, Power Attack +1/2/3/4/5%"},
  "‚ÄòUshiwaka‚Äô and ‚ÄòManager‚Äô": {"Ushijima SP": "Receive +5/7/9/12/15, Receive +1/2/3/4/5%","Ohira SSR": "Receive +5/7/9/12/15, Receive +1/2/3/4/5%"},
  "Inarizaki 5": {"Atsumu UR": "Set +5/7/9/12/15, Set +1/2/3/4/5%","Osamu UR": "Quick Attack +5/7/9/12/15, Quick Attack +1/2/3/4/5%","Rintaro SSR": "Quick Attack +5/7/9/12/15, Quick Attack +1/2/3/4/5%","Ginjima SP": "Power Attack +5/7/9/12/15, Power Attack +1/2/3/4/5%","Yuto R": "Serve +5/7/9/12/15, Serve +1/2/3/4/5%"},
  "Strongest High School Twins": {"Osamu SP" : "Toss +5/7/9/12/15, Toss +1/2/3/4/5%","Rintaro SSR": "Quick Attack +5/7/9/12/15, Quick Attack +1/2/3/4/5%"},
  "Volleyball Club Friends": {"Osamu SP": "Toss +5/7/9/12/15, Toss +1/2/3/4/5%","Atsumu SP": "Quick Attack +5/7/9/12/15, Quick Attack +1/2/3/4/5%", "Oshiro SSR": "Power Attack +5/7/9/12/15, Power Attack +1/2/3/4/5%"},
};
window.STATS_BOND_MEMBERS = {
  // Exemplo; substitua pelo seu conte√∫do completo:
  "Aoba Johsai's Sophomore": ["Watari SR, Yahaba SR, Kentaro SSR"],
  "Behind the Smile": ["Daichi SSR, Kuro UR"],
  "Bench cheer": ["Hisashi R, Kazuhito R"],
  "Building Team Chemistry": ["Kageyama SSR, Tanaka SR"],
  "Cannon \\& Iron Wall": ["Azumane SSR, Aone SSR"],
  "Cannon and Iron Wall": ["Aone SP, Azumane SSR"],
  "Classmates": ["Suna SSR, Osamu UR"],
  "Date Kogyo's Captains": ["Kaname SR, Kenji SSR"],
  "Date Kogyo's Junior": ["Jingo R, Sakunami R"],
  "Date Kogyo's Setter": ["Kaname SR, Kaji SSR"],
  "Fated Rivals": ["Oikawa UR, Ushijima UR"],
  "Flexible Aces": ["Hinata SSR, Lev SSR"],
  "Formidable Opponent": ["Nishinoya SR, Yaku SR"],
  "Friends from Volleyball Class": ["Atsumu UR, Osamu UR, Oshiro SSR"],
  "Fukurodani 3rd Years": ["Bokuto UR, Komi SR, Konoha, Sarukui SSR, Washio SSR"],
  "Fukurodani MBs": ["Washio SSR, Onaga R"],
  "Fukurodani WS": ["Bokuto UR, Sarukui"],
  "Grit and Competitive": ["Yamamoto SR, Kenma SSR"],
  "Hidden Fire": ["Kentaro SSR, Yahaba SR"],
  "Inarizaki 2nd Years": ["Suna SSR, Ginjima SSR, Osamu UR, Atsumu UR, Kosaku R"],
  "Inarizaki WS Teammates": ["Kita SSR, Oshiro SSR, Ginjima SSR, Kosaku R, Riseki R"],
  "Japan Youth Training Camp Teammates": ["Kageyama UR, Atsumu UR, Sakusa UR, Komori UR, Hoshiumi UR"],
  "Karasuno 3rd Years": ["Azumane SSR, Daichi SSR, Sugawara SP"],
  "Karasuno's Failing Grades Group": ["Hinata SSR, Kageyama UR, Nishinoya SSR, Tanaka SSR"],
  "Karasuno's Red Mark Squad (Hanami ver.)": ["Hinata SP, Nishinoya SP, Tanaka SSR, Kageyama UR"],
  "Karasuno's Setters": ["Sugawara SP, Kageyama UR"],
  "Karasuno's Wing Spiker": ["Tanaka SR, Azumane SR, Chikara SR"],
  "Leaders Cut from the Same Cloth": ["Daichi SR, Kuro SSR"],
  "Master and Apprentice": ["Tsuki SSR, Kuro UR"],
  "Nekoma's Junior": ["Teshiro SR, Inuoka SR, Lev SSR"],
  "Number One Disciple": ["Bokuto UR, Hinata SSR"],
  "Number One Disciple SP": ["Hinata SP, Bokuto SP"],
  "One-on-One Training": ["Lev SR, Yaku SR"],
  "Perseverance and Tenacity": ["Kenma SP, Yamamoto SR"],
  "Prediction VS System": ["Tsuki SSR, Tendo SSR"],
  "Promising Senpai": ["Tendo SSR, Goshiki SSR"],
  "Reliable Seniors": ["Kuro UR, Yaku SSR, Kai SR"],
  "Rival Friends": ["Hinata SSR, Kenma SSR"],
  "Shiratorizawa 2nd Years": ["Shirabu SSR, Taichi SR"],
  "Shiratorizawa 3rd Years": ["Ushijima UR, Yamagata SSR, Ohira SSR, Semi SSR, Tendo SSR"],
  "Silence and Sarcasm": ["Aone SP, Futakuchi SSR"],
  "Simulated Junior Training Teamate": ["Kanji SR, Tsuki SR"],
  "Strange Friendship": ["Hinata SP, Aone SP"],
  "Team's Guardians": ["Nishinoya SSR, Yaku SSR"],
  "Team's Guardians (After School)": ["Nishinoya SP, Yaku SSR"],
  "The \"Enigmatic\" Teammate": ["Lev SSR, Kenma SSR"],
  "The Absolute King VS the Freak Duo": ["Ushijima UR, Hinata SSR, Kageyama UR"],
  "The King and The Great King": ["Kageyama UR, Oikawa UR"],
  "The Moment They Fell for Volleyball": ["Bokuto SP, Tsuki SP"],
  "Third Year from Inarizaki": ["Kita SSR, Oshiro SSR, Akagi SSR, Omimi SR"],
  "To Greater Heights": ["Kindaichi SR, Oikawa UR"],
  "Tokyo Training Camp Buddies": ["Bokuto SP, Akaashi SP, Tsuki SP, Kuro SP"],
  "Tokyo Training Camp Self-Practice Buddies": ["Bokuto UR, Akaashi SSR, Kuro UR, Tsuki SSR"],
  "Two High-Energy Guys": ["Bobata R, Terushima SSR"],
  "Undisputed Aces": ["Goshiki SSR, Ushijima UR"],
  "Ushiwaka and Benkei": ["Ushijima UR, Ohira SSR"],
  "Worthy Rival": ["Hinata SSR, Inuoka SR"],
  "Youth Camp Setters": ["Kageyama UR, Atsumu UR"],
  "Youth Training Camp": ["Hoshiumi UR, Kageyama UR"],
  "Similar Builds": ["Hinata SP, Hoshiumi UR"],
  "Similar Physique Teammates": ["Hinata SSR, Hoshiumi UR"],
  "Kiyoko's Protection Group": ["Tanaka SSR, Nishinoya SP"],
  "Date Tech‚Äôs Setters":["Koganegawa SP, Moniwa SR"],
  "New-type Rookie & the New Captain":["Koganegawa SP, Futakuchi SSR"],
  "Calm and Honest":["Kunimi SP, Kindaichi SR"],
  "To Greater Heights":["Oikawa SP, Kindaichi SR"],
  "Ruthless Trust":["Oikawa SP, Kentaro MAD DOG SSR"],
  "Aoba Johsai Third Years":["Oikawa SP, Iwaizumi SP, Matsukawa SR, Hanamaki SR"],
  "Wolf Society":["Iwaizumi SP, Kentaro MAD DOG SSR"],
  "Aoba Johsai‚Äôs Wing Spikers":["Iwaizumi SP, Kunimi SP, Kentaro MAD DOG SSR, Hanamaki SR"],
  "‚ÄòAbsolute King‚Äô VS Genius Combo": ["Hinata SP,Kageyama UR,Ushijima SP"],
  "‚ÄòAbsolute King‚Äô and Changeable Setter": ["Ushijima SP,Shirabu SSR"],
  "From Great Ace to Ace": ["Ushijima SP, Goshiki SSR"],
  "‚ÄòUshiwaka‚Äô and ‚ÄòManager‚Äô": ["Ushijima SP,Ohira SSR"],
  "Inarizaki 5":["Atsumu UR,Osamu UR,Rintaro SSR,Ginjima SP,Yuto R"],
  "Strongest High School Twins": ["Osamu SP,Rintaro SSR"],
  "Volleyball Club Friends": ["Osamu SP,Atsumu SP,Oshiro SSR"],
};

let selecionados = [];

let teams = window.teams || [];            // se j√° existir, reutiliza
let currentTeamIndex = window.currentTeamIndex || 0;
let __mtAdding = false;                    // lock anti-duplo clique

// ===== Backend (Apps Script) =====
const API = 'https://script.google.com/macros/s/AKfycbxNmBqnW8mSeNUBdBCxlaXRgEajY_GrTXIJPo_2PrMm2v_ZhsRsvW50K9cZzaGOqyu5/exec'; // o mesmo usado no contador de views

// sesssion_id est√°vel por navegador (para cooldown de coment√°rios e analytics)
const SESSION_KEY = 'hqSessionIdV1';
const SESSION_ID = (() => {
  let id = localStorage.getItem(SESSION_KEY);
  if (!id) { id = 's_' + Math.random().toString(36).slice(2) + Date.now().toString(36); localStorage.setItem(SESSION_KEY, id); }
  return id;
})();

// idioma da p√°gina -> "ptbr" ou "en"
function currentLang(){
  const h = (document.documentElement.lang || '').toLowerCase();
  if (h.includes('pt')) return 'ptbr';
  return 'en';
}

async function apiGet(params){
  const url = API + (API.includes('?') ? '&' : '?') + params;
  const r = await fetch(url, {method:'GET', mode:'cors'});
  return r.json();
}
async function apiPost(action, payload){
  const url = API + (API.includes('?') ? '&' : '?') + 'action=' + encodeURIComponent(action);
  const body = new URLSearchParams({ payload: JSON.stringify(payload) });
  const r = await fetch(url, {
    method: 'POST',
    headers: { 'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8' },
    body
  });
  const text = await r.text();
  try { return JSON.parse(text); } catch { return { ok:false, raw:text }; }
}



// considera ‚Äúcompleto‚Äù quando os 6 titulares est√£o preenchidos
function isTeamComplete(team){
  const filled = (team.main || []).filter(Boolean).length;
  return filled === 7; // ajuste se quiser exigir bench tamb√©m
}

// serializa√ß√£o dos itens (fallback caso n√£o exista no arquivo)
function serializeTeamItemsSafe(){
  try { return (typeof serializeTeamItems === 'function') ? serializeTeamItems() : {}; }
  catch(e){ return {}; }
}

// evita spam: s√≥ envia se mudou
let __lastSentHash = null;
// === Debounce para enviar o time automaticamente ===
let sendTimer = null;

function scheduleSendTeam(delay = 300){
  if (sendTimer) clearTimeout(sendTimer);
  sendTimer = setTimeout(sendTeamIfComplete, delay);
}
// chame isto sempre que o grid mudar (adicionar/trocar/remover)
function onGridChanged(){
  scheduleSendTeam(300);
}


// substitua sua sendTeamIfComplete por esta
async function sendTeamIfComplete(){
  try{
    // nomes atuais do grid
    const mainNames = [...document.querySelectorAll('.hex')].map(s=>s.dataset.nome).filter(Boolean);
    const benchNames = [...document.querySelectorAll('.bench-slot')].map(s=>s.dataset.nome).filter(Boolean);

    const isComplete = mainNames.length === 7; // exatamente 7 titulares
    // mapeia posi√ß√£o pelo r√≥tulo ao lado/abaixo do slot ou via fallback POS_ORDER
    const hexes = [...document.querySelectorAll('.hex')];
    const POS_ORDER = ['S','MB','WS','L','WS','MB','OP']; // j√° existe no seu arquivo

    const slots = hexes.slice(0, 7).map((el, i) => {
      const id = el.dataset.key || el.dataset.id || el.dataset.nome || '';
      // tenta ler o r√≥tulo (S/MB/WS/L/OP)
      const parent = el.closest('.slot, .slot-wrap, .slot-container, .grid-cell, .hex-wrap') || el.parentElement;
      const label = parent && parent.querySelector('.pos, .role, .slot-role, .slot-label, .position, .label');
      const txt = (label?.textContent || el.nextElementSibling?.textContent || '').trim().toUpperCase();
      const pos = /^(S|MB|WS|L|OP)$/.test(txt) ? txt : (POS_ORDER[i] || 'WS');
      return { id, pos };
    }).filter(s => s.id); // s√≥ slots preenchidos

    if (isComplete && slots.length === 7){
      await apiPost('setteam', { session_id: SESSION_ID, team: { slots, bench: benchNames } });
    } else {
      await apiPost('clearteam', { session_id: SESSION_ID });
    }
  }catch(e){
    console.warn('sendTeamIfComplete error', e);
  }
}



// pluga nos hooks globais que voc√™ j√° exp√µe (sem mexer em setCharacter)
(function hookSends(){
  const oldAfterAssign = window.afterAssignCharacter;
  window.afterAssignCharacter = function(el, nome){
    if (typeof oldAfterAssign === 'function') oldAfterAssign(el, nome);
    sendTeamIfComplete();
  };
  const oldAfterRemove = window.afterRemoveCharacter;
  window.afterRemoveCharacter = function(el){
    if (typeof oldAfterRemove === 'function') oldAfterRemove(el);
    sendTeamIfComplete();
  };
})();
let RANK = { week:[], all:[], chars:[] };
let SHOWN = { week:5, all:5 };

function fmtTeamRow(t){
  // miniaturas no item (ver item 3 abaixo para CSS/lookup)
  const imgs = (t.team?.slots||[]).slice(0,7).map(s=>{
    const ch   = findCharPreferExact(s.id);
    const src = ch?.img || '';
    const title = s.id;
    return `<img class="mini-char" src="${src}" alt="${title}" title="${title}">`;
  }).join('');
  const cnt = t.count ?? t.hits ?? 0;
  return `
    <li class="top-row-li">
      <span class="mini-line">${imgs}</span>
      <small>x${cnt}</small>
      <button data-import="${t.team_id}" class="btn-imp">Import</button>
      <button data-comments="${t.team_id}" class="btn-cmt" title="Comments">üí¨</button>
    </li>`;
}
window.CHAR_BY_FULL = new Map(
  (window.CHAR_LIST || []).map(c => [`${c.name} ${c.rarity}`.toUpperCase(), c])
);

// preferir match EXATO com raridade; se n√£o achar, usa seu fuzzy atual
function findCharPreferExact(q){
  const s = String(q || '').trim();
  if (!s) return null;
  const exact = window.CHAR_BY_FULL.get(s.toUpperCase());
  return exact || (typeof findCharByAnyName === 'function' ? findCharByAnyName(s) : null);
}
function fmtCharRow(c){
  // c pode vir como {id,name,count|hits|value|tester,...}
  const key   = c?.id || c?.name || '';
  const count = c?.tester ?? c?.value ?? c?.count ?? c?.hits ?? c?.total ?? 0;

  // tenta achar os metadados/imagem do personagem por nome
  // (usa o mesmo helper que voc√™ j√° usa nos times)
  const meta = findCharPreferExact(key);
  const src   = meta?.img || meta?.icon || ''; // fallback se houver outro campo
  const title = key;

  return `
    <li class="top-row-li char-row">
      <span class="mini-line">
        <img class="mini-char" src="${src}" alt="${title}" title="${title}">
        <span class="char-name">${title}</span>
      </span>
      <small>x${count}</small>
    </li>
  `;
}
function aggregateCharRankingFromTeams(list){
  // list: array de objetos de ranking de times (RANK.all ou RANK.week)
  // soma apari√ß√µes do personagem em cada envio (ponderado pelo hits/count/tester)
  const counts = new Map();
  for (const t of (list || [])){
    const weight = t?.tester ?? t?.value ?? t?.count ?? t?.hits ?? t?.total ?? 1;
    const ids = [
      ...((t?.team?.slots || []).map(s => s?.id).filter(Boolean)),
      ...((t?.team?.bench || []).filter(Boolean)) // se bench vier como array simples de nomes
    ];
    for (const id of ids){
      // trata nomes de forma est√°vel, sem mesclar UR/SP
      const key = String(id).trim();
      counts.set(key, (counts.get(key) || 0) + Number(weight || 1));
    }
  }
  // ordena e retorna no formato esperado pelo render
  return [...counts.entries()]
    .sort((a,b)=> b[1]-a[1])
    .map(([name, tester]) => ({ name, tester }));
}

function renderRankTeams7d(){
  const el = document.getElementById('panelRank7d');
  if(!el) return;
  el.innerHTML = `
    <h3 class="top-title">Top Teams (7d)</h3>
    <ul class="top-list">${ (RANK.week||[]).slice(0, SHOWN.week).map(fmtTeamRow).join('') || '<li>‚Äî</li>' }</ul>
    <div class="center"><button id="wkMore" class="menu-btn">Ver Mais</button></div>
  `;
  el.querySelector('#wkMore')?.addEventListener('click', (ev)=>{
    ev.stopPropagation?.();
    SHOWN.week += 5;
    renderRankTeams7d();
  });
}

function renderRankTeamsAll(){
  const el = document.getElementById('panelRankAll');
  if(!el) return;
  el.innerHTML = `
    <h3 class="top-title">Top Teams (All)</h3>
    <ul class="top-list">${ (RANK.all||[]).slice(0, SHOWN.all).map(fmtTeamRow).join('') || '<li>‚Äî</li>' }</ul>
    <div class="center"><button id="allMore" class="menu-btn">Ver Mais</button></div>
  `;
  el.querySelector('#allMore')?.addEventListener('click', (ev)=>{
    ev.stopPropagation?.();
    SHOWN.all += 5;
    renderRankTeamsAll();
  });
}

function renderRankCharacters(){
  const el = document.getElementById('panelRankChar');
  if(!el) return;
  el.innerHTML = `
    <h3 class="top-title">Top Characters</h3>
    <ul class="top-list">${
  Array.isArray(RANK?.chars) && RANK.chars.length
    ? RANK.chars.map(fmtCharRow).join('')
    : '<li>‚Äî</li>'
}</ul>
  `;
}
function buildCharRankingFromTeams(teamRows){
  const map = new Map();
  const add = (name, weight) => {
    if (!name) return;
    map.set(name, (map.get(name) || 0) + (weight || 1));
  };

  (teamRows || []).forEach(t => {
    const weight = t.tester ?? t.value ?? t.count ?? t.hits ?? t.total ?? 1; // vezes que o time apareceu
    const slots  = t?.team?.slots || [];   // [{id, pos}]
    const bench  = t?.team?.bench || [];   // ["nome1","nome2",...]

    // titulares
    for (const s of slots) add(s?.id || s?.name, weight);
    // banco
    for (const b of bench) add(b, weight);
  });

  // transforma em array ordenado
  const arr = [...map.entries()]
    .map(([name, tester]) => ({ name, tester }))   // {name, tester} compat√≠vel com fmtCharRow
    .sort((a,b) => b.tester - a.tester);

  return arr;
}
// peso (hits/count/tester/total)
const weightOfTeam = (t)=>(t?.tester ?? t?.value ?? t?.count ?? t?.hits ?? t?.total ?? 0);
const weightOfChar = (c)=>(c?.tester ?? c?.value ?? c?.count ?? c?.hits ?? c?.total ?? 0);

// totais (ser√£o preenchidos em loadRankings)
let TOTALS = { week:0, all:0, chars:0 };
async function loadRankings(){
  await ensureCharacterList(); // garante lista p/ thumbs
  const week = await apiGet('action=top_week&days=7');
  const allT = await apiGet('action=top_alltime');
  const topC = await apiGet('action=top_chars&topN=50');
  RANK.week = week?.top || [];
  RANK.all  = allT?.top || [];
  if (!Array.isArray(RANK.chars) || RANK.chars.length === 0){
  // usa o ALL por padr√£o para ranking de personagens (pode trocar para week se quiser)
  RANK.chars = buildCharRankingFromTeams(RANK.all);
}
  SHOWN.week = 5; SHOWN.all = 5;
  TOTALS.week  = (RANK.week  || []).reduce((s,t)=> s + weightOfTeam(t), 0);
  TOTALS.all   = (RANK.all   || []).reduce((s,t)=> s + weightOfTeam(t), 0);
TOTALS.chars = (RANK.chars || []).reduce((s,c)=> s + weightOfChar(c), 0);
  renderRankTeams7d();
renderRankTeamsAll();
renderRankCharacters();
}

// eventos dos bot√µes ‚Äúver mais‚Äù
document.addEventListener('click', (ev)=>{
  if (ev.target?.id === 'wkMore'){ 
    ev.stopPropagation();
    SHOWN.week += 5; 
    renderRankTeams7d();
    renderRankTeamsAll();
    renderRankCharacters();
  }
  if (ev.target?.id === 'allMore'){ 
    ev.stopPropagation();
    SHOWN.all  += 5; 
    renderRankTeams7d();
    renderRankTeamsAll();
    renderRankCharacters();
  }
});

async function ensureCharacterList(){
  if (getCharList().length) return;
}
// --------- delega√ß√£o de eventos (Import / Comments) ----------
document.addEventListener('click', async (ev)=>{
  const btn = ev.target.closest('[data-import],[data-comments]');
  if (!btn) return;

  // evita fechar a lateral/propagar para listeners globais
  ev.stopPropagation();

  // IMPORTAR TIME
  if (btn.hasAttribute('data-import')) {
    const teamId = btn.getAttribute('data-import');
    try {
      await ensureCharacterList(); // garante a lista carregada
      const r = await apiGet('action=getteam&team_id='+encodeURIComponent(teamId));
      if (!r?.ok || !r.team){ console.warn('getteam fail', r); alert('N√£o foi poss√≠vel carregar esse time.'); return; }
      applyTeamFromServer(r.team); // preenche o grid
    } catch (e) {
      console.error('import error', e);
      alert('Erro ao importar time.');
    }
    return;
  }

  // COMENT√ÅRIOS
  if (btn.hasAttribute('data-comments')) {
    const teamId = btn.getAttribute('data-comments');
    try {
      await openCommentsUI(teamId); // abre o modal e carrega coment√°rios
    } catch(e){
      console.error('comments error', e);
      alert('N√£o foi poss√≠vel abrir os coment√°rios.');
    }
  }
});

// aplica um time vindo da API ao teu grid
// ===== helpers =====
const POS_ORDER = ['S','MB','WS','L','WS','MB','OP'];

// √çndice de match exato por nome COMPLETO (preserva UR/SSR/SP)
(function buildCharFullIndex(){
  const L = (window.characters || window.charactersEN || window.allCharacters || []);
  const m = new Map();
  const put = (k,c)=>{
    if (!k) return;
    const key = String(k).trim().toUpperCase().replace(/\s+/g,' ');
    if (key) m.set(key, c);
  };
  for (const c of L){
    put(c.nome, c);
    put(c.name, c);
    put(c.display, c);
    put(c.id, c);
  }
  window.CHAR_FULL = m;
})();

// Preferir EXATO (sem retirar raridade). Se n√£o achar, cai no fuzzy antigo.
function findCharPreferExact(q){
  const s = String(q||'').trim();
  if (!s) return null;

  // 1) exato (case-insensitive, espa√ßos normalizados)
  const key = s.toUpperCase().replace(/\s+/g,' ');
  const hit = window.CHAR_FULL && window.CHAR_FULL.get(key);
  if (hit) return hit;

  // 2) exato tolerante a acento
  const norm = (x)=>String(x||'').normalize('NFD').replace(/[\u0300-\u036f]/g,'').toUpperCase().replace(/\s+/g,' ');
  if (window.CHAR_FULL){
    const target = norm(s);
    for (const [k,v] of window.CHAR_FULL){
      if (norm(k) === target) return v;
    }
  }

  // 3) fallback: fuzzy existente (pode remover UR/SSR/SP etc.)
  return (typeof findCharByAnyName==='function') ? findCharByAnyName(s) : null;
}


function getHexList(){ return [...document.querySelectorAll('.hex')]; }

function clearGrid(){
  getHexList().forEach(el => { el.innerHTML=''; delete el.dataset.nome; });
  document.querySelectorAll('.bench-slot').forEach(el => { el.innerHTML=''; delete el.dataset.nome; });
  
}

function norm(s){
  return String(s||'').normalize('NFD').replace(/[\u0300-\u036f]/g,'')
    .replace(/\s+/g,' ').trim().toLowerCase();
}
function canon(s){
  return norm(String(s||'')
    .replace(/\s*-\s*(S|MB|WS|L|OP)\b/gi,'')
    .replace(/\b(UR|SSR|SP)\b/gi,'')
  );
}
function getCharList(){
  return window.characters || window.charactersEN || window.allCharacters || [];
}
function findCharByAnyName(name){
  const t = canon(name);
  const L = getCharList();
  return L.find(c => canon(c.nome)===t) ||
         L.find(c => canon(c.name)===t) ||
         L.find(c => canon(c.display)===t) ||
         L.find(c => canon(c.id)===t) || null;
}

function nextFreeSlotForPos(pos, usedIdx){
  const hexes = getHexList();

  // tentar por r√≥tulo do slot
  for (let i=0;i<hexes.length;i++){
    if (usedIdx.has(i)) continue;
    const el = hexes[i];
    const parent = el.closest('.slot, .slot-wrap, .slot-container, .grid-cell, .hex-wrap') || el.parentElement;
    const label  = parent && parent.querySelector('.pos, .role, .slot-role, .slot-label, .position, .label');
    const txt = (label?.textContent || el.nextElementSibling?.textContent || '').trim().toUpperCase();
    if (['S','MB','WS','L','OP'].includes(txt) && txt === pos) return {el, i};
  }
  // fallback por ordem visual fixa
  for (let i=0;i<hexes.length;i++){
    if (usedIdx.has(i)) continue;
    if (POS_ORDER[i] === pos) return {el:hexes[i], i};
  }
  return {el:null, i:-1};
}

function safeSetCharacter(el, ch, pos){
  try {
    if (typeof setCharacter === 'function') {
      setCharacter(el, ch, ch.funcao || ch.role || pos);
      emitTeamChanged();
      return true;
      if (typeof emitTeamChanged==='function');
    }
  } catch(e){ console.warn('setCharacter falhou', e); }
  try {
    el.innerHTML = `<img src="${ch.img}" alt="${ch.nome||ch.name}">`;
    el.dataset.nome = ch.nome || ch.name || ch.id;
    return true;
  } catch(_) {}
  return false;
  
}

const wait = (ms)=>new Promise(r=>setTimeout(r,ms));


// tenta achar o elemento .hex do slot que TEM r√≥tulo == pos (S,MB,WS,L,OP)
function getSlotElByPos(pos){
  const hexes = [...document.querySelectorAll('.hex')];
  // seletores comuns de r√≥tulos sob/ao lado do slot ‚Äì testamos v√°rios
  const labelSelectors = ['.pos', '.role', '.slot-role', '.slot-label', '.position', '.label'];
  for (const el of hexes){
    const parent = el.closest('.slot, .slot-wrap, .slot-container, .grid-cell, .hex-wrap') || el.parentElement;
    if (!parent) continue;
    let labelText = '';
    for (const sel of labelSelectors){
      const lab = parent.querySelector(sel);
      if (lab){ labelText = (lab.textContent||'').trim().toUpperCase(); if (labelText) break; }
    }
    // fallback: se o texto do pr√≥ximo irm√£o √© s√≥ "S"/"MB"/etc
    if (!labelText && el.nextElementSibling){
      const txt = (el.nextElementSibling.textContent||'').trim().toUpperCase();
      if (/^(S|MB|WS|L|OP)$/.test(txt)) labelText = txt;
    }
    if (labelText === pos) return el;
  }
  // n√£o achou por r√≥tulo: tenta por √≠ndice fixo (ordem visual)
  const idx = POS_FALLBACK_ORDER.findIndex(p => p === pos);
  return hexes[idx] || null;
}



// ===== import principal =====
async function applyTeamFromServer(team){
  const slots = team.slots || [];
  const bench = team.bench || [];
  const used  = new Set();

  clearGrid();

  // titulares, um por vez
  for (const s of slots){
    const pos = (s.pos||'').toUpperCase();
    const ch  = findCharPreferExact(s.id);
    if (!ch){ console.warn('[import] personagem n√£o encontrado:', s.id); continue; }

    const {el, i} = nextFreeSlotForPos(pos, used);
    if (!el){ console.warn('[import] slot livre n√£o encontrado para', pos); continue; }

    used.add(i);
    safeSetCharacter(el, ch, pos);
    onGridChanged();
    await wait(40);
  }

  // banco
  const benchEls = [...document.querySelectorAll('.bench-slot')];
  for (let i=0;i<benchEls.length;i++){
    const name = bench[i] || '';
    if (!name) continue;
    const ch = findCharPreferExact(name);
    if (ch){ safeSetCharacter(benchEls[i], ch, 'BENCH'); await wait(20); }
  }

  if (typeof updateSynergies==='function') updateSynergies();
  if (typeof emitTeamChanged==='function') emitTeamChanged(); // conta no ranking


  // itens (opcional)
  try { if (typeof applyTeamItems === 'function') applyTeamItems(team.items||{}); } catch(_){}

  console.log(`[Import] Aplicado: ${applied} titulares`);
  console.groupEnd();

  // dispara o envio autom√°tico para contar no ranking
  emitTeamChanged();
  onGridChanged();
}



document.addEventListener('DOMContentLoaded', ()=>{
  // pr√©-carrega em background; quando abrir a p√°gina, j√° est√° pronto
  loadRankings().catch(()=>{});
});
setInterval(loadRankings, 60000);
async function openCommentsUI(team_id){
  const wrap = document.createElement('div');
  wrap.className = 'item-modal-backdrop';
  const box = document.createElement('div');
  box.className  = 'item-modal';
  wrap.appendChild(box);

  box.innerHTML = `
    <h3>Comments</h3>
    <div id="cList" style="max-height:260px; overflow:auto; border:1px solid #444; padding:8px; border-radius:8px; background:#1e1e1e;"></div>
    <div style="display:flex; gap:8px; margin-top:8px;">
      <input id="cNick" placeholder="Nick" style="flex:0 0 160px; padding:6px;">
      <input id="cMsg"  placeholder="Message..." style="flex:1; padding:6px;">
      <button id="cSend" class="item-btn">Send</button>
      <button id="cClose" class="item-btn">Close</button>
    </div>
  `;

  async function load(){
    const lang = currentLang(); // "ptbr" | "en"
    const r = await apiGet(`action=comments&team_id=${encodeURIComponent(team_id)}&limit=100&lang=${lang}`);
    const list = (r?.comments||[]);
    const html = list.map(c=>`<div style="padding:6px 4px;border-bottom:1px solid #333;"><b>${c.nick}</b> ‚Äî <small>${(c.created_at||'').replace('T',' ')}</small><br>${c.message}</div>`).join('') || '<i>No comments yet.</i>';
    box.querySelector('#cList').innerHTML = html;
    // nick lembrado
    const saved = localStorage.getItem('hqNick');
    if(saved) box.querySelector('#cNick').value = saved;
  }

  box.querySelector('#cSend').addEventListener('click', async ()=>{
    const nick = (box.querySelector('#cNick').value || '').trim().slice(0,20);
    const message = (box.querySelector('#cMsg').value || '').trim().slice(0,300);
    if(!message){ box.querySelector('#cMsg').focus(); return; }
    localStorage.setItem('hqNick', nick || 'Anon');
    const res = await apiPost('addcomment', { team_id, nick: (nick||'Anon'), message, lang: currentLang(), session_id: SESSION_ID });
    if(res?.ok){
      box.querySelector('#cMsg').value = '';
      load(); // aparece sem recarregar a p√°gina
    }else if(res?.error === 'cooldown'){
      alert(`Aguarde ${res.seconds_left||120}s para comentar novamente.`);
    }else{
      alert('Falha ao enviar coment√°rio.');
    }
  });
  box.querySelector('#cClose').addEventListener('click', ()=> wrap.remove());

  document.body.appendChild(wrap);
  load();
}
function debounce(fn, ms){ let t; return (...a)=>{ clearTimeout(t); t=setTimeout(()=>fn(...a), ms);} }
function emitTeamChanged(){ window.dispatchEvent(new Event('team:changed')); }
function setupAutoSendObservers(){
  const sendDebounced = debounce(()=>{ try{ sendTeamIfComplete(); }catch(e){ console.warn(e);} }, 300);

  // 2a) observar altera√ß√µes nos slots titulares e bench
  const mo = new MutationObserver(() => onGridChanged());
  document.querySelectorAll('.hex, .bench-slot').forEach(el=>{
    mo.observe(el, {
      attributes:true,
      attributeFilter:['data-nome','src'],
      childList:true,
      subtree:false
    });
  });

  // 2b) escutar um evento global (vamos emitir em v√°rios lugares)
  window.addEventListener('team:changed', () => scheduleSendTeam(300));

  // 2c) integrar com hooks j√° existentes (se existirem)
  const oldAfterAssign = window.afterAssignCharacter;
  window.afterAssignCharacter = function(el, nome){
    if (typeof oldAfterAssign === 'function') oldAfterAssign(el, nome);
    emitTeamChanged();
  };
  const oldAfterRemove = window.afterRemoveCharacter;
  window.afterRemoveCharacter = function(el){
    if (typeof oldAfterRemove === 'function') oldAfterRemove(el);
    emitTeamChanged();
  };

  // 2d) primeira checagem (p√°gina j√° pode abrir com time completo)
  setTimeout(sendDebounced, 500);
}

document.addEventListener('DOMContentLoaded', setupAutoSendObservers);

// se existir fun√ß√£o que carrega time salvo ao trocar ‚ÄúTeam 1/2/3‚Ä¶‚Äù
const oldLoadSaved = window.loadSavedTeam;
window.loadSavedTeam = function(...args){
  const r = oldLoadSaved ? oldLoadSaved.apply(this, args) : undefined;
  emitTeamChanged();
  return r;
};

// se o bot√£o ‚Äú+ Team‚Äù limpa/muda o grid:
const plus = document.querySelector('[data-action="add-team"], .btn-add-team, .plus-team');
if (plus) plus.addEventListener('click', ()=> setTimeout(emitTeamChanged, 200));
/* ====== FUN√á√ïES ORIGINAIS (mantidas) ====== */
function addBenchSlot() {
    const benchRow = document.getElementById("bench-row");
    const slot = document.createElement("div");
    slot.className = "player-slot bench";
    slot.innerHTML = `<div class="bench-slot" data-role="bench"></div><div class="player-info">Banco</div>`;
    benchRow.insertBefore(slot, benchRow.querySelector(".add-slot-btn"));
    attachBenchEvents(slot.querySelector(".bench-slot"));
}

function attachBenchEvents(slot) {
  if (slot.__benchBound) return;         // evita duplicar handlers
  slot.__benchBound = true;

  let clickTimer = null;

  slot.addEventListener("click", (e) => {
    e.stopPropagation();

    // 2¬∫ clique dentro da janela => trata como duplo clique
    if (clickTimer) {
      clearTimeout(clickTimer);
      clickTimer = null;

      const nome = slot.dataset.nome;
      if (!nome) {
        // slot vazio: no duplo clique, abrimos o menu mesmo assim
        if (typeof showMenu === "function") showMenu("bench", slot);
        return;
      }

      const p = (typeof characters !== "undefined") && characters.find(x => x.nome === nome);
      if (!p) return;

      const sm = document.getElementById("scrollMenu");
      if (sm) sm.style.display = "none";     // fecha menu de sele√ß√£o, se aberto

      if (typeof showCharacterDetails === "function") showCharacterDetails(p);

      const sidebar = document.getElementById("sidebar");
      const menuBtn = document.getElementById("menuBtn");
      if (sidebar) sidebar.classList.add("open");
      if (menuBtn) menuBtn.style.display = "none";
      return;
    }

    // 1¬∫ clique: se n√£o vier 2¬∫ clique r√°pido, abre o menu do banco
    clickTimer = setTimeout(() => {
      clickTimer = null;
      if (typeof showMenu === "function") showMenu("bench", slot);
    }, 250);
  });

  // bot√£o direito: remover do banco
  slot.addEventListener("contextmenu", (e) => {
  // ‚úÖ no mobile: long-press n√£o remove (agora usa o X)
  if (window.matchMedia && matchMedia("(pointer: coarse)").matches) {
    e.preventDefault();
    e.stopPropagation();
    return;
  }
  // ‚úÖ no PC: bot√£o direito remove como antes
  e.preventDefault();
  if (typeof removeCharacter === "function") removeCharacter(slot);
});

}

function isAllowedForStarterSlot(slotRole, charRole) {
  const slot = String(slotRole || '').toUpperCase();
  const role = String(charRole || '').toUpperCase();
  if (!slot || slot === 'BENCH') return true;   // seguran√ßa
  if (slot === 'L') return role === 'L';
  return role !== 'L';
}

function showMenu(role, slot) {
  const scrollMenu = document.getElementById("scrollMenu");
  scrollMenu.innerHTML = '';
  window.__lastMenuCtx = { role, slot };
  scrollMenu.style.display = 'flex';
  scrollMenu.style.flexDirection = 'column';

  const isBench = (role === 'bench');
  const slotRole = isBench ? 'bench' : (slot.dataset.role || slot.getAttribute('data-role'));

  // Cabe√ßalho com bot√µes
  const bar = document.createElement('div');
  bar.className = 'bench-quick-inside';

  const ROLES = ['All','S','MB','WS','OP','L'];
  // Filtro inicial: se for L, come√ßa em L; caso contr√°rio, come√ßa em All (n√£o-L).
  let currentFilter = isBench ? 'All' : (ROLES.includes(String(slotRole).toUpperCase()) ? String(slotRole).toUpperCase() : 'All');

  function roleAllowedInThisSlot(r){
    if (r === 'All') return true; // "All" ser√° interpretado como "todos permitidos"
    if (slotRole === 'bench') return true; // bench n√£o restringe por fun√ß√£o aqui
    // starters
    return isAllowedForStarterSlot(slotRole, r);
  }

  ROLES.forEach(r => {
    const b = document.createElement('button');
    b.textContent = r;
    b.dataset.role = r;

    // Bot√µes inv√°lidos para o slot ficam desabilitados
    if (!roleAllowedInThisSlot(r)) {
      b.disabled = true;
      b.classList.add('disabled');
    }

    if (r === currentFilter) b.classList.add('active');
    b.addEventListener('click', (e) => {
      e.stopPropagation();
      if (b.disabled) return;
      currentFilter = r;
      bar.querySelectorAll('button').forEach(x => x.classList.toggle('active', x === b));
      render();
    });
    bar.appendChild(b);
  });

  scrollMenu.appendChild(bar);

  // Container das imagens
  const grid = document.createElement('div');
  grid.style.display = 'flex';
  grid.style.flexWrap  = 'wrap';
  grid.style.gap = '8px';
  scrollMenu.appendChild(grid);

  function render(){
    grid.innerHTML = '';

    let disponiveis = characters.filter(p => !selecionados.includes(p));

    // 1) aplica filtro por bot√£o (exceto 'All')
    if (currentFilter !== 'All') {
      disponiveis = disponiveis.filter(p => p.funcao === currentFilter);
    }

    // 2) aplica regra do slot (para starters). Em 'All', isso converte "todos" em "todos permitidos"
    if (!isBench) {
      disponiveis = disponiveis.filter(p => isAllowedForStarterSlot(slotRole, p.funcao));
    } else {
      // bench mant√©m os pr√≥prios limites, se voc√™ quiser j√° pr√©-filtrar, pode aplicar aqui
      disponiveis = disponiveis.filter(p => respeitaLimiteBench(p, slot));
    }

    if (disponiveis.length === 0){
      grid.innerHTML = `<div style="color:#ccc; padding:8px;">
        No available ${currentFilter === 'All' ? '' : currentFilter}${isBench ? ' for bench' : ''}.
      </div>`;
      return;
    }

    disponiveis.forEach(p => {
      const img = document.createElement('img');
      img.src = p.img;
      img.alt = p.nome;
      img.title = p.nome;
      img.addEventListener('click', (e) => {
        e.stopPropagation();
        const keepRole = isBench ? 'bench' : slotRole; // preserva o label do slot
        setCharacter(slot, p, keepRole);
        scrollMenu.style.display = 'none';
      });
      grid.appendChild(img);
    });
  }

  render();
}

function respeitaLimiteBench(p, slot) {
    const Bench = Array.from(document.querySelectorAll(".bench-slot"))
        .map(s => s.dataset.nome && characters.find(x => x.nome === s.dataset.nome))
        .filter(Boolean);

    if (slot.dataset.nome === p.nome) return true;

    const contagem = Bench.reduce((acc, cur) => {
        acc[cur.funcao] = (acc[cur.funcao] || 0) + 1;
        return acc;
    }, {});

    if (p.funcao === "MB" && contagem["MB"] >= 6) return false;
    if (p.funcao === "WS" && contagem["WS"] >= 6) return false;
    if (["L",].includes(p.funcao) && contagem[p.funcao] >= 1) return false;

    return true;
}
    function getFirstEmptyBenchSlot() {
  // Procura um slot vazio do banco; se n√£o houver, cria um novo
  const slots = Array.from(document.querySelectorAll(".bench-slot"));
  const empty = slots.find(s => !s.dataset.nome);
  if (empty) return empty;
  if (typeof addBenchSlot === "function") addBenchSlot(); // cria e j√° liga eventos
  const all = Array.from(document.querySelectorAll(".bench-slot"));
  return all[all.length - 1] || null;
}

function showBenchMenuByRole(role) {
  const slot = getFirstEmptyBenchSlot();
  if (!slot) return;

  const scrollMenu = document.getElementById("scrollMenu");
  scrollMenu.innerHTML = '';

  // Filtra por posi√ß√£o + respeita regras do banco
  const disponiveis = characters.filter(p =>
    p.funcao === role &&
    !selecionados.includes(p) &&
    respeitaLimiteBench(p, slot)   // mesma regra usada quando role === "bench"
  );

  if (disponiveis.length === 0) {
    scrollMenu.innerHTML = `<div style="color:#ccc; padding:8px;">No available ${role} for bench.</div>`;
  } else {
    disponiveis.forEach(p => {
      const img = document.createElement('img');
      img.src = p.img;
      img.alt = p.nome;
      img.title = p.nome;
      img.addEventListener('click', (e) => {
        e.stopPropagation();
        setCharacter(slot, p, 'bench');   // adiciona direto ao banco
        scrollMenu.style.display = 'none';
      });
      scrollMenu.appendChild(img);
    });
  }

  scrollMenu.style.display = 'flex';
}
document.querySelectorAll(".bench-quick-btn").forEach(btn => {
  btn.addEventListener("click", (e) => {
    e.stopPropagation();
    showBenchMenuByRole(btn.dataset.role);
  });
});

// √≠ndices dos 6 slots que formam o "anel" (L fica fora, √© fixo no √≠ndice 3)
const RING_IDX = [0, 1, 2, 6, 5, 4]; // [S, MB, WS, OP, MB, WS] na orienta√ß√£o base

// Rotaciona o anel 'steps' vezes no sentido hor√°rio (move conte√∫do e data-role)
function rotateRingClockwise(steps){
  const hexes = [...document.querySelectorAll('.hex')];
  const ring = RING_IDX.map(i => hexes[i]);
  const k = ((steps % 6) + 6) % 6;
  if (k === 0) return;
const ids = ring.map(h => getSlotId(h));
  const eq = ids.map(id => equipState.get(id) || null);
  const eqRot = eq.slice(-k).concat(eq.slice(0, -k));
  ids.forEach((id, idx) => {
    if (eqRot[idx]) equipState.set(id, eqRot[idx]); else equipState.delete(id);
  });
  // 1) Captura estado completo (inclui charName!)
  const state = ring.map(h => ({
    html: h.innerHTML,
    nome: h.dataset.nome || null,
    charName: h.dataset.charName || null,
    role: h.dataset.role || h.getAttribute('data-role') || ''
  }));

  // 2) Roda
  const rotated = state.slice(-k).concat(state.slice(0, -k));

  // 3) Aplica e reanexa handlers/badges
  ring.forEach((h, i) => {
    const st = rotated[i];
    h.innerHTML = st.html;                  // isto remove listeners antigos
    if (st.nome) h.dataset.nome = st.nome; else delete h.dataset.nome;
    h.dataset.role = st.role;
    if (st.charName) h.dataset.charName = st.charName; else delete h.dataset.charName; // **novo**

    // atualiza o label do slot
    const info = h.parentElement.querySelector('.player-info');
    if (info) {
      if (st.nome) {
        const p = (typeof characters !== "undefined") && characters.find(x => x.nome === st.nome);
        info.textContent = p ? `${st.nome} - ${p.funcao}` : st.nome;
      } else {
        info.textContent = st.role;
      }
    }
    
    // **importante**: recriar o bot√£o ‚öôÔ∏è com listener e a badge
    removeItemGear(h);
    ensureItemGear(h);
    updateItemBadge(h);
    emitTeamChanged();
  });
}

// Ajusta a orienta√ß√£o do grid para coincidir com o time salvo
function orientGridToSavedTeam(team) {
  // pega a fun√ß√£o (S/MB/WS/OP/L) em cada √≠ndice salvo
  const funcaoEm = (idx) => {
    const nome = team.main[idx];
    if (!nome) return null;
    const p = characters.find(x => x.nome === nome);
    return p ? p.funcao : null;
  };

  // Tentamos ancorar por S; se n√£o existir, ancoramos por OP
  const idxS = RING_IDX.find(i => funcaoEm(i) === 'S');
  if (idxS !== undefined) {
    const posNoAnel = RING_IDX.indexOf(idxS); // onde o S est√°
    // na base, S est√° em RING_IDX[0] -> steps = pos atual
    rotateRingClockwise(posNoAnel);
    return;
  }
  const idxOP = RING_IDX.find(i => funcaoEm(i) === 'OP');
  if (idxOP !== undefined) {
    const posNoAnel = RING_IDX.indexOf(idxOP);
    // na base, OP est√° em RING_IDX[3] -> passos = pos atual - 3
    rotateRingClockwise((posNoAnel - 3 + 6) % 6);
  }
}

    
function setCharacter(slot, personagem, role) {
    // se j√° tinha algu√©m nesse slot, remove dos selecionados
    if (slot.dataset.nome) {
        selecionados = selecionados.filter(p => p.nome !== slot.dataset.nome);
    }

    // monta imagem
   slot.innerHTML = `<img src="${personagem.img}" alt="${personagem.nome}">`;
slot.dataset.nome = personagem.nome;
slot.dataset.role = role;

    afterAssignCharacter(slot, personagem.nome);

    // atualiza texto de info (procura .player-info no mesmo player-slot)
    const infoDiv = slot.parentElement.querySelector('.player-info');
    if (infoDiv) infoDiv.textContent = `${personagem.nome} - ${personagem.funcao}`;

    selecionados.push(personagem);
    updateSynergies();
}

function removeCharacter(slot) {
  if (slot.dataset.nome) {
    selecionados = selecionados.filter(p => p.nome !== slot.dataset.nome);

    // CHAME O HOOK ANTES de limpar o slot
    if (typeof window.afterRemoveCharacter === "function") {
      window.afterRemoveCharacter(slot);
    }

    slot.innerHTML = "";
    delete slot.dataset.nome;

    const infoDiv = slot.parentElement.querySelector('.player-info');
    if (slot.classList.contains("bench-slot")) {
      infoDiv.textContent = "Banco";
    } else {
      infoDiv.textContent = slot.dataset.role
        || slot.getAttribute("data-role")
        || slot.parentElement.querySelector('.hex')?.dataset.role || "";
    }

    updateSynergies();
    if (typeof afterRemoveCharacter === "function") afterRemoveCharacter(slot);
  }
}

function updateSynergies() {
    const synergyListEl = document.getElementById("synergy-list");
    synergyListEl.innerHTML = "";

    // === CONFIG: which bonds need 3 to activate ===
    // Put the EXACT vinculo names here (case-sensitive).
    const bondsRequire3 = new Set([
      "Nata√ß√£o",  
     "Cabe√ßa dos G√™meos",
     "Cultural Festival",
     "F√©rias de Inverno",
    ]);

    const DEFAULT_BOND_MIN = 2; // all bonds default to 2 unless listed above
    const SCHOOL_MIN = 4;       // school synergy rule stays the same

    const SchoolsCount = {};
    const vinculosCount = {};

    // --- Count Schools (starters only) ---
    document.querySelectorAll(".hex").forEach(slot => {
        if (slot.dataset.nome) {
            const p = characters.find(x => x.nome === slot.dataset.nome);
            if (!p) return;
            SchoolsCount[p.School] = (SchoolsCount[p.School] || 0) + 1;
        }
    });

    // --- Count Bonds (starters + bench) ---
    document.querySelectorAll(".hex, .bench-slot").forEach(slot => {
        if (slot.dataset.nome) {
            const p = characters.find(x => x.nome === slot.dataset.nome);
            if (!p) return;

            if (Array.isArray(p.vinculo)) {
                p.vinculo.forEach(v => {
                    vinculosCount[v] = (vinculosCount[v] || 0) + 1;
                });
            } else if (p.vinculo) {
                vinculosCount[p.vinculo] = (vinculosCount[p.vinculo] || 0) + 1;
            }
        }
    });

    let algumaSinergia = false;

    // --- School synergies (>= 4) ---
    for (const school in SchoolsCount) {
        if (SchoolsCount[school] >= SCHOOL_MIN) {
            synergyListEl.innerHTML += `
                <li>
                    <button class="bond-btn school-btn" data-school="${school}">
                        School: ${school}
                    </button>
                </li>
            `;
            algumaSinergia = true;
        }
    }

    // --- Bond synergies (>= per-bond threshold) ---
    for (const vinculo in vinculosCount) {
        const required = bondsRequire3.has(vinculo) ? 3 : DEFAULT_BOND_MIN;
        if (vinculosCount[vinculo] >= required) {
            synergyListEl.innerHTML += `
                <li>
                    <button class="bond-btn synergy-btn" data-bond="${vinculo}">
                        ${vinculo}
                    </button>
                </li>
            `;
            algumaSinergia = true;
        }
    }

    // === Click: School ===
    document.querySelectorAll(".school-btn").forEach(btn => {
        btn.addEventListener("click", (e) => {
            e.stopPropagation();
            const schoolName = btn.dataset.school;

            const relacionados = characters.filter(pers => pers.School === schoolName);

            sidebarContent.innerHTML = `
                <h3>School: ${schoolName}</h3>
                <p>${descricoesSinergia[schoolName] || "Sem descri√ß√£o dispon√≠vel"}</p>
                <div class="char-list">
                    ${relacionados.map(r => `
                        <div class="char-card" data-nome="${r.nome}">
                            <img src="${r.img}" alt="${r.nome}">
                            <p>${r.nome}</p>
                        </div>
                    `).join('')}
                </div>
                <button id="backToSynergies" class="bond-btn">‚Üê Voltar</button>
            `;

            sidebar.classList.add("open");
            menuBtn.style.display = "none";

            document.getElementById("backToSynergies").addEventListener("click", (e) => {
                e.stopPropagation();
                updateSynergies();
                sidebar.classList.add("open");
                menuBtn.style.display = "none";
            });

            sidebarContent.querySelectorAll(".char-card").forEach(card => {
                card.addEventListener("click", (e) => {
                    e.stopPropagation();
                    const nome = card.dataset.nome;
                    const personagem = characters.find(x => x.nome === nome);
                    showCharacterDetails(personagem);
                    sidebar.classList.add("open");
                    menuBtn.style.display = "none";
                });
            });
        });
    });

    // === Click: Bond ===
    document.querySelectorAll(".synergy-btn").forEach(btn => {
        btn.addEventListener("click", (e) => {
            e.stopPropagation();
            const bondName = btn.dataset.bond;

            const relacionados = characters.filter(pers => {
                if (Array.isArray(pers.vinculo)) return pers.vinculo.includes(bondName);
                return pers.vinculo === bondName;
            });

            sidebarContent.innerHTML = `
                <h3>V√≠nculo: ${bondName}</h3>
                <p>${descricoesSinergia[bondName] || "Sem descri√ß√£o dispon√≠vel"}</p>
                <div class="char-list">
                    ${relacionados.map(r => `
                        <div class="char-card" data-nome="${r.nome}">
                            <img src="${r.img}" alt="${r.nome}">
                            <p>${r.nome}</p>
                        </div>
                    `).join('')}
                </div>
                <button id="backToSynergies" class="bond-btn">‚Üê Voltar</button>
            `;

            sidebar.classList.add("open");
            menuBtn.style.display = "none";

            document.getElementById("backToSynergies").addEventListener("click", (e) => {
                e.stopPropagation();
                updateSynergies();
                sidebar.classList.add("open");
                menuBtn.style.display = "none";
            });

            sidebarContent.querySelectorAll(".char-card").forEach(card => {
                card.addEventListener("click", (e) => {
                    e.stopPropagation();
                    const nome = card.dataset.nome;
                    const personagem = characters.find(x => x.nome === nome);
                    showCharacterDetails(personagem);
                    sidebar.classList.add("open");
                    menuBtn.style.display = "none";
                });
            });
        });
    });

    if (!algumaSinergia) {
        synergyListEl.innerHTML = "<li>Apenas vinculos de posicionamento ser√£o mostrados.Elas apenas funcionam quando os membros dela ent√£o em quadra. Para ver as demais clique em 'Stats bonds'.</li>";
    }
    // --- Tipo do time (apenas titulares) ---
(function renderTeamType(){
  function symbolToType(sym){
    const s = String(sym||"").toLowerCase();
    if (s.includes("quicksymbol"))   return "quick";
    if (s.includes("powersymbol"))   return "power";
    if (s.includes("receivesymbol")) return "receive";
    if (s.includes("blocksymbol"))   return "block";
    return null;
  }

  const TYPE_DEFAULT_MIN = 4;
  const typeCounts = {};

  // conta tipos s√≥ dos titulares (.hex)
  document.querySelectorAll(".hex").forEach(slot => {
    const nome = slot.dataset?.nome;
    if (!nome) return;
    const p = characters.find(x => x.nome === nome);
    if (!p) return;
    const syms = Array.isArray(p.symbols) ? p.symbols : [];
    const types = new Set(syms.map(symbolToType).filter(Boolean));
    types.forEach(t => { typeCounts[t] = (typeCounts[t] || 0) + 1; });
  });

  // vencedores entre os ativados
  let top = []; let topCount = 0;
  for (const [t, c] of Object.entries(typeCounts)) {
    const min = (t === "receive") ? 5 : TYPE_DEFAULT_MIN;
    if (c >= min) {
      if (c > topCount) { top = [t]; topCount = c; }
      else if (c === topCount) top.push(t);
    }
  }

  // garante cabe√ßalho flex ao redor do t√≠tulo "Synergies"
  const box = synergyListEl?.parentElement || document; // container da lista
  let title = box.querySelector('h2');
  if (!title) return;

  let header = title.closest('.synergy-header');
  if (!header){
    header = document.createElement('div');
    header.className = 'synergy-header';
    title.replaceWith(header);
    header.appendChild(title);
  }

  // cria/atualiza a badge ao lado do t√≠tulo
  let badge = header.querySelector('.team-type-badge');
  if (!badge){
    badge = document.createElement('span');
    badge.className = 'team-type-badge';
    header.appendChild(badge);
  }

  if (top.length){
    const label = {
      quick:"Quick Attack", power:"Power Attack", receive:"Receive", block:"Block"
    };
    const names = top.map(t => label[t] || t).join(" ou ");
    badge.textContent = `Team type: ${names} (${topCount})`;
  } else {
    badge.textContent = ''; // nada ativado, n√£o mostra texto
  }
})();
}
// ====== Eventos iniciais (grid principal com detec√ß√£o de duplo clique) ======
document.querySelectorAll(".hex").forEach(slot => {
  // Timer por slot para distinguir clique simples x duplo clique
  slot.__clickTimer = null;

  slot.addEventListener("click", (e) => {
    e.stopPropagation();

    // Se j√° existe um timer, este clique √© o 2¬∫ -> trata como duplo clique
    if (slot.__clickTimer) {
      clearTimeout(slot.__clickTimer);
      slot.__clickTimer = null;

      // ‚è© Duplo clique: abrir detalhes (se houver personagem nesse slot)
      const nome = slot.dataset.nome;
      if (!nome) return; // slot vazio
      const p = (typeof characters !== "undefined") && characters.find(x => x.nome === nome);
      if (!p) return;

      // fecha o menu, se estiver aberto
      const sm = document.getElementById("scrollMenu");
      if (sm) sm.style.display = "none";

      // mostra detalhes no painel lateral
      if (typeof showCharacterDetails === "function") {
        showCharacterDetails(p);
      }
      // garante que o painel lateral fique aberto (se voc√™ usa esses ids)
      const sidebar = document.getElementById("sidebar");
      const menuBtn = document.getElementById("menuBtn");
      if (sidebar) sidebar.classList.add("open");
      if (menuBtn) menuBtn.style.display = "none";

      return;
    }

    // 1¬∫ clique: arma o timer; se n√£o houver 2¬∫ clique, abre o menu
    slot.__clickTimer = setTimeout(() => {
      slot.__clickTimer = null;
      // ‚úÖ Clique simples (sem 2¬∫ clique): abre o menu de sele√ß√£o
      if (typeof showMenu === "function") {
        showMenu(slot.dataset.role, slot);
      }
    }, 250); // janela para detectar duplo clique
  });

  // Bot√£o direito: remover personagem (igual antes)
  slot.addEventListener("contextmenu", (e) => {
    e.preventDefault();
    if (typeof removeCharacter === "function") removeCharacter(slot);
  });
});

document.querySelectorAll(".bench-slot").forEach(slot => attachBenchEvents(slot));

/* ====== SIDEBAR NAV ====== */
const sidebarContent = document.getElementById("sidebar-content");
document.querySelectorAll(".menu-link").forEach(btn => {
  btn.addEventListener("click", (e) => {
    e.stopPropagation();
    const section = btn.dataset.section;
    if (section === "characters") {
      showCharacterList();
    } else if (section === "schools") {
      showSchoolsList();             
    } else if (section === "save") {
      showSavedTeams();
    } else if (section === "help") {
    sidebarContent.innerHTML = `
        <h3>Info</h3>
        <div style="display:flex; flex-direction:column; gap:10px;">
            <button id="faqBtn" class="bond-btn">üìÑ FAQ</button>
            <button id="creditsBtn" class="bond-btn">üë• Credits</button>
            <button id="patchBtn" class="bond-btn">üîÑ Patch</button>
        </div>
    `;

    // Bot√£o FAQ
    document.getElementById("faqBtn").addEventListener("click", (e) => {
        e.stopPropagation();
        sidebarContent.innerHTML = `
            <h3>FAQ</h3>
            <p>Player bonds work if one is benched?</p>
            <p>It doesn't, only gonna be applied in game when the bond players are in court</p>
            <p>"X" bond doesn't show, why?</p>
            <p>This version only shows DEPLOYMENT bonds, since "normal" bonds requirements are just to have the characters on the account, meaning they don't have to be in court to activate</p>
            <p>How can i help with team builderr?</p>
            <p>Contact goN6 on discord, to send ideas, fixes to erros, new information, etc.</p>
            <button id="backToHelp" class="bond-btn">‚Üê Voltar</button>
        `;
        document.getElementById("backToHelp").addEventListener("click", (e) => {
            e.stopPropagation();
            document.querySelector('.menu-link[data-section="help"]').click();
            sidebar.classList.add("open");
            menuBtn.style.display = "none";
        });
    });

    // Bot√£o Credits
    document.getElementById("patchBtn").addEventListener("click", (e) => {
        e.stopPropagation();
        sidebarContent.innerHTML = `
            <h3>Patch notes</h3>
            <p>Patch 1.2.1 Added:</p>
            <p>NO position restriction filter for new JP mechanic</p>
            <p>Shows new "Team Type" mechanic</p>
            <p>Multi teams function</p>
            <p>Patch 1.2 Added:</p>
            <p>Drag/drop players to bench and to starting line up</p>
            <p>Filter players by type (quick/power/etc)</p>
            <p>Team recommendations based on most synergies</p>
            <p>Memory and potential sets on character</p>
            <p>School page with all characters from each school and its buff</p>
            <p>Fixed:</p>
            <p>Some synergies that required 3 players were not being displayed correctly</p>
            <p>Some bench rules were not working correctly, EX: couldnt add more than 2 MB's on bench</p>
            <p>Added:</p>
            <p>Double click opens character details</p>
            <p>Bench filter per positions</p>
            <p>Side menu</p>
            <p>Save and Load teams</p>
            <p>Clear all button</p>
            <p>Filter characters on side menu</p>
            <p>Character Skills description</p>
            <p>Character Stats</p>
            <p>Expected release date</p>
            <button id="backToHelp" class="bond-btn">‚Üê Back</button>
        `;
        document.getElementById("backToHelp").addEventListener("click", (e) => {
            e.stopPropagation();
            document.querySelector('.menu-link[data-section="help"]').click();
            sidebar.classList.add("open");
            menuBtn.style.display = "none";
        });
    });
               // Bot√£o FAQ
    document.getElementById("creditsBtn").addEventListener("click", (e) => {
        e.stopPropagation();
        sidebarContent.innerHTML = `
            <h3>Credits</h3>
            <p>Devoy Aces: goN6 , Kari, Marin, Kaito</p>
            <p>Tradu√ß√£o para ingl√™s by KRILL group https://discord.gg/EEBqSKvAsp</p>
            <button id="backToHelp" class="bond-btn">‚Üê Voltar</button>
            
        `;
        document.getElementById("backToHelp").addEventListener("click", (e) => {
            e.stopPropagation();
            document.querySelector('.menu-link[data-section="help"]').click();
            sidebar.classList.add("open");
            menuBtn.style.display = "none";
        });
    });
}
    });
});

// === Meme Version (acrescenta personagens extras √† lista) ===
window.MEME_VERSION_ON = window.MEME_VERSION_ON || false;

/**
 * Preencha aqui os seus novos personagens.
 * Mant√©m o mesmo shape de "characters": { nome, funcao, School, img, symbols, Stats, data }
 */
window.MEME_CHARACTERS = window.MEME_CHARACTERS || [
  // EXEMPLO:
   {
   nome: "Kagenata Max Power SP",
   funcao: "WS",
   School: "Karasuno",
   img: "img/MEMEkagenata.png",
   symbols: ["img/quicksymbol.png","img/powersymbol.png"],
   Stats: { Serve: 100, Spike: 999, Set: 0, Receive: 123, Block: 45, Save: 67 },
   data: "12/31/25"
  },
    { 
     nome: "Ennoshita SP", 
     funcao: "WS", img: "img/MEMEennoshitaSP.png", 
     School: "Karasuno", vinculo: ["Graduation Ceremony"], 
     Stats:{Serve:1,Spike:1,Set:1,Receive:1,Block:1,Save:1}, 
     habilidades:[
  {nome:"Anchor Receive", descricao:"Performs a receive that nullifies 1 incoming spike or serve (guaranteed once per rally). He will also grant himself a 20% buff on his [Receive] + [Save], lasting 2 rallies."},
  {nome:"Adaptive Spike", descricao:"Performs a spike that scales with [Block] stats of opponent's front row by 20%. He will also have 40% chance to reduce enemy block by 10% for 2 rallies. This percentage will increase to 30% if he scores"},
  {nome:"Unshakable Resolve", descricao:"Whenever an ally receive is not PERFECT, he will gain a stack of [Resolving], each stack grants him 10% [Receive] and [Save]. Maximum 4 stacks."},
  {nome:"Captain‚Äôs Burden", descricao:"Can activate anytime. Removes all allies debuff and grants all allies 20% boost in Attack and Defense Technique. If any ally is below 50% stamina, granting them 30% more. This effect lasts 3 rallies."}
], 
    symbols: [ "img/receivesymbol.png","img/powersymbol.png"] 
    },
    {
   nome: "Atsumu SP",
   funcao: "S",
   School: "Inarizaki", vinculo: ["Freaky Holiday"], 
   img: "img/MEMEatsumusantaSP.png",
   symbols: ["img/quicksymbol.png","img/settersymbol.png"],
   Stats: { Serve: 9999, Spike: 0, Set: 9999, Receive: 0, Block: 0, Save: 0 },
   data: "12/31/25"
  }
];

// Guarda a base original para podermos voltar quando o toggle estiver OFF
window.__BASE_CHARACTERS = window.__BASE_CHARACTERS || characters.slice();

/** Recalcula o array global "characters" de acordo com o toggle */
function syncCharactersWithToggle(){
  const base = window.__BASE_CHARACTERS;
  const out  = base.slice(); // c√≥pia da base

  if (window.MEME_VERSION_ON && Array.isArray(window.MEME_CHARACTERS)) {
    const baseNames = new Set(base.map(p => p?.nome));
    for (const p of window.MEME_CHARACTERS) {
      if (p && !baseNames.has(p.nome)) out.push(p); // s√≥ acrescenta se for NOVO
    }
  }

  // IMPORTANTE: muta o array "characters" sem trocar a refer√™ncia
  characters.splice(0, characters.length, ...out);
}

// Garante que o site j√° comece consistente com o estado do toggle
syncCharactersWithToggle();
updateWinDiamondsBtn(); 
// ---- helpers do menu do grid (scrollMenu) ----
function isGridMenuOpen(){
  const el = document.getElementById('scrollMenu');
  return !!(el && getComputedStyle(el).display !== 'none' && el.childElementCount > 0);
}

function refreshGridMenu(){ // atualiza sem fechar
  const ctx = window.__lastMenuCtx;
  if (!ctx) return;
  // salva o scroll do menu, se existir
  const el = document.getElementById('scrollMenu');
  const keepScroll = el ? el.scrollTop : 0;

  // se o slot ainda est√° no DOM, reabre
  if (document.body.contains(ctx.slot)) {
    showMenu(ctx.role, ctx.slot);
    const el2 = document.getElementById('scrollMenu');
    if (el2) el2.scrollTop = keepScroll; // restaura posi√ß√£o
  }
}

function closeGridMenu(){ // fecha o menu do grid
  const el = document.getElementById('scrollMenu');
  if (!el) return;
  el.innerHTML = '';
  el.style.display = 'none';
}
// ===== WIN 999 DIAMONDS =====
const WIN_URL = "https://docs.google.com/forms/d/e/1FAIpQLSeTFIekmM_fEn_Ch1lv26WLtuCPto_opjiTx8pme180oZk6EQ/viewform";

/** tenta achar o container do grid principal para ancorar a posi√ß√£o do bot√£o */
function __findGridEl(){
  // coloque primeiro os ids/candidatos que existem no seu HTML
  const candidates = [
    '#mainGrid', '#gridContainer', '#court', '#grid', '#pageBuilder',
    '.grid', '.court'
  ];
  for (const sel of candidates){
    const el = document.querySelector(sel);
    if (el) return el;
  }
  return null;
}

/** posiciona o bot√£o √† direita do grid (fallback: canto direito da tela) */
function __positionWinBtn(btn){
  const grid = __findGridEl();
  if (!btn) return;

  if (grid){
    const r = grid.getBoundingClientRect(); // relativo √† viewport
    const left = Math.min(window.innerWidth - 300, r.right + 16);
    const top  = Math.max(16, r.top + 60);
    btn.style.left = left + 'px';
    btn.style.top  = top  + 'px';
    btn.style.right = 'auto';
    btn.style.bottom = 'auto';
  } else {
    // fallback
    btn.style.right = '24px';
    btn.style.top   = '120px';
    btn.style.left = 'auto';
    btn.style.bottom = 'auto';
  }
}

/** cria o bot√£o se n√£o existir e mostra */
function showWinDiamondsBtn(){
  if (document.getElementById('winDiamondsBtn')) {
    const btn = document.getElementById('winDiamondsBtn');
    btn.style.display = 'inline-flex';
    __positionWinBtn(btn);
    return;
  }
  const btn = document.createElement('button');
  btn.id = 'winDiamondsBtn';
  btn.className = 'win-diamonds-btn';
  btn.type = 'button';
  btn.textContent = 'WIN 999 DIAMONDS üíé RULES IN GOOGLE FORM';
  btn.addEventListener('click', () => window.open(WIN_URL, '_blank', 'noopener'));
  document.body.appendChild(btn);
  __positionWinBtn(btn);

  // reposiciona ao redimensionar/rolar
  const reposition = () => __positionWinBtn(btn);
  window.addEventListener('resize', reposition);
  window.addEventListener('scroll', reposition);
}

/** esconde (n√£o remove) */
function hideWinDiamondsBtn(){
  const btn = document.getElementById('winDiamondsBtn');
  if (btn) btn.style.display = 'none';
}

/** decide mostrar/ocultar conforme o toggle */
function updateWinDiamondsBtn(){
  if (window.MEME_VERSION_ON) showWinDiamondsBtn();
  else hideWinDiamondsBtn();
}
// ============================================


/* ====== LISTA / FILTROS DE characters (mantida com stopPropagation nos clicks) ====== */
function showCharacterList() {
    const POOL = characters;

    const funcoes   = [...new Set(POOL.map(p => p.funcao))];
    const escolas   = [...new Set(POOL.map(p => p.School))];
    const StatsKeys = [...new Set(POOL.flatMap(p => Object.keys(p.Stats || {})))];

    function symbolToType(sym){
  const s = String(sym||"").toLowerCase();
  if (s.includes("quicksymbol"))   return "quick";
  if (s.includes("powersymbol"))   return "power";
  if (s.includes("servesymbol"))   return "serve";
  if (s.includes("settersymbol"))  return "setter";
  if (s.includes("receivesymbol")) return "receive";
  if (s.includes("blocksymbol"))   return "block";
  if (s.includes("savesymbol"))    return "save";
  return null;
}

// tipos √∫nicos lendo characters[*].symbols
const allTypes = [...new Set(
  POOL.flatMap(p => (Array.isArray(p.symbols) ? p.symbols : [])
    .map(symbolToType).filter(Boolean))
)].sort();

let html = `
  <h3>Characters</h3>
  <div class="filtros">
    <div>
      <label>Role:</label>
      <select id="filtroFuncao">
        <option value="">All</option>
        ${funcoes.map(f => `<option value="${f}">${f}</option>`).join('')}
      </select>
    </div>
    <div>
      <label>School:</label>
      <select id="filtroEscola">
        <option value="">All</option>
        ${escolas.map(e => `<option value="${e}">${e}</option>`).join('')}
      </select>
    </div>
    <div>
      <label>Stats:</label>
      <select id="filtroStats">
        <option value="">All</option>
        ${StatsKeys.map(s => `<option value="${s}">${s}</option>`).join('')}
      </select>
    </div>
    <div>
      <label>Expected Release Date:</label>
      <select id="filtroDataOrdem" title="Ordenar pela data (ignora quem n√£o tem data)">
        <option value="">Ignorar</option>
        <option value="asc">Ascendente (MM/DD/YY)</option>
        <option value="desc">Descendente (MM/DD/YY)</option>
      </select>
    </div>
    <div>
      <label>Type:</label>
      <div id="filtroType">
        ${allTypes.map(t => `
          <label style="display:inline-flex;align-items:center;gap:6px;margin:2px 8px 2px 0;">
            <input type="checkbox" name="typeFilter" value="${t}"> ${t.toUpperCase()}
          </label>
        `).join("")}
      </div>
    </div>

    <button id="limparFiltros">Limpar</button>
  </div>

  <div class="char-list" id="charList"></div>
`;


    sidebarContent.innerHTML = html;
    const memeTg = document.getElementById('memeToggle');
if (memeTg){
  memeTg.addEventListener('change', (e)=>{
    window.MEME_VERSION_ON = !!e.target.checked;
    syncCharactersWithToggle();   // <-- atualiza o array characters
    showCharacterList();          // <-- reconstr√≥i a UI
    updateWinDiamondsBtn(); 
    // Mant√©m o toggle do topo sincronizado (se existir)
    const top = document.getElementById('memeToggleTop');
    if (top && top.checked !== window.MEME_VERSION_ON) top.checked = window.MEME_VERSION_ON;
  });
}


    const list = document.getElementById('charList');
if (list) list.classList.remove('is-hidden');
    enableCloseOutsideCharList();

    // Helpers de data (MM/DD/YY)
    function parseDateMMDDYY(s) {
        if (typeof s !== "string") return null;
        const m = s.match(/^(\d{2})\/(\d{2})\/(\d{2})$/);
        if (!m) return null;
        const mm = parseInt(m[1], 10), dd = parseInt(m[2], 10), yy = 2000 + parseInt(m[3], 10);
        const d = new Date(yy, mm - 1, dd);
        return Number.isNaN(d.getTime()) ? null : d;
    }
    function hasValidDate(p) {
        return !!parseDateMMDDYY(p?.data);
    }

function getStatsSafe(p, key) {
  const v = p?.Stats?.[key];
  return (typeof v === "number") ? v : "-";
}


   function renderLista() {
  const listaEl   = document.getElementById("charList");
  if (listaEl) listaEl.classList.remove('is-hidden');

  const funcaoSel = (document.getElementById("filtroFuncao").value || "").trim();
  const escolaSel = (document.getElementById("filtroEscola").value || "").trim();
  let   StatsSel = (document.getElementById("filtroStats").value || "").trim();
  const dataOrdem = (document.getElementById("filtroDataOrdem")?.value || "").trim();
  const typeSel = Array.from(
  document.querySelectorAll('#filtroType input[name="typeFilter"]:checked')
).map(el => el.value);
  const typeBox = document.getElementById('filtroType');
if (typeBox) typeBox.addEventListener('change', renderLista);

  function getCharTypes(p){
  const arr = Array.isArray(p?.symbols) ? p.symbols : [];
  const types = new Set(arr.map(symbolToType).filter(Boolean));
  return [...types];
}

  if (StatsSel.toLowerCase() === "todos") StatsSel = "";

  // 1) filtro base
  const BASE = POOL; // usa a pool ativa
let filtrados = BASE.filter(p =>
  (funcaoSel === "" || p.funcao === funcaoSel) &&
  (escolaSel === "" || p.School === escolaSel) &&
  (typeSel.length === 0 || typeSel.every(t => getCharTypes(p).includes(t)))
);


  // 2) ordenar por data quando escolhido (e ignorar sem data)
  if (dataOrdem === "asc" || dataOrdem === "desc") {
    filtrados = filtrados
      .filter(hasValidDate)
      .sort((a, b) => {
        const da = parseDateMMDDYY(a.data);
        const db = parseDateMMDDYY(b.data);
        return dataOrdem === "asc" ? (da - db) : (db - da);
      });
  } else if (StatsSel) {
    // 3) ordenar por Stats quando data est√° em "Ignorar"
    filtrados.sort((a, b) => {
      const bv = (b.Stats && typeof b.Stats[StatsSel] === "number") ? b.Stats[StatsSel] : -Infinity;
      const av = (a.Stats && typeof a.Stats[StatsSel] === "number") ? a.Stats[StatsSel] : -Infinity;
      return bv - av;
    });
  }

  // 4) render (agora em <li>)
  const html = filtrados.map((p, i) => {
    const metaLine =
      (dataOrdem === "asc" || dataOrdem === "desc")
        ? (hasValidDate(p) ? `<div class="card-sub">Expected Release Date: ${p.data}</div>` : "")
        : (StatsSel ? `<div class="card-sub">${StatsSel}: ${getStatsSafe(p, StatsSel)}</div>` : "");

    return `
      <li class="person-card" data-idx="${i}">
        <img src="${p.img}" alt="${p.nome}">
        <div class="card-name">${p.nome}</div>
        ${metaLine}
      </li>
    `;
  }).join("");

  listaEl.innerHTML = html;

  // 5) clique abre detalhes
  listaEl.querySelectorAll(".person-card").forEach(card => {
    card.addEventListener("click", (ev) => {
      ev.stopPropagation();  
      const idx = +card.getAttribute("data-idx");
      const person = filtrados[idx];
      if (person) showCharacterDetails(person);
    });
  });
}

    // listeners dos filtros
document.getElementById("filtroFuncao").addEventListener("change", renderLista);
document.getElementById("filtroEscola").addEventListener("change", renderLista);
document.getElementById("filtroStats").addEventListener("change", renderLista);
document.getElementById("filtroDataOrdem").addEventListener("change", renderLista);


// bot√£o Limpar
document.getElementById("limparFiltros").addEventListener("click", () => {
  document.getElementById("filtroFuncao").value = "";
  document.getElementById("filtroEscola").value = "";
  document.getElementById("filtroStats").value = "";
  document.querySelectorAll('#filtroType input[name="typeFilter"]').forEach(cb => cb.checked = false);
  const selData = document.getElementById("filtroDataOrdem");
  if (selData) selData.value = "";
  renderLista();
});

// ‚¨áÔ∏è AQUI (fora do bot√£o, depois dos listeners)
const listaEl = document.getElementById("charList");
if (listaEl && !listaEl.dataset.stopCloseBound) {
  listaEl.addEventListener("click", (ev) => ev.stopPropagation());
  listaEl.dataset.stopCloseBound = "1";
}

// primeira renderiza√ß√£o
renderLista();
}

function showSchoolsList(){
  const sidebar = document.getElementById("sidebar");
  const menuBtn  = document.getElementById("menuBtn");

  const schools = [...new Set(characters.map(p => p.School))].sort((a,b)=>a.localeCompare(b));

  sidebarContent.innerHTML = `
    <h3>Schools</h3>
    <div style="display:flex; flex-direction:column; gap:8px;">
      ${schools.map(s => `
        <button class="bond-btn school-open" data-school="${s}">
           ${s}
        </button>
      `).join("")}
    </div>
  `;

  // abre e esconde o bot√£o verde
  if (sidebar) sidebar.classList.add("open");
  if (menuBtn) menuBtn.style.display = "none";

  // clique de cada escola abre a p√°gina detalhada
  sidebarContent.querySelectorAll(".school-open").forEach(btn=>{
    btn.addEventListener("click", (e)=>{
      e.stopPropagation();
      showSchoolDetail(btn.dataset.school);
    });
  });
}

// P√°gina de uma escola espec√≠fica: descri√ß√£o + personagens
function showSchoolDetail(schoolName){
  const sidebar = document.getElementById("sidebar");
  const menuBtn  = document.getElementById("menuBtn");

  const relacionados = characters.filter(p => p.School === schoolName);
  const desc = (typeof descricoesSinergia === "object" && descricoesSinergia[schoolName])
             ? descricoesSinergia[schoolName]
             : "No description available.";

  sidebarContent.innerHTML = `
    <h3>School: ${schoolName}</h3>
    <p>${desc}</p>
    <div class="char-list">
      ${relacionados.map(r => `
        <div class="char-card" data-nome="${r.nome}">
          <img src="${r.img}" alt="${r.nome}">
          <p>${r.nome}</p>
        </div>
      `).join("")}
    </div>
    <button id="backToSchools" class="bond-btn">‚Üê Voltar</button>
  `;

  if (sidebar) sidebar.classList.add("open");
  if (menuBtn) menuBtn.style.display = "none";

  // voltar para a lista de Schools
  document.getElementById("backToSchools").addEventListener("click", (e)=>{
    e.stopPropagation();
    showSchoolsList();
  });

  // clicar num personagem abre os detalhes dele (j√° existe showCharacterDetails)
  sidebarContent.querySelectorAll(".char-card").forEach(card=>{
    card.addEventListener("click", (e)=>{
      e.stopPropagation();
      const nome = card.dataset.nome;
      const p = characters.find(x => x.nome === nome);
      if (p && typeof showCharacterDetails === "function") {
        showCharacterDetails(p);
      }
    });
  });
}

function showCharacterDetails(p) {
  // Normalize fields so we can safely render
  const bonds   = Array.isArray(p?.vinculo) ? p.vinculo.filter(Boolean)
                : (p?.vinculo ? [p.vinculo] : []);
  const skills  = Array.isArray(p?.habilidades) ? p.habilidades : [];
  const symbols = Array.isArray(p?.symbols) ? p.symbols : [];
  const Stats  = Array.isArray(p?.Stats) ? p.Stats : [];
 // Stat Bonds que esse personagem participa
  const myStatBonds = Object.entries(window.STATS_BONDS || {})
    .filter(([bondName, map]) => Object.prototype.hasOwnProperty.call(map, p.nome));

  const pillsHtml = myStatBonds.length ? `
    <h4 style="margin-top:12px;">Stat Bonds</h4>
    <div>
      ${myStatBonds.map(([bn])=>`<button class="pill statbond-pill" data-bond="${bn}">${bn}</button>`).join('')}
    </div>
    <div id="statBondDesc" class="subdesc"></div>
  ` : '';

  sidebarContent.innerHTML = `
    <h3>${p.nome}</h3>
    <img src="${p.img}" alt="${p.nome}" style="width:100%;">

    ${symbols.length ? `
      <div class="person-symbols">
        ${symbols.map(sym => `<img src="${sym}" class="symbol-icon">`).join("")}
      </div>` : ""}

    ${p.data ? `<p><b>Expected Release Date:</b> ${p.data}</p>` : ""}
    <p><b>Position:</b> ${p.funcao || "-"}</p>
    <p><b>School:</b> ${p.School || "-"}</p>

    ${bonds.length ? `
      <p><b>Bonds:</b></p>
      <ul>
        ${bonds.map(v => `<li><button class="bond-btn bond-link" data-bond="${v}">${v}</button></li>`).join("")}
      </ul>` : `<p><b>Bonds:</b> <i>None</i></p>`}

    ${skills.length ? `
      <h4>Skills</h4>
      <ul>
        ${skills.map(h => `<li><button class="skill-btn" data-skill="${h.nome}">${h.nome}</button></li>`).join("")}
      </ul>` : ""}

    ${p.descricao ? `<p style="margin-top:8px;">${p.descricao}</p>` : ""}

    ${p.Stats ? `
      <ul>
        <li><b>Serve:</b> ${p.Stats.Serve}</li>
        <li><b>Spike:</b> ${p.Stats.Spike}</li>
        <li><b>Set:</b> ${p.Stats.Set}</li>
        <li><b>Receive:</b> ${p.Stats.Receive}</li>
        <li><b>Block:</b> ${p.Stats.Block}</li>
        <li><b>Save:</b> ${p.Stats.Save}</li>
      </ul>` : ""}

    ${pillsHtml}

    <button id="backToList" class="bond-btn">‚Üê Voltar</button>
  `;

  // Mant√©m aberto etc. (o resto do teu c√≥digo permanece)
  sidebar.classList.add("open"); menuBtn.style.display = "none";

  // Back ‚Üí lista
  document.getElementById("backToList").addEventListener("click", (e) => {
    e.stopPropagation(); showCharacterList();
  });

  // helper: se vier <li> solto, embrulha em <ul>
function formatRevealHTML(desc){
  const s = String(desc || '').trim();
  if(!s) return '<i>Sem descri√ß√£o dispon√≠vel</i>';
  const hasLi = /<li[\s>]/i.test(s);
  const hasUl = /<ul[\s>]/i.test(s);
  if (hasLi && !hasUl) return `<ul>${s}</ul>`;
  return s;
}

// Bonds: abre/fecha a descri√ß√£o logo abaixo do bot√£o (sem trocar de p√°gina)
sidebarContent.querySelectorAll(".bond-link").forEach(btn => {
  btn.addEventListener("click", (e) => {
    e.stopPropagation();

    const bondName = btn.dataset.bond;
    const desc = (typeof descricoesSinergia !== "undefined" && descricoesSinergia[bondName])
      ? descricoesSinergia[bondName]
      : "Sem descri√ß√£o dispon√≠vel";

    // cria/acha a caixinha logo abaixo do bot√£o
    let box = btn.nextElementSibling;
    if (!box || !box.classList.contains("reveal-desc")) {
      box = document.createElement("div");
      box.className = "reveal-desc";
      box.style.display = "none";
      btn.insertAdjacentElement("afterend", box);
    }

    const isOpen = box.style.display !== "none";

    // fecha outras descri√ß√µes abertas (opcional, mas deixa limpo)
    sidebarContent.querySelectorAll(".reveal-desc").forEach(x => {
      if (x !== box) x.style.display = "none";
    });

    if (isOpen) {
      box.style.display = "none";
    } else {
      const relacionados = characters.filter(pers =>
  Array.isArray(pers.vinculo) ? pers.vinculo.includes(bondName)
                              : pers.vinculo === bondName
);

box.innerHTML = `
  <div>${formatRevealHTML(desc)}</div>

  <div class="char-list" style="margin-top:10px;">
    ${relacionados.map(r => `
      <div class="char-card" data-nome="${r.nome}">
        <img src="${r.img}" alt="${r.nome}">
        <p>${r.nome}</p>
      </div>
    `).join("")}
  </div>
`;

// clique nas miniaturas abre detalhes do personagem
box.querySelectorAll(".char-card").forEach(card => {
  card.addEventListener("click", (ev) => {
    ev.stopPropagation();
    const nome = card.dataset.nome;
    const personagem = characters.find(x => x.nome === nome);
    if (personagem) showCharacterDetails(personagem);
  });
});

      box.style.display = "block";
    }
  });
});


  // Clique nas pills de Stat Bonds ‚Üí descreve os participantes + buffs
  sidebarContent.querySelectorAll(".statbond-pill").forEach(btn=>{
    btn.addEventListener("click", ()=>{
      const bondName = btn.dataset.bond;
      const mapping = (window.STATS_BONDS||{})[bondName] || {};
      const html = `
        <b>${bondName}</b>
        <ul>
          ${Object.entries(mapping).map(([nm,buff])=>`
            <li><b>${nm}</b> ‚Äî ${String(buff||'').trim() ? buff : '<em>sem buff</em>'}</li>
          `).join('')}
        </ul>`;
      const box = sidebarContent.querySelector('#statBondDesc');
      if (box) box.innerHTML = html;
    });
  });

  


  // Keep sidebar open
  sidebar.classList.add("open");
  menuBtn.style.display = "none";

  // Back to character list
  document.getElementById("backToList").addEventListener("click", (e) => {
    e.stopPropagation();
    showCharacterList();
  });

  // Open a Bond page
  // helper: se vier <li> solto, embrulha em <ul>
function formatRevealHTML(desc){
  const s = String(desc || '').trim();
  if(!s) return '<i>Sem descri√ß√£o dispon√≠vel</i>';
  const hasLi = /<li[\s>]/i.test(s);
  const hasUl = /<ul[\s>]/i.test(s);
  if (hasLi && !hasUl) return `<ul>${s}</ul>`;
  return s;
}




  // Open a Skill page
  // Skills: abre/fecha a descri√ß√£o logo abaixo do bot√£o (sem trocar de p√°gina)
sidebarContent.querySelectorAll(".skill-btn").forEach(btn => {
  btn.addEventListener("click", (e) => {
    e.stopPropagation();

    const skillName = btn.dataset.skill;
    const habilidade = skills.find(h => h.nome === skillName);
    const desc = habilidade?.descricao || "";

    let box = btn.nextElementSibling;
    if (!box || !box.classList.contains("reveal-desc")) {
      box = document.createElement("div");
      box.className = "reveal-desc";
      box.style.display = "none";
      btn.insertAdjacentElement("afterend", box);
    }

    const isOpen = box.style.display !== "none";

    // fecha outras descri√ß√µes abertas (opcional)
    sidebarContent.querySelectorAll(".reveal-desc").forEach(x => {
      if (x !== box) x.style.display = "none";
    });

    if (isOpen) {
      box.style.display = "none";
    } else {
      box.innerHTML = formatRevealHTML(desc);
      box.style.display = "block";
    }
  });
});

}

/* ====== SALVAR / Load TIMES (localStorage) ====== */

// pega composi√ß√£o atual por NOME do personagem (n√£o por src)
function getCurrentTeamByName() {
    // titulares: procuramos .hex dentro de .player-slot (apenas as hex)
    const mainHexes = Array.from(document.querySelectorAll(".hex"));
    const main = mainHexes.map(h => h.dataset.nome || null);

    // bench: cada .bench-slot
    const benches = Array.from(document.querySelectorAll(".bench-slot"));
    const benchNames = benches.map(b => b.dataset.nome || null);

    return { main, bench: benchNames };
}

const saveTeamBtn = document.getElementById("saveTeamBtn");
saveTeamBtn.addEventListener("click", (e) => {
    e.stopPropagation();
    const teamName = prompt("Type team name:");
    if (!teamName) return;

    let teams = JSON.parse(localStorage.getItem("savedTeams") || "{}");

    if (teams[teamName]) {
        if (!confirm(`Team "${teamName}" is already saved. Do you want to replace?`)) {
            return;
        }
    }

    const savePayload = {
  ...getCurrentTeamByName(),   // { main: [...], bench: [...] }
  items: serializeTeamItems()  // <- memories / potentials por slot
};

teams[teamName] = savePayload;
localStorage.setItem("savedTeams", JSON.stringify(teams));
    alert(`Team "${teamName}" saved!`);

    showSavedTeams();
    sidebar.classList.add("open");
    menuBtn.style.display = "none";
});

    // wrapper: um passo no sentido hor√°rio + housarkeeping
  function rotateMainGridClockwise() {
  rotateRingClockwise(1);           // gira o anel (L fica parado)
  const sm = document.getElementById("scrollMenu");
  if (sm) sm.style.display = "none";
  if (typeof updateSynergies === "function") updateSynergies();
  }
    const rotateBtn = document.getElementById("rotateBtn");
  if (rotateBtn) {
  rotateBtn.addEventListener("click", (e) => {
      e.stopPropagation();
      rotateMainGridClockwise();
    });
  }
/* mostra lista de times salvos no painel lateral */
function showSavedTeams() {
    const teams = JSON.parse(localStorage.getItem("savedTeams") || "{}");
    let html = "<h3>Saved teams</h3>";

    if (Object.keys(teams).length === 0) {
        html += "<p>Sem times salvos</p>";
    } else {
        html += `<div class="saved-list">`;
        for (const [name, team] of Object.entries(teams)) {
            html += `
                <div style="margin-bottom:8px; display:flex; align-items:center; justify-content:space-between;">
                    <div style="text-align:left;">
                        <b>${name}</b>
                    </div>
                    <div>
                        <button class="load-btn" data-name="${name}">Load</button>
                        <button class="del-btn" data-name="${name}">Delete</button>
                    </div>
                </div>
            `;
        }
        html += `</div>`;
    }

    sidebarContent.innerHTML = html;


    document.querySelectorAll(".load-btn").forEach(btn => {
        btn.addEventListener("click", (e) => {
        e.stopPropagation();
        const name = btn.dataset.name;
        loadTeam(name);

        // Atualiza sinergias e mant√©m menu aberto na lista
        updateSynergies();
        sidebar.classList.add("open");
        menuBtn.style.display = "none";
        });
    });

    document.querySelectorAll(".del-btn").forEach(btn => {
        btn.addEventListener("click", (e) => {
            e.stopPropagation();
            const name = btn.dataset.name;
            if (confirm(`Delete team "${name}"?`)) {
                deleteTeam(name);
                showSavedTeams();
            }
        });
    });
}

function deleteTeam(name) {
    let teams = JSON.parse(localStorage.getItem("savedTeams") || "{}");
    delete teams[name];
    localStorage.setItem("savedTeams", JSON.stringify(teams));
}

/* Carrega time ‚Äî monta usando setCharacter... */
function loadTeam(name) {
  equipState.clear();  // evita lixo de items grudado em slots antigos
  const teams = JSON.parse(localStorage.getItem("savedTeams") || "{}");
  const team = teams[name];
  if (!team) return;

  selecionados = [];

  // limpa grid e bench
  document.querySelectorAll(".hex, .bench-slot").forEach(slot => {
    slot.innerHTML = "";
    delete slot.dataset.nome;
    const infoDiv = slot.parentElement.querySelector('.player-info');
    if (infoDiv) {
      if (slot.classList.contains("bench-slot")) infoDiv.textContent = "Banco"; // ou "Bench"
      else infoDiv.textContent = slot.dataset.role || slot.getAttribute("data-role") || "";
    }
  });

  // üîß NOVO: alinhar orienta√ß√£o do grid ao time salvo
  orientGridToSavedTeam(team);

  // agora preenche titulares nos √≠ndices do time salvo
  const hexes = Array.from(document.querySelectorAll(".hex"));
  team.main.forEach((nome, i) => {
    if (!nome) return;
    const personagem = characters.find(p => p.nome === nome);
    if (personagem && hexes[i]) {
      setCharacter(hexes[i], personagem, hexes[i].dataset.role || hexes[i].getAttribute("data-role"));
    }
  });

    const benches = Array.from(document.querySelectorAll(".bench-slot"));
    team.bench.forEach((nome, i) => {
        if (!nome) return;
        const personagem = characters.find(p => p.nome === nome);
        if (personagem && benches[i]) {
            setCharacter(benches[i], personagem, 'bench');
            attachBenchEvents(benches[i]);
        }
    });

    equipState.clear();                 // (garante que nada antigo fique no Map)
    restoreTeamItems(team.items);       // <- aplica memories/potentials
    updateSynergies();
}

/* ====== ABRIR / FECHAR MENU ====== */
const menuBtn = document.getElementById("menuBtn");
const sidebar = document.getElementById("sidebar");
const closeSidebar = document.getElementById("closeSidebar");

menuBtn.addEventListener("click", (e) => {
    e.stopPropagation();
    sidebar.classList.add("open");
    menuBtn.style.display = "none";
});

closeSidebar.addEventListener("click", (e) => {
    e.stopPropagation();
    sidebar.classList.remove("open");
    menuBtn.style.display = "block";
});

// Fecha se clicar fora do painel (ignora se clicar dentro)
document.addEventListener("click", (e) => {
    // Clique dentro do sidebar ou no bot√£o de abrir ‚Üí n√£o fecha
    if (sidebar.contains(e.target) || e.target === menuBtn) {
        return;
    }

    // Clique num personagem ‚Üí n√£o fecha
   if (e.target.closest(".char-card, .person-card, #charList")) {
  return;
}

    // Clique em bot√µes de voltar (FAQ, Credits, Synergies, Detalhes) ‚Üí n√£o fecha
    if (
        e.target.closest("#backToHelp") ||
        e.target.closest("#backToSynergies") ||
        e.target.closest("#backToChar")
    ) {
        return;
    }
    if (
  e.target.closest('#pageRanking') ||
  e.target.closest('#btnOpenRanking') ||
  e.target.closest('#btnRank7d') ||
  e.target.closest('#btnRankAll') ||
  e.target.closest('#btnRankChars')
) {
  return;
}
    // Fecha apenas se realmente foi fora
    if (sidebar.classList.contains("open")) {
        sidebar.classList.remove("open");
        menuBtn.style.display = "block";
    }
});
    // === util: fechar o Side Menu (usa os mesmos seletores que voc√™ j√° usa) ===
function closeSideMenu() {
  const sidebar = document.getElementById('sidebar') || document.querySelector('#sidebar, .sidebar');
  const menuBtn = document.getElementById('menuBtn') || document.querySelector('#menuBtn, .menuBtn');

  if (!sidebar) return;
  // Remove a classe que indica aberto
  sidebar.classList.remove('open');

  // Reexibe o bot√£o de abrir (mesma l√≥gica que voc√™ j√° usa)
  if (menuBtn) menuBtn.style.display = 'block';
}

// (opcional) exp√µe no escopo global pra outros m√≥dulos
window.closeSideMenu = closeSideMenu;

    // Bot√£o para limpar todo o time e resetar o banco
    document.getElementById("clearTeamBtn").addEventListener("click", (e) => {
    e.stopPropagation();
    if (!confirm("Are you sure you want to reset court and bench?")) return;

    // Fecha o Side Menu se estiver aberto
    sidebar.classList.remove("open");
    menuBtn.style.display = "block";

    // Limpa sele√ß√£o
    selecionados = [];
    equipState.clear();
    document.querySelectorAll('.hex, .bench-slot')
   .forEach(el => el.querySelectorAll('.item-badge,.item-gear').forEach(n => n.remove()));

    clearAllEquips();
    document.querySelectorAll('.hex, .bench-slot').forEach(el => {
    if (el.dataset.nome || el.dataset.charName) removeCharacter(el);
});
    // Reseta todos os slots principais
    document.querySelectorAll(".hex").forEach(slot => {
        slot.innerHTML = "";
        delete slot.dataset.nome;
        const infoDiv = slot.parentElement.querySelector('.player-info');
        infoDiv.textContent = slot.dataset.role || slot.getAttribute("data-role") || "";
    });

    // Reseta banco para 3 slots
    const benchRow = document.getElementById("bench-row");
    benchRow.querySelectorAll(".player-slot.bench").forEach((benchSlot, index) => {
        if (index >= 3) {
            benchSlot.remove();
        } else {
            const slot = benchSlot.querySelector(".bench-slot");
            slot.innerHTML = "";
            delete slot.dataset.nome;
            const infoDiv = benchSlot.querySelector('.player-info');
            infoDiv.textContent = "Banco";
        }
    });
    updateSynergies();
    });
    /* ===================== ITEMS: Memory + Potential (4p/2p) ===================== */

/** Estat keys do seu dataset */
const STAT_KEYS = ["Serve","Spike","Set","Receive","Block","Save"];

/** Estado por slot: { memoryId, set4, set2 } */
const equipState = new Map();

/** Utils de slot */
function getSlotId(el){
  if(!el.dataset.slotId){
    const prefix = el.classList.contains('bench-slot') ? 'bench' : 'court';
    const all = [...document.querySelectorAll('.hex, .bench-slot')];
    const idx = all.indexOf(el);
    el.dataset.slotId = `${prefix}-${idx >= 0 ? idx : Math.random().toString(36).slice(2,8)}`;
  }
  return el.dataset.slotId;
}
function getSlotChar(el){ return el?.dataset?.charName || null; }
function findCharacterByName(name){ return characters.find(c => c.nome === name) || null; }

/** Aplicadores de b√¥nus */
function applyBonus(twoPiece, bonus){
  if(!bonus) return;
  for(const [stat, mod] of Object.entries(bonus)){
    if(twoPiece[stat] == null) continue;
    if(mod.pct)  twoPiece[stat] = Math.round(twoPiece[stat]*(1+mod.pct/100));
    if(mod.flat) twoPiece[stat] = Math.max(0, twoPiece[stat]+mod.flat);
  }
}
function computeEffectiveStats(baseStats, memoryId, set4Id, set2Id){
  const out = { ...baseStats};
  // Memory
  if(memoryId){
    const mem = memoryCatalog.find(m=>m.id===memoryId);
    if(mem) applyBonus(out, mem.bonus);
  }
  // Potential (sets)
  if(set2Id){
    const s2 = setCatalog.find(s=>s.id===set2Id);
    if(s2) applyBonus(out, s2.twoPiece);
  }
  if(set4Id){
    const s4 = setCatalog.find(s=>s.id===set4Id);
    if(s4){
      // comportamento comum: 4p tamb√©m concede o 2p do mesmo set
      if(!set2Id || set2Id===set4Id) applyBonus(out, s4.twoPiece);
      applyBonus(out, s4.fourPiece);
    }
  }
  return out;
}


// normaliza fun√ß√£o (role) do personagem para os c√≥digos do cat√°logo
function normalizeRole(role){
  const r = String(role||"").toLowerCase();
  if (["s","setter","levantador"].includes(r)) return "S";
  if (["mb","middle","middle blocker","central","meio"].includes(r)) return "MB";
  if (["ws","wing","wing spiker","ponteiro","ponta"].includes(r)) return "WS";
  if (["op","opposite","oposto"].includes(r)) return "OP";
  if (["l","libero","l√≠bero","libero"].includes(r)) return "L";
  return role || "WS"; // fallback
}

// pega % de um b√¥nus {pct} dado um stat
function pctOf(obj, key){
  return (obj && obj[key] && typeof obj[key].pct === "number") ? obj[key].pct : 0;
}

// normaliza nomes p/ casar personagem com mem√≥ria
function norm(s){
  return (s||"").toLowerCase()
    .normalize('NFD').replace(/[\u0300-\u036f]/g,'') // sem acento
    .replace(/[^\p{L}\p{N}]+/gu,' ')                 // sem pontua√ß√£o
    .trim();
}
function recommendMemoryForCharacter(ch, allowedMem){
  if (!allowedMem || allowedMem.length === 0) return null;
  const cname = norm(ch.nome || ch.name);

  // 1) owner expl√≠cito (se voc√™ usa esse campo)
  let cand = allowedMem.find(m => m.owner && norm(m.owner) === cname);
  if (cand) return cand.id;

  // 2) nome/id cont√©m o nome do personagem (ex.: "Ushijima UR")
  cand = allowedMem.find(m => norm(m.name).includes(cname) || norm(m.id).includes(cname.replace(/\s+/g,'_')));
  if (cand) return cand.id;

  // 3) todos os tokens do nome do personagem aparecem no nome da mem√≥ria
  const tokens = cname.split(' ').filter(Boolean);
  cand = allowedMem.find(m => tokens.every(t => norm(m.name).includes(t)));
  if (cand) return cand.id;

  // 4) fallback: primeira compat√≠vel
  return allowedMem[0]?.id || null;
}


function topStatKey(stats){
  let bestK=null, bestV=-Infinity;
  for(const k of STAT_KEYS){
    const v = typeof stats?.[k] === "number" ? stats[k] : -Infinity;
    if (v > bestV){ bestV=v; bestK=k; }
  }
  return bestK;
}

function totalPctForCombo(set4, set2, statKey){
  let total = 0;
  if (set4){
    // 4p concede 2p do mesmo set quando n√£o h√° 2p selecionado ou quando √© o mesmo set
    if ((!set2 || set2.id === set4.id) && set4.twoPiece) total += pctOf(set4.twoPiece, statKey);
    if (set4.fourPiece) total += pctOf(set4.fourPiece, statKey);
  }
  if (set2 && (!set4 || set2.id !== set4.id) && set2.twoPiece){
    total += pctOf(set2.twoPiece, statKey);
  }
  return total;
}

// util: pega % de um b√¥nus para um stat
function pctOf(obj, key){
  return (obj && obj[key] && typeof obj[key].pct === 'number') ? obj[key].pct : 0;
}
// util: qual o Mayr stat base do personagem
function topStatKey(stats){
  let bestK=null, bestV=-Infinity;
  for(const k of STAT_KEYS){
    const v = typeof stats?.[k] === "number" ? stats[k] : -Infinity;
    if (v > bestV){ bestV=v; bestK=k; }
  }
  return bestK;
}

function recommendSetsByTopStat(ch, allowedSet){
  if (!allowedSet || allowedSet.length === 0) return { set4:null, set2:null };

  // helpers locais
  const findSetIdByName = (arr, name) => {
    const n = (name||"").toLowerCase();
    const hit = arr.find(s =>
      (s.name && s.name.toLowerCase() === n) ||
      (s.id   && s.id.toLowerCase()   === n)
    );
    return hit ? hit.id : null;
  };
  const hasSymbol = (sym) => Array.isArray(ch.symbols) && ch.symbols.includes(sym);

  // escolhe o melhor 4p e 2p para um stat (mant√©m a sua regra anterior)
  const bestByStat = (statKey) => {
    let best4 = null, best4Score = -Infinity;
    for (const s4 of allowedSet){
      const score = pctOf(s4.twoPiece, statKey) + pctOf(s4.fourPiece, statKey);
      if (score > best4Score){ best4Score = score; best4 = s4; }
    }
    let best2 = null, best2Score = -Infinity;
    for (const s2 of allowedSet){
      if (best4 && s2.id === best4.id) continue;      // 2p diferente do 4p
      const score = pctOf(s2.twoPiece, statKey);
      if (score > best2Score){ best2Score = score; best2 = s2; }
    }
    return { set4: best4?.id || null, set2: best2?.id || null };
  };

  const role = normalizeRole(ch.funcao); // j√° existe no seu c√≥digo
  const top  = topStatKey(ch.Stats || {}); // j√° existe no seu c√≥digo

  // --- Regra 1: Setters (S) t√™m recomenda√ß√£o fixa
  if (role === 'S'){ // Ex.: √© montado a partir de ch.funcao na abertura do modal
    const s4 = findSetIdByName(allowedSet, 'Precise Set');
    const s2 = findSetIdByName(allowedSet, 'Precise Serve');
    return { set4: s4, set2: (s2 && s2 !== s4) ? s2 : null };
  }

  // --- Regra 3: Mayr atributo = Spike -> s√≠mbolos "quick" ou "power"
  if (top === 'Spike'){
    if (hasSymbol('img/quicksymbol.png')){
      const s4 = findSetIdByName(allowedSet, 'Rapid Quick Attack');
      const s2 = findSetIdByName(allowedSet, 'Sharp Sense');
      if (s4 || s2) return { set4: s4, set2: (s2 && s2 !== s4) ? s2 : null };
      // se n√£o achar pelos nomes (cat√°logo diferente), cai no fallback
    }
    if (hasSymbol('img/powersymbol.png')){
      const s4 = findSetIdByName(allowedSet, 'Power Vibe');
      const s2 = findSetIdByName(allowedSet, 'Power Rise');
      if (s4 || s2) return { set4: s4, set2: (s2 && s2 !== s4) ? s2 : null };
    }
  }

  // --- Regra 2 (fallback): como antes, escolher pelo Mayr atributo
  return bestByStat(top || 'Spike'); // se n√£o houver top claro, Spike como padr√£o
}

// helper p/ gerar HTML de um √≠cone com etiqueta opcional
function badgeIconHTML(src, title, tagText){
  if(!src) return "";
  return `
    <span class="ico" title="${title || ""}">
      <img src="${src}" alt="">
      ${tagText ? `<span class="tag">${tagText}</span>` : ""}
    </span>`;
}

function updateItemBadge(slotEl){
  // remove a badge anterior
  slotEl.querySelectorAll('.item-badge').forEach(n=>n.remove());

  // n√£o mostra badge se o slot estiver vazio
  if(!slotEl.dataset.charName) return;

  const slotId = getSlotId(slotEl);
  const eq = equipState.get(slotId);
  if(!eq) return;

  const mem = eq.memoryId ? memoryCatalog.find(m=>m.id===eq.memoryId) : null;
  const s4  = eq.set4      ? setCatalog.find(s=>s.id===eq.set4)       : null;
  const s2  = eq.set2      ? setCatalog.find(s=>s.id===eq.set2)       : null;

  if(!mem && !s4 && !s2) return;

  const badge = document.createElement('div');
  badge.className = 'item-badge';

  // √çCONES (sem texto). Etiqueta pequena: "M", "4", "2" (remova se n√£o quiser nada)
  const parts = [];
  if(mem) parts.push(badgeIconHTML(mem.img,  `Memory: ${mem.name}`,          "M"));
  if(s4)  parts.push(badgeIconHTML(s4.img,   `Potential 4-Piece: ${s4.name}`, "4"));
  if(s2)  parts.push(badgeIconHTML(s2.img,   `Potential 2-Piece: ${s2.name}`, "2"));

  badge.innerHTML = parts.join("");
  slotEl.appendChild(badge);
}

/** Bot√£o ‚öôÔ∏è para abrir o modal (n√£o conflita com seu dblclick de Details) */
function ensureItemGear(slotEl){
  if(slotEl.querySelector('.item-gear')) return;
  if(!slotEl.dataset.charName) return;
  const btn = document.createElement('button');
  btn.type = 'button';
  btn.className = 'item-gear';
  btn.title = 'Items (Memory + Potential)';
  btn.innerHTML = '‚öôÔ∏è';
  btn.addEventListener('click', (e)=>{ e.stopPropagation(); e.preventDefault(); openItemModal(slotEl); });
  slotEl.appendChild(btn);
}
function removeItemGear(slotEl){ slotEl.querySelectorAll('.item-gear').forEach(n=>n.remove()); }

/** MODAL com Memory + Potential (4p/2p) */
function openItemModal(slotEl){
  const charName = getSlotChar(slotEl);
  if(!charName){ alert('Coloque um personagem no slot antes de equipar.'); return; }
  const ch = findCharacterByName(charName);
  if(!ch){ alert('Personagem n√£o encontrado.'); return; }

  const slotId = getSlotId(slotEl);
  const current = equipState.get(slotId) || { memoryId:null, set4:null, set2:null };

  const role = normalizeRole(ch.funcao);
const allowedMem = memoryCatalog.filter(m => m.positions?.includes(role));
const allowedSet = setCatalog.filter(s => !s.positions || s.positions.includes(role));

  const $back = document.createElement('div'); $back.className = 'item-modal-backdrop';
  const $box  = document.createElement('div'); $box.className  = 'item-modal';
  $back.appendChild($box);

  $box.innerHTML = `
  <h3>Items for <b>${ch.nome}</b> (${ch.funcao})</h3>

   <div class="items-3col">
    <div class="row-3col">
      <div class="label">Memory</div>
      <img id="memThumb" class="big-thumb" src="" alt="">
      <div>
        <select id="memSel" class="select-wide">
          <option value="">‚Äî none ‚Äî</option>
          ${allowedMem.map(m=>`<option value="${m.id}" ${m.id===current.memoryId?'selected':''}>${m.name}</option>`).join('')}
        </select>
        <div id="memDesc" class="subdesc"></div>
      </div>
    </div>

    <div class="row-3col">
      <div class="label">4-Piece</div>
      <img id="set4Thumb" class="big-thumb" src="" alt="">
      <div>
        <select id="set4Sel" class="select-wide">
          <option value="">‚Äî none ‚Äî</option>
          ${allowedSet.map(s=>`<option value="${s.id}" ${s.id===current.set4?'selected':''}>${s.name}</option>`).join('')}
        </select>
        <div id="set4Desc" class="subdesc"></div>
      </div>
    </div>

    <div class="row-3col">
      <div class="label">2-Piece</div>
      <img id="set2Thumb" class="big-thumb" src="" alt="">
      <div>
        <select id="set2Sel" class="select-wide">
          <option value="">‚Äî none ‚Äî</option>
          ${allowedSet.map(s=>`<option value="${s.id}" ${s.id===current.set2?'selected':''}>${s.name}</option>`).join('')}
        </select>
        <div id="set2Desc" class="subdesc"></div>
      </div>
    </div>

    <div class="row-3col">
      <div class="label">Stats</div>
      <div></div>
      <div><ul id="statsList" class="stats-list"></ul></div>
    </div>
  </div>

  <div class="item-actions">
    <button class="item-btn" id="btnRec">Recommend</button>
    <button class="item-btn" id="btnClear">Clear</button>
    <button class="item-btn" id="btnSave">Save</button>
    <button class="item-btn" id="btnClose">Close</button>
  </div>
`;
  document.body.appendChild($back);

  const $mem  = $box.querySelector('#memSel');
  const $mD   = $box.querySelector('#memDesc');
  const $set4 = $box.querySelector('#set4Sel');
  const $set2 = $box.querySelector('#set2Sel');
  const $d4   = $box.querySelector('#set4Desc');
  const $d2   = $box.querySelector('#set2Desc');
  const $statsList = $box.querySelector('#statsList');
  const $memThumb  = $box.querySelector('#memThumb');
  const $set4Thumb = $box.querySelector('#set4Thumb');
  const $set2Thumb = $box.querySelector('#set2Thumb');

  function getSetBonusPct(statKey){
  let total = 0;
  const s4 = setCatalog.find(s => s.id === $set4.value);
  const s2 = setCatalog.find(s => s.id === $set2.value);

  if (s4){
    if (s4.twoPiece && s4.twoPiece[statKey] && typeof s4.twoPiece[statKey].pct === "number")
      total += s4.twoPiece[statKey].pct;   // 2p ‚Äúembutido‚Äù no 4p
    if (s4.fourPiece && s4.fourPiece[statKey] && typeof s4.fourPiece[statKey].pct === "number")
      total += s4.fourPiece[statKey].pct;  // 4p
  }
  // s√≥ soma 2p diferente do 4p
  if (s2 && (!s4 || s2.id !== s4.id)){
    if (s2.twoPiece && s2.twoPiece[statKey] && typeof s2.twoPiece[statKey].pct === "number")
      total += s2.twoPiece[statKey].pct;
  }
  return total;
}

  function refreshThumbs(){
  const mem = memoryCatalog.find(m=>m.id===$mem.value);
  const s4  = setCatalog.find(s=>s.id===$set4.value);
  const s2  = setCatalog.find(s=>s.id===$set2.value);
  $memThumb.src  = mem?.img  || "";
  $set4Thumb.src = s4?.img   || "";
  $set2Thumb.src = s2?.img   || "";
}

  function renderChoice($el, item, fallbackTitle){
  if(item){
    $el.classList.remove('empty');
    $el.querySelector('img').src = item.img || "";
    $el.querySelector('.title').textContent = item.name;
    $el.querySelector('.subtitle').textContent = item.short || ""; // opcional
  }else{
    $el.classList.add('empty');
    $el.querySelector('img').src = "";
    $el.querySelector('.title').textContent = fallbackTitle || "‚Äî none ‚Äî";
    $el.querySelector('.subtitle').textContent = "";
  }
}

function refreshChoices(){
  const mem = memoryCatalog.find(m=>m.id===$mem.value);
  const s4  = setCatalog.find(s=>s.id===$set4.value);
  const s2  = setCatalog.find(s=>s.id===$set2.value);
  renderChoice($box.querySelector('#memChoice'),  mem, "‚Äî none ‚Äî");
  renderChoice($box.querySelector('#set4Choice'), s4,  "‚Äî none ‚Äî");
  renderChoice($box.querySelector('#set2Choice'), s2,  "‚Äî none ‚Äî");
}
  function updateSetLocks(){
  const v4 = $set4.value, v2 = $set2.value;
  [...$set2.options].forEach(o => o.disabled = !!v4 && o.value === v4 && o.value !== "");
  [...$set4.options].forEach(o => o.disabled = !!v2 && o.value === v2 && o.value !== "");
}
$set4.addEventListener('change', ()=>{ updateSetLocks(); refreshDescs(); renderStats(); });
$set2.addEventListener('change', ()=>{ updateSetLocks(); refreshDescs(); renderStats(); });
updateSetLocks();

  function refreshDescs(){
  const mem = memoryCatalog.find(m=>m.id===$mem.value);
  const s4  = setCatalog.find(s=>s.id===$set4.value);
  const s2  = setCatalog.find(s=>s.id===$set2.value);
  $mD.textContent = mem ? (mem.desc || '') : '';
  $d4.textContent = s4 ? (s4.desc4 || '') : '';
  $d2.textContent = s2 ? (s2.desc2 || '') : '';
  refreshThumbs();
}
// Retorna quanto a Memory soma EM PONTOS para um stat espec√≠fico
function getMemoryBonusAbs(statKey){
  const mem = memoryCatalog.find(m=>m.id===$mem.value);
  if(!mem || !mem.bonus || !mem.bonus[statKey]) return 0;
  const base = ch.Stats[statKey] || 0;
  const mod  = mem.bonus[statKey];
  const pct  = mod.pct ? Math.round(base * (mod.pct/100)) : 0;
  const flat = mod.flat ? mod.flat : 0;
  return pct + flat; // valor absoluto adicionado pela mem√≥ria
}

// Retorna o TOTAL de % dos sets (2p/4p) efetivamente aplicados para o stat
function getSetBonusPct(statKey){
  let total = 0;

  const s4 = setCatalog.find(s=>s.id===$set4.value);
  const s2 = setCatalog.find(s=>s.id===$set2.value);

  // 4p selecionado: normalmente concede o 2p do mesmo set se o 2p n√£o estiver escolhido
  if(s4){
    // aplica 2p do 4p quando N√ÉO h√° set2 OU quando set2 √© o mesmo set
    if((!s2 || s2.id === s4.id) && s4.twoPiece && s4.twoPiece[statKey]?.pct){
      total += s4.twoPiece[statKey].pct;
    }
    // aplica 4p
    if(s4.fourPiece && s4.fourPiece[statKey]?.pct){
      total += s4.fourPiece[statKey].pct;
    }
  }

  // 2p de um set diferente do 4p
  if(s2 && (!s4 || s2.id !== s4.id)){
    if(s2.twoPiece && s2.twoPiece[statKey]?.pct){
      total += s2.twoPiece[statKey].pct;
    }
  }

  return total; // s√≥ porcentagem
}

  // helper para considerar 0, 0.0, null etc.
function zeroish(x){ return !x || Math.abs(x) < 1e-6; }

function renderStats(){
  const rows = STAT_KEYS.map((k)=>{
    const base   = ch.Stats[k] || 0;
    const memAbs = getMemoryBonusAbs(k);   // pontos absolutos da Memory
    const setPct = getSetBonusPct(k);      // % total dos sets para esse stat

    const parts = [String(base)];
    if (!zeroish(memAbs)) parts.push(`+ ${memAbs}`);
    if (!zeroish(setPct)) parts.push(`+ ${setPct}%`); // s√≥ mostra se > 0%

    return `<li><b>${k}:</b> ${parts.join(' ')}</li>`;
  }).join('');
  $statsList.innerHTML = rows;
}

  $mem.addEventListener('change', ()=>{ refreshDescs(); renderStats(); });
  $set4.addEventListener('change', ()=>{ updateSetLocks(); refreshDescs(); renderStats(); });
  $set2.addEventListener('change', ()=>{ updateSetLocks(); refreshDescs(); renderStats(); });
  updateSetLocks();refreshDescs(); renderStats();

  $box.querySelector('#btnClose').onclick = ()=> $back.remove();
  $box.querySelector('#btnClear').onclick = ()=>{
    $mem.value=""; $set4.value=""; $set2.value="";
    refreshDescs(); renderStats();
  };
  $box.querySelector('#btnSave').onclick = ()=>{
    const data = { memoryId: $mem.value || null, set4: $set4.value || null, set2: $set2.value || null };
    equipState.set(slotId, data);
    updateItemBadge(slotEl);
    $back.remove();
  };
  $box.querySelector('#btnRec').onclick = ()=>{
  const memId = recommendMemoryForCharacter(ch, allowedMem);
  const rec   = recommendSetsByTopStat(ch, allowedSet);

  if (memId) $mem.value = memId;
  if (rec.set4) $set4.value = rec.set4;
  $set2.value = rec.set2 || "";           // sempre tenta diferente; se n√£o houver, fica vazio

  updateSetLocks();                        // mant√©m 4p/2p mutuamente exclusivos na UI
  refreshDescs();
  renderStats();
};
}

/** Hooks para seu fluxo atual */
window.afterAssignCharacter = function(slotEl, charName){
  slotEl.dataset.charName = charName;
  updateItemBadge(slotEl);
  ensureItemGear(slotEl); // bot√£o ‚öôÔ∏è para abrir o modal (n√£o conflita com dblclick de detalhes)
};
window.afterRemoveCharacter = function(slotEl){
  delete slotEl.dataset.charName;   // mant√©m compatibilidade com suas badges
  clearSlotEquip(slotEl);           // <- limpa Map + badges/engrenagem
  updateItemBadge(slotEl);          // defensivo (como j√° faz no assign)
};

// Guarda por slot, mas tamb√©m salva o nome do char para restaurar por nome
function serializeTeamItems(){
  const data = {};
  document.querySelectorAll('.hex, .bench-slot').forEach(el=>{
    const id = getSlotId(el);
    const charName = el.dataset.charName || el.dataset.nome || null;
    if (!charName) return;
    const eq = equipState.get(id) || { memoryId:null, set4:null, set2:null };
    data[id] = { charName, ...eq };
  });
  return data;
}

// Ao carregar: 1) limpa tudo; 2) tenta aplicar itens pelo NOME do char.
// Se n√£o achar o nome no grid atual, cai no slot salvo (fallback).
function restoreTeamItems(saved){
  clearAllEquips();
  if (!saved) return;

  const allSlots = Array.from(document.querySelectorAll('.hex, .bench-slot'));

  // mapa r√°pido: nome -> slot atual
  const byName = new Map();
  allSlots.forEach(el=>{
    const n = el.dataset.charName || el.dataset.nome || null;
    if (n) byName.set(n, el);
  });

  for (const [slotId, payload] of Object.entries(saved)){
    const target =
      byName.get(payload.charName) ||
      allSlots.find(e => getSlotId(e) === slotId);

    if (!target) continue;

    const id = getSlotId(target);
    equipState.set(id, {
      memoryId: payload.memoryId || null,
      set4:     payload.set4     || null,
      set2:     payload.set2     || null
    });
    updateItemBadge(target);
    ensureItemGear(target);
  }
}
// ========= DRAG & DROP (compat√≠vel com sua estrutura) =========
(function(){
  if (window.__dndFix) return; window.__dndFix = true;

  const getChar = n => characters.find(c => c.nome === n);
  let dragCtx = null; // {type:'character'|'slot', nome?, id?}
  const IS_MOBILE =
  (window.matchMedia && matchMedia('(pointer: coarse)').matches) ||
  (window.matchMedia && matchMedia('(hover: none)').matches);



  function setDragCtx(obj, e){
    dragCtx = obj;
    try { e.dataTransfer.setData('application/json', JSON.stringify(obj)); } catch(_) {}
    try { e.dataTransfer.setData('text/plain', JSON.stringify(obj)); } catch(_) {}
    e.dataTransfer.effectAllowed = (obj.type === 'slot') ? 'move' : 'copyMove';
  }
  function isAllowedForStarterSlot(slotRole, charRole) {
  if (!slotRole || slotRole === 'bench') return true; // n√£o √© starter
  if (slotRole === 'L') return charRole === 'L';
  return charRole !== 'L';
}

  function canDropCharOn(slot, p){
  const isBench = slot.classList.contains('bench-slot');
  if (isBench) return respeitaLimiteBench(p, slot);

  const role = (slot.dataset.role || slot.getAttribute('data-role') || '').toUpperCase();
  if (role === 'L') return p.funcao === 'L';  // L√≠bero s√≥ no L
  return p.funcao !== 'L';                    // demais titulares: qualquer N√ÉO-L
}

  function dropCharacterOn(slot, p) {
  // zera items pendurados nesse slot (√© um overwrite vindo do menu)
  equipState.delete(getSlotId(slot));

  const isBench = slot.classList.contains('bench-slot');
  const role = isBench ? 'bench' : (slot.dataset.role || slot.getAttribute('data-role'));
  setCharacter(slot, p, role);

  const sm = document.getElementById("scrollMenu");
  if (sm) sm.style.display = "none";
}
 // Helper: pega o personagem de um slot (titular ou banco)
function getCharacterFromSlot(el){
  if (!el) return null;
  const n = el.dataset?.nome || el.dataset?.charName || null;
  return n ? (characters.find(c => c.nome === n) || null) : null;
}

  // Troca/move entre slots (qualquer posi√ß√£o entre si, exceto L s√≥ em L)
function moveBetweenSlots(srcEl, dstEl){
  if (!srcEl || !dstEl || srcEl === dstEl) return;

  const pSrc = getCharacterFromSlot(srcEl);
  const pDst = getCharacterFromSlot(dstEl);
  if (!pSrc && !pDst) return;   // nada para fazer
  if (!pSrc) return;            // origem vazia (arraste inv√°lido)

  const srcIsBench = srcEl.classList.contains('bench-slot');
  const dstIsBench = dstEl.classList.contains('bench-slot');

  const srcRole = ((srcEl.dataset.role || srcEl.getAttribute('data-role') || '') + '').toUpperCase();
  const dstRole = ((dstEl.dataset.role || dstEl.getAttribute('data-role') || '') + '').toUpperCase();

  // Regras dos titulares: L s√≥ em L; demais titulares: qualquer N√ÉO-L
  function allowedForStarter(slotRole, charRole){
    if (!slotRole || slotRole === 'BENCH') return true;
    if (slotRole === 'L') return charRole === 'L';
    return charRole !== 'L';
  }

  // 1) Validar destino para pSrc
  if (dstIsBench) {
    if (!respeitaLimiteBench(pSrc, dstEl)) return;
  } else {
    if (!allowedForStarter(dstRole, pSrc.funcao)) return;
  }

  // 2) Se houver pDst (swap), validar ‚Äúvolta‚Äù para pDst
  if (pDst){
    if (srcIsBench) {
      if (!respeitaLimiteBench(pDst, srcEl)) return;
    } else {
      if (!allowedForStarter(srcRole, pDst.funcao)) return;
    }
  }

  // --- Itens (equipState): preparar ids e estados
  const srcId = getSlotId(srcEl);
  const dstId = getSlotId(dstEl);
  const srcEq = equipState.get(srcId) || null;
  const dstEq = equipState.get(dstId) || null;

  const srcKeepRole = srcIsBench ? 'bench' : srcRole;
  const dstKeepRole = dstIsBench ? 'bench' : dstRole;

  if (pDst){
    // SWAP: troca itens tamb√©m
    if (srcEq) equipState.set(dstId, srcEq); else equipState.delete(dstId);
    if (dstEq) equipState.set(srcId, dstEq); else equipState.delete(srcId);

    removeCharacter(srcEl);
    removeCharacter(dstEl);
    setCharacter(srcEl, pDst, srcKeepRole);
    setCharacter(dstEl, pSrc, dstKeepRole);
  } else {
    // MOVE: leva itens juntos
    const keep = srcEq ? { ...srcEq } : null;
    equipState.delete(srcId);
    if (keep) equipState.set(dstId, keep);

    removeCharacter(srcEl);
    setCharacter(dstEl, pSrc, dstKeepRole);
  }

  // Atualiza badges/engrenagem (seu fluxo atual)
  if (typeof updateItemBadge === 'function') { updateItemBadge(srcEl); updateItemBadge(dstEl); }
  if (typeof ensureItemGear   === 'function') { ensureItemGear(srcEl); ensureItemGear(dstEl); }
}

    function ensureMobileRemoveBtn(slot){
    if (!IS_MOBILE) return;

    let btn = slot.querySelector('.mob-rm');
    if (!btn){
      btn = document.createElement('button');
      btn.type = 'button';
      btn.className = 'mob-rm';
      btn.textContent = '‚úï';
      btn.addEventListener('click', (e)=>{
        e.preventDefault();
        e.stopPropagation();
        if (typeof removeCharacter === 'function') removeCharacter(slot);
      });
      slot.appendChild(btn);
    }
    btn.style.display = slot.dataset.nome ? 'block' : 'none';
  }

  function bindMobileDoubleTapOpenMenu(slot){
  if (!(window.matchMedia && matchMedia('(pointer: coarse)').matches)) return;

  let lastTap = 0;
  let lastId = '';

  slot.addEventListener('pointerup', (e)=>{
    if (e.pointerType !== 'touch' && e.pointerType !== 'pen') return;

    // n√£o disparar quando clicar no X
    if (e.target && e.target.closest && e.target.closest('.mob-rm')) return;

    const now = Date.now();
    const id = (slot.id || '') + '|' + (slot.dataset.slot || '') + '|' + (slot.dataset.pos || '');

    // 2 taps r√°pidos no mesmo slot
    if (now - lastTap < 300 && id === lastId) {
      e.preventDefault();
      e.stopPropagation();

      // ‚úÖ chama o mesmo fluxo do PC (voc√™ j√° tem isso no dblclick)
      // se voc√™ tiver uma fun√ß√£o espec√≠fica, troque aqui:
      if (typeof openSideMenuForSlot === 'function') {
        openSideMenuForSlot(slot);
      } else {
        // fallback: simula seu comportamento atual de abrir menu
        // (ajuste para o nome da sua fun√ß√£o real)
        if (typeof openSideMenu === 'function') openSideMenu(slot);
      }

      lastTap = 0;
      lastId = '';
      return;
    }

    lastTap = now;
    lastId = id;
  }, {capture:true});
}


  function decorateDropTarget(slot){
    slot.addEventListener('dragover', (e)=>{
      // permita o drop SEM depender de getData()
      e.preventDefault();
      const ctx = dragCtx;
      let ok = false;
      if (ctx?.type === 'character'){
        const p = getChar(ctx.nome);
        ok = !!p && canDropCharOn(slot, p);
      } else if (ctx?.type === 'slot'){
        const srcEl = Array.from(document.querySelectorAll('.hex, .bench-slot')).find(el => getSlotId(el) === ctx.id);
        const p = srcEl?.dataset.nome ? getChar(srcEl.dataset.nome) : null;
        ok = !!p && (slot === srcEl || canDropCharOn(slot, p));
      }
      slot.classList.toggle('drop-ok', ok);
      slot.classList.toggle('drop-bad', ctx && !ok);
    });

    slot.addEventListener('dragleave', ()=> slot.classList.remove('drop-ok','drop-bad'));

    slot.addEventListener('drop', (e)=>{
      e.preventDefault();
      slot.classList.remove('drop-ok','drop-bad');
      const ctx = dragCtx; dragCtx = null; // consome o contexto

      if (!ctx) return;
      if (ctx.type === 'character'){
        const p = getChar(ctx.nome);
        if (p && canDropCharOn(slot, p)) dropCharacterOn(slot, p);
      } else if (ctx.type === 'slot'){
        const srcEl = Array.from(document.querySelectorAll('.hex, .bench-slot')).find(el => getSlotId(el) === ctx.id);
        if (srcEl) moveBetweenSlots(srcEl, slot);
      }
    });

    // habilita arrastar a partir do slot quando tiver personagem
    const refresh = ()=> slot.setAttribute('draggable', slot.dataset.nome ? 'true' : 'false');
    refresh();
    ensureMobileRemoveBtn(slot);
    
    slot.addEventListener('dragstart', (e)=>{
      if (!slot.dataset.nome) return;
      setDragCtx({ type:'slot', id:getSlotId(slot), nome:slot.dataset.nome }, e);
    });

    // atualiza o draggable quando setar/remover
const oldAssign = window.afterAssignCharacter;
window.afterAssignCharacter = function(el, name){
  if (typeof oldAssign === 'function') oldAssign(el, name);
  if (el === slot){
    slot.setAttribute('draggable', 'true');
    ensureMobileRemoveBtn(slot); // ‚úÖ item B
  }
};

const oldRemove = window.afterRemoveCharacter;
window.afterRemoveCharacter = function(el){
  if (typeof oldRemove === 'function') oldRemove(el);
  if (el === slot){
    slot.setAttribute('draggable', 'false');
    ensureMobileRemoveBtn(slot); // ‚úÖ item C
  }
};

    
  }

  function decorateAll(){ document.querySelectorAll('.hex, .bench-slot').forEach(decorateDropTarget); }

    function initMobileHoldDrag(){
  if (window.__mobHoldDrag) return;
  window.__mobHoldDrag = true;

  const IS_MOBILE =
  (window.matchMedia && matchMedia('(pointer: coarse)').matches) ||
  (window.matchMedia && matchMedia('(hover: none)').matches);

  if (!IS_MOBILE) return;

  let src = null;
  let holdT = null;
  let active = false;
  let lastOver = null;

  const HOLD_MS = 220;
  const MOVE_TOL = 8;
  let sx=0, sy=0;

  const clearOver = ()=>{
    if (lastOver) lastOver.classList.remove("drop-ok","drop-bad");
    lastOver = null;
  };

  const clearAll = ()=>{
    if (src) src.classList.remove("mob-pick");
    src = null;
    active = false;
    if (holdT){ clearTimeout(holdT); holdT = null; }
    clearOver();
  };

  document.addEventListener("pointerdown", (e)=>{
    if (e.pointerType !== "touch" && e.pointerType !== "pen") return;

    const slot = e.target.closest(".hex, .bench-slot");
    if (!slot || !slot.dataset.nome) return;

    sx = e.clientX; sy = e.clientY;

    holdT = setTimeout(()=>{
      src = slot;
      active = true;
      src.classList.add("mob-pick");
      // evita ‚Äúsegurar‚Äù abrir menus/sele√ß√£o
      try{ src.setPointerCapture(e.pointerId); }catch(_){}
    }, HOLD_MS);
  }, {capture:true, passive:true});

  document.addEventListener("pointermove", (e)=>{
    if (!holdT && !active) return;

    // se ainda n√£o ativou, cancela se o dedo andou muito
    if (!active && holdT){
      if (Math.abs(e.clientX - sx) > MOVE_TOL || Math.abs(e.clientY - sy) > MOVE_TOL){
        clearTimeout(holdT); holdT = null;
      }
      return;
    }

    if (!active || !src) return;

    // enquanto arrasta: detecta slot abaixo do dedo e mostra feedback
    const el = document.elementFromPoint(e.clientX, e.clientY);
    const dst = el ? el.closest(".hex, .bench-slot") : null;

    clearOver();

    if (dst){
      const pSrc = (typeof getChar === "function") ? getChar(src.dataset.nome) : null;
      const ok = !!pSrc && (dst === src || (typeof canDropCharOn === "function" && canDropCharOn(dst, pSrc)));
      dst.classList.toggle("drop-ok", ok);
      dst.classList.toggle("drop-bad", !ok);
      lastOver = dst;
    }
  }, {capture:true, passive:true});

  document.addEventListener("pointerup", (e)=>{
    if (holdT){ clearTimeout(holdT); holdT = null; }

    if (!active || !src) { clearAll(); return; }

    const el = document.elementFromPoint(e.clientX, e.clientY);
    const dst = el ? el.closest(".hex, .bench-slot") : null;

    if (dst && dst !== src){
      try { moveBetweenSlots(src, dst); } catch(_) {}
    }

    clearAll();
  }, {capture:true, passive:true});

  document.addEventListener("pointercancel", clearAll, {capture:true, passive:true});
}


  function initDnd(){
    // 1) Fontes: **#charList** (lista do menu lateral)
    const list = document.getElementById('charList');
    if (list){
      list.addEventListener('dragstart', (e)=>{
        const img = e.target.closest('img'); if (!img) return;
        const nome = img.alt || img.title;
        if (getChar(nome)) { img.setAttribute('draggable','true'); setDragCtx({type:'character', nome}, e); }
      });
      list.querySelectorAll('img').forEach(img => img.setAttribute('draggable','true'));
    }

    // 2) Fontes: #scrollMenu (seu menu flutuante por posi√ß√£o)
    const sm = document.getElementById('scrollMenu');
    if (sm){
      sm.addEventListener('dragstart', (e)=>{
        const img = e.target.closest('img'); if (!img) return;
        const nome = img.alt || img.title;
        if (getChar(nome)) { img.setAttribute('draggable','true'); setDragCtx({type:'character', nome}, e); }
      });
      sm.querySelectorAll('img').forEach(img => img.setAttribute('draggable','true'));
    }

    // 3) Alvos e fontes: quadra + banco
    decorateAll();
    initMobileHoldDrag();
    // redecorar ap√≥s rotacionar (se voc√™ rotaciona os hex com innerHTML)
    if (typeof window.rotateRingClockwise === 'function' && !window.__dndWrapRot){
      const old = window.rotateRingClockwise;
      window.rotateRingClockwise = function(){
        const r = old.apply(this, arguments);
        try { RING_IDX.map(i => document.querySelectorAll('.hex')[i]).forEach(decorateDropTarget); }
        catch(_) { decorateAll(); }
        return r;
      };
      window.__dndWrapRot = true;
    }

    // redecorar ap√≥s adicionar novo slot de bench
    if (typeof window.addBenchSlot === 'function' && !window.__dndWrapAdd){
      const old = window.addBenchSlot;
      window.addBenchSlot = function(){
        const r = old.apply(this, arguments);
        const last = Array.from(document.querySelectorAll('.bench-slot')).pop();
        if (last) decorateDropTarget(last);
        return r;
      };
      window.__dndWrapAdd = true;
    }
  }

  (function bootOnce(){
  function start(){
    if (!window.__dndInited){ window.__dndInited = true; initDnd(); }
    if (!window.__mtInited){ window.__mtInited = true; initMultiTeams(); }
    if (!window.__recoInited){ window.__recoInited = true; bindRecommendControls(); }
  }
  if (document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', start);
  } else {
    start();
  }
})();

})();
/***********************
 * MOBILE: bloquear long-press (contextmenu)
 ***********************/
document.addEventListener(
  "contextmenu",
  (e) => {
    const isMobile =
      (window.matchMedia && matchMedia("(pointer: coarse)").matches) ||
      navigator.maxTouchPoints > 0;

    if (!isMobile) return;

    // se o long-press foi em slot do grid ou bench, bloqueia
    if (e.target && e.target.closest && e.target.closest(".hex, .bench-slot")) {
      e.preventDefault();
      e.stopPropagation();
    }
  },
  { capture: true }
);

// === fechar #charList ao clicar fora / ESC, ligado sob demanda ===
(function(){
  let off = null; // guard para remover handlers antigos

  function enableCloseOutsideCharList(){
  if (off) { off(); off = null; }

  const list = document.getElementById('charList');
  if (!list) return;

  const onDown = (e) => {
    // ‚úÖ qualquer clique dentro do sidebar (filtros + lista) N√ÉO fecha
    if (e.target.closest('#sidebar-content')) return;

    // cliques no link que abre Characters tamb√©m n√£o fecham
    if (e.target.closest("[data-section='characters'], [data-open-charlist]")) return;

    // ‚ùå clique realmente fora => fecha
    list.classList.add('is-hidden');
    cleanup();
  };

    const onEsc = (e)=>{
      if (e.key === "Escape") {
        list.classList.add('is-hidden');
        cleanup();
      }
    };

    function cleanup(){
      document.removeEventListener('pointerdown', onDown, true);
      document.removeEventListener('keydown', onEsc);
      off = null;
    }

    document.addEventListener('pointerdown', onDown, true); // captura cedo
    document.addEventListener('keydown', onEsc);

    // fornece um ‚Äúdesligar‚Äù externo para quando trocar de se√ß√£o
    off = cleanup;
  }

  // deixa acess√≠vel para chamar ao montar a se√ß√£o
  window.enableCloseOutsideCharList = enableCloseOutsideCharList;
})();

function clearSlotEquip(slotEl){
  const id = getSlotId(slotEl);
  equipState.delete(id);
  slotEl.querySelectorAll('.item-badge,.item-gear').forEach(n=>n.remove());
}

function clearAllEquips(){
  equipState.clear();
  document.querySelectorAll('.hex, .bench-slot')
    .forEach(el => el.querySelectorAll('.item-badge,.item-gear').forEach(n=>n.remove()));
}

// mover o ‚Äúequip‚Äù junto com o personagem (A -> B), trocando se B j√° tiver algo
function transferEquipState(fromEl, toEl){
  const a = getSlotId(fromEl);
  const b = getSlotId(toEl);
  const aEq = equipState.get(a) || null;
  const bEq = equipState.get(b) || null;

  if (aEq == null && bEq == null) return;

  // se B j√° tem algu√©m, trocamos; se B estava vazio, apenas movemos
  if (bEq != null && aEq != null){
    equipState.set(a, bEq);
    equipState.set(b, aEq);
  } else if (aEq != null){
    equipState.delete(a);
    equipState.set(b, aEq);
  } else { // bEq != null
    equipState.set(a, bEq);
    equipState.delete(b);
  }

  updateItemBadge(fromEl);
  updateItemBadge(toEl);
}
// ===== Recommend: preenche os slots vazios maximizando sinergias =====

// Soma total dos Stats do personagem
function sumStats(p){
  const S = p.Stats || {};
  let total = 0;
  for (const k in S) total += (S[k] || 0);
  return total;
}

// Coleta nomes atuais (starters e bench)
function getCurrentTeamNames(){
  const main = [...document.querySelectorAll('.hex')]
    .map(s => s.dataset.nome).filter(Boolean);
  const bench = [...document.querySelectorAll('.bench-slot')]
    .map(s => s.dataset.nome).filter(Boolean);
  return { main, bench };
}

// Quais slots de titulares est√£o vazios
function getEmptyStarterSlots(){
  return [...document.querySelectorAll('.hex')].filter(s => !s.dataset.nome);
}

// === √çndices de sinergias (constru√≠dos 1x) ===
let BOND_INDEX = null;    // { bondName -> Set(nomes) }
let SCHOOL_INDEX = null;  // { schoolName -> Set(nomes) }

function buildSynergyIndices(){
  if (BOND_INDEX && SCHOOL_INDEX) return;
  BOND_INDEX = {};
  SCHOOL_INDEX = {};

  for (const p of characters){
    // Schools
    if (p.School){
      if (!SCHOOL_INDEX[p.School]) SCHOOL_INDEX[p.School] = new Set();
      SCHOOL_INDEX[p.School].add(p.nome);
    }
    // Bonds (vinculo pode ser string ou array)
    const vs = Array.isArray(p.vinculo) ? p.vinculo : (p.vinculo ? [p.vinculo] : []);
    for (const v of vs){
      if (!BOND_INDEX[v]) BOND_INDEX[v] = new Set();
      BOND_INDEX[v].add(p.nome);
    }
  }
}

// Conta quantas sinergias ativas (Schools + Bonds) do time final
// incluem ao menos 1 dos titulares que j√° estavam no grid (√¢ncora).
function anchoredSynergyScore(activeSchools, activeBonds, oldMainSet){
  let score = 0;

  // Schools: se a school ativa tem pelo menos 1 membro j√° presente no grid original
  for (const sch of activeSchools){
    const members = SCHOOL_INDEX[sch];
    if (!members) continue;
    for (const name of members){
      if (oldMainSet.has(name)){
        score++;
        break;
      }
    }
  }
  // Bonds: se o bond ativo tem pelo menos 1 participante que j√° estava no grid original
  for (const bond of activeBonds){
    const members = BOND_INDEX[bond];
    if (!members) continue;
    for (const name of members){
      if (oldMainSet.has(name)){
        score++;
        break;
      }
    }
  }
  return score;
}

// Conta quantas sinergias ficariam ativas com os nomes passados
// (mesma regra do updateSynergies: Schools=starter-only com 4+, Bonds=starter+bench com 2+, exceto algumas que pedem 3)
function computeActivatedSynergyCount(mainNames, benchNames){
  // Mesmas exce√ß√µes do seu painel
  const bondsRequire3 = new Set(["Nata√ß√£o","Cabe√ßa dos G√™meos"]);  // idem ao updateSynergies
  const DEFAULT_BOND_MIN = 2;
  const SCHOOL_MIN = 4;

  const SchoolsCount = {};
  const vinculosCount = {};

  // Contagem de School: s√≥ starters
  for (const nome of mainNames){
    const p = characters.find(x => x.nome === nome);
    if (!p) continue;
    SchoolsCount[p.School] = (SchoolsCount[p.School] || 0) + 1;
  }

  // Contagem de Bonds: starters + bench
  const allForBonds = [...mainNames, ...benchNames];
  for (const nome of allForBonds){
    const p = characters.find(x => x.nome === nome);
    if (!p) continue;
    const vs = Array.isArray(p.vinculo) ? p.vinculo : (p.vinculo ? [p.vinculo] : []);
    for (const v of vs){
      vinculosCount[v] = (vinculosCount[v] || 0) + 1;
    }
  }

  let count = 0;
  const activeSchools = new Set();
  const activeBonds = new Set();

  // Schools
  for (const school in SchoolsCount){
    if (SchoolsCount[school] >= SCHOOL_MIN){
      count++;
      activeSchools.add(school);
    }
  }
  // Bonds
  for (const v in vinculosCount){
    const required = bondsRequire3.has(v) ? 3 : DEFAULT_BOND_MIN;
    if (vinculosCount[v] >= required){
      count++;
      activeBonds.add(v);
    }
  }

  return { count, activeSchools, activeBonds };
}

// Gera todas as combina√ß√µes escolhendo 1 candidato por slot (sem repetir nomes)
function* cartesianByIndex(lists){
  // lists: array de arrays (candidatos por slot)
  const idx = lists.map(()=>0);
  const lens = lists.map(l=>l.length);
  if (lens.some(len => len===0)) return;

  while (true){
    // combina√ß√£o atual
    const combo = lists.map((l,i)=>l[idx[i]]);
    // valida duplicados de nomes
    const names = new Set(combo.map(c=>c.nome));
    if (names.size === combo.length) yield combo;

    // pr√≥ximo √≠ndice (od√¥metro)
    let k = lists.length - 1;
    while (k >= 0){
      idx[k]++;
      if (idx[k] < lens[k]) break;
      idx[k] = 0;
      k--;
    }
    if (k < 0) break;
  }
}
// Contagens de school/bond a partir de conjuntos de nomes (starters e bench)
function synergyCounts(startersSet, benchSet){
  const all = new Set(startersSet);
  if (benchSet) benchSet.forEach(n=> all.add(n));
  const schools = {};  // {name: count}
  const bonds   = {};  // {name: count}

  all.forEach(n=>{
    const p = characters.find(x=>x.nome === n); if (!p) return;
    if (p.School) schools[p.School] = (schools[p.School]||0)+1;
    (Array.isArray(p.vinculo)?p.vinculo:[]).forEach(b=>{
      bonds[b] = (bonds[b]||0)+1;
    });
  });
  return {schools, bonds};
}

// Ativadas (o que voc√™ j√° usava) a partir das contagens
function synergyActivatedTotalFromCounts(cnt){
  const actSchools = Object.values(cnt.schools).filter(c=> c>=4).length;
  const actBonds   = Object.entries(cnt.bonds).filter(([b,c])=> c >= bondRequired(b)).length;
  return actSchools + actBonds;
}

// üî• Progresso fracionado rumo √† ativa√ß√£o (0..nSchools+nBonds)
function synergyProgressFromCounts(cnt){
  let prog = 0;
  // schools (precisam de 4)
  for (const c of Object.values(cnt.schools)) prog += Math.min(c/4, 1);
  // bonds (precisam de 2, exceto alguns = 3)
  for (const [b,c] of Object.entries(cnt.bonds)) {
    const need = bondRequired(b);
    prog += Math.min(c/need, 1);
  }
  return prog;
}
function bondRequired(b){
  const k = String(b||'').trim().toLowerCase();
  return (k === 'Nata√ß√£o' || k === 'Cabe√ßa dos G√™meos') ? 3 : 2;
}
// ==================== Recommend 2.0 ====================
const RecommendCfg = {
  wSynergy: 3, wAnchor: 1, wStats: 1,
  allowCrossRole: true,
  preferTypes: new Set(),     // 'quick','power','block','receive'

  // üî• pesos governados pelo slider wTeamType:
  typePrefWeight: 2.0,        // progresso
  typeActivateBonus: 6.0,     // ativou (4 / 5) -> b√¥nus forte
  typeMajorityBonus: 3.0,     // virou majorit√°rio
  typeNonPreferredPenalty: 2.0, // majorit√°rio ‚â† preferido? penaliza

  preselectPerSlot: 10,
  beamWidth: 100
};

// Liga os controles de recomenda√ß√£o (abre/fecha painel e bot√£o Aplicar)
function bindRecommendControls(){
  const panel = document.getElementById('recoPanel');
  const btnToggle = document.getElementById('recommendBtn');
  const btnRun = document.getElementById('runRecommendBtn');
  const btnClose = document.getElementById('closeRecoBtn');

  function initSlidersOnce(){
    if (panel.__inited) return;
    panel.__inited = true;

    // sliders principais
    [
      ['wSynergy','wSynergyVal','wSynergy'],
      ['wAnchor','wAnchorVal','wAnchor'],
      ['wStats','wStatsVal','wStats']
    ].forEach(([inputId, outId, key])=>{
      const el = document.getElementById(inputId);
      const out = document.getElementById(outId);
      if (!el || !out) return;
      el.value = RecommendCfg[key];
      out.textContent = el.value;
      el.addEventListener('input', ()=>{ RecommendCfg[key] = +el.value; out.textContent = el.value; });
    });

    // üî• slider de Tipo do time -> typePrefWeight
    const wTT = document.getElementById('wTeamType');
const wTTv = document.getElementById('wTeamTypeVal');
if (wTT && wTTv){
  const applyTypeWeights = v => {
    const x = +v;              // 0..5 (ou o range que voc√™ definiu)
    RecommendCfg.typePrefWeight       = x;        // progresso
    RecommendCfg.typeActivateBonus    = 3 * x;    // ativar vale bastante
    RecommendCfg.typeMajorityBonus    = 1.5 * x;  // ser majorit√°rio tamb√©m ajuda
    RecommendCfg.typeNonPreferredPenalty = 1 * x; // e punimos majorit√°rio ‚Äúerrado‚Äù
    wTTv.textContent = v;
  };
  wTT.value = String(RecommendCfg.typePrefWeight);
  applyTypeWeights(wTT.value);
  wTT.addEventListener('input', ()=> applyTypeWeights(wTT.value));
}

    const chkCR = document.getElementById('allowCrossRole');
    if (chkCR){
      chkCR.checked = RecommendCfg.allowCrossRole;
      chkCR.addEventListener('change', ()=> RecommendCfg.allowCrossRole = chkCR.checked);
    }

    // checkboxes de tipo preferido
    [
      ['prefQuick','quick'],
      ['prefPower','power'],
      ['prefBlock','block'],
      ['prefReceive','receive'],
    ].forEach(([id, t])=>{
      const cb = document.getElementById(id);
      if (!cb) return;
      cb.checked = RecommendCfg.preferTypes.has(t);
      cb.addEventListener('change', ()=>{
        if (cb.checked) RecommendCfg.preferTypes.add(t);
        else RecommendCfg.preferTypes.delete(t);
      });
    });
  }

  if (btnToggle && !btnToggle.__bound){
    btnToggle.__bound = true;
    btnToggle.addEventListener('click', ()=>{
      initSlidersOnce();
      panel.classList.toggle('open');
    });
  }
  if (btnRun && !btnRun.__bound){
    btnRun.__bound = true;
    btnRun.addEventListener('click', ()=>{ recommendFillSlots2(); /* panel.classList.remove('open'); */ });
  }
  if (btnClose && !btnClose.__bound){
    btnClose.__bound = true;
    btnClose.addEventListener('click', ()=> panel.classList.remove('open'));
  }
}

// helpers
function symbolToType(sym){
  const s = String(sym||"").toLowerCase();
  if (s.includes("quicksymbol"))   return "quick";
  if (s.includes("powersymbol"))   return "power";
  if (s.includes("servesymbol"))   return "serve";
  if (s.includes("settersymbol"))  return "setter";
  if (s.includes("receivesymbol")) return "receive";
  if (s.includes("blocksymbol"))   return "block";
  if (s.includes("savesymbol"))    return "save";
  return null;
}
const TYPE_MIN = t => (t === 'receive' ? 5 : 4);
const RARITY_TOKENS = new Set(['UR','SSR','SP','SR','R','N','MR']);
function baseName(name){
  const parts = String(name||'').trim().split(/\s+/);
  if (!parts.length) return '';
  const last = parts[parts.length-1].toUpperCase().replace(/[+]/g,'');
  if (RARITY_TOKENS.has(last)) parts.pop();   // remove ‚ÄúUR/SSR/SP/‚Ä¶‚Äù
  return parts.join(' ');
}

function typeProgress(counts, preferSet){
  let total = 0;
  preferSet.forEach(t=>{
    const c = counts[t] || 0;
    total += c / TYPE_MIN(t);
  });
  return total;
}
function startersSlots(){ return Array.from(document.querySelectorAll('.hex')); }
function benchSlots(){ return Array.from(document.querySelectorAll('.bench-slot')); }
function slotRole(el){ return (el.dataset.role || el.getAttribute('data-role') || '').toUpperCase(); }
function slotName(el){ return el?.dataset?.nome || null; }
function charByName(n){ return characters.find(c => c.nome === n); }
function sumStats(p){
  const S = p?.Stats || {};
  return (S.Serve|0)+(S.Spike|0)+(S.Set|0)+(S.Receive|0)+(S.Block|0)+(S.Save|0);
}
function allowedRolesForSlot(role, allowCross){
  if (role === 'L') return ['L'];
  return allowCross ? ['S','MB','WS','OP'] /* n√£o-L */ : [role];
}

// contagem de tipos entre titulares (Set de nomes)
function teamTypeCountsFromNames(nameSet){
  const counts = {};
  nameSet.forEach(n=>{
    const p = characters.find(x => x.nome === n); if (!p) return;
    (Array.isArray(p.symbols)?p.symbols:[]).map(symbolToType).filter(Boolean)
      .forEach(t => counts[t] = (counts[t]||0)+1);
  });
  return counts;
}
function maxTypeInfo(counts){
  let best = [], bestN = 0;
  for (const [t,c] of Object.entries(counts)){
    if (c > bestN){ best=[t]; bestN=c; }
    else if (c === bestN) best.push(t);
  }
  return {types:best, count:bestN};
}

// Schools e Bonds ativados, recebendo SET de titulares e SET de banco (opcional)
function schoolsAndBondsActivated(startersSet, benchSet){
  const all = new Set(startersSet);
  if (benchSet) benchSet.forEach(n=> all.add(n));

  const schoolCount = {};
  const bondCount = {};
  all.forEach(n=>{
    const p = characters.find(x => x.nome === n); if (!p) return;
    if (p.School) schoolCount[p.School] = (schoolCount[p.School]||0)+1;
    (Array.isArray(p.vinculo)?p.vinculo:[]).forEach(b=>{
      bondCount[b] = (bondCount[b]||0)+1;
    });
  });

  const schoolsActive = Object.values(schoolCount).filter(c=>c>=4).length;
  const bondsActive = Object.entries(bondCount).filter(([b,c])=> c >= bondRequired(b)).length;
  return {schoolsActive, bondsActive, total: schoolsActive + bondsActive};
}

// √¢ncora: quantas novas sinergias (school/bond) incluem ao menos 1 nome j√° existente
function anchorGain(beforeSet, afterSet){
  const added = new Set([...afterSet].filter(n=>!beforeSet.has(n)));
  if (!added.size) return 0;

  const bondMembers = {}, schoolMembers = {};
  afterSet.forEach(n=>{
    const p = characters.find(x => x.nome === n); if (!p) return;
    if (p.School) (schoolMembers[p.School]||(schoolMembers[p.School]=new Set())).add(n);
    (Array.isArray(p.vinculo)?p.vinculo:[]).forEach(b=>{
      (bondMembers[b]||(bondMembers[b]=new Set())).add(n);
    });
  });

  let gain = 0;
  for (const [school, members] of Object.entries(schoolMembers)){
    if (members.size>=4){
      const hasOld = [...members].some(n=>beforeSet.has(n));
      const hasNew = [...members].some(n=>added.has(n));
      if (hasOld && hasNew) gain += 1;
    }
  }
  for (const [bond, members] of Object.entries(bondMembers)){
    if (members.size>=bondRequired(bond)){
      const hasOld = [...members].some(n=>beforeSet.has(n));
      const hasNew = [...members].some(n=>added.has(n));
      if (hasOld && hasNew) gain += 1;
    }
  }
  return gain;
}

// constru√ß√£o de candidatos por slot
function candidatePoolForSlot(slot, excludeNames, allowCross){
  const role = slotRole(slot);
  const allowed = new Set(allowedRolesForSlot(role, allowCross));
  return characters.filter(p=>{
    if (excludeNames.has(p.nome)) return false;
    // L s√≥ pode ir no L; se allowed == [role] no modo n√£o-cross, j√° restringe
    if (role === 'L') return p.funcao === 'L';
    if (!allowCross) return p.funcao === role;
    return p.funcao !== 'L'; // cross-role: qualquer n√£o-L em slots n√£o-L
  });
}

// cria produto cartesiano limitado
function* cartesianLimited(arrays, limit){
  const idx = arrays.map(()=>0);
  let produced = 0;
  while (arrays.length && produced < limit){
    // yield combina√ß√£o atual
    yield arrays.map((a,i)=>a[idx[i]]);
    produced++;
    // incrementa
    let k = arrays.length - 1;
    while (k>=0){
      idx[k]++;
      if (idx[k] < arrays[k].length) break;
      idx[k]=0; k--;
    }
    if (k<0) break;
  }
}

function recommendFillSlots2(){
  const starterEls = Array.from(document.querySelectorAll('.hex'));
  const benchEls   = Array.from(document.querySelectorAll('.bench-slot'));

  // 1) Estado atual
  const beforeStarters = new Set(starterEls.map(s => s.dataset?.nome).filter(Boolean));
  const benchNames     = new Set(benchEls.map(s => s.dataset?.nome).filter(Boolean));
  const emptySlots     = starterEls.filter(s => !s.dataset?.nome);
  if (!emptySlots.length) return;

  // 2) Sinergias "antes"
  const beforeCnt     = synergyCounts(beforeStarters, benchNames);
  const synBeforeAct  = synergyActivatedTotalFromCounts(beforeCnt);
  const synBeforeProg = synergyProgressFromCounts(beforeCnt);

  // 3) Pr√©-c√°lculos
  const filledBase       = new Set([...beforeStarters, ...benchNames].map(baseName));
  const beforeTypeCounts = teamTypeCountsFromNames(beforeStarters);
  const baseTypeProg     = typeProgress(beforeTypeCounts, RecommendCfg.preferTypes);
  const synBeforeTotal   = schoolsAndBondsActivated(beforeStarters, benchNames).total;

  // utils
  const slotRole = el => (el.dataset.role || el.getAttribute('data-role') || '').toUpperCase();
  const allowedRolesForSlot = role => role==='L' ? ['L'] : (RecommendCfg.allowCrossRole ? ['S','MB','WS','OP'] : [role]);
  const sumStats = p => { const S=p.Stats||{}; return (S.Serve|0)+(S.Spike|0)+(S.Set|0)+(S.Receive|0)+(S.Block|0)+(S.Save|0); };

  // 4) Pools por slot (pr√©-sele√ß√£o por sinergia + tipo + stats)
  const pools = emptySlots.map(slot=>{
    const role = slotRole(slot);

    let list = characters.filter(p=>{
      if (beforeStarters.has(p.nome) || benchNames.has(p.nome)) return false;
      if (filledBase.has(baseName(p.nome))) return false;      // evita duplicar jogador em outra raridade
      if (role==='L') return p.funcao==='L';
      return RecommendCfg.allowCrossRole ? (p.funcao!=='L') : (p.funcao===role);
    });

    list = list.map(p=>{
      // --- Sinergia 1 passo: ativadas + progresso ---
      const afterStarters = new Set(beforeStarters); afterStarters.add(p.nome);
      const cntAfter   = synergyCounts(afterStarters, benchNames);
      const synAct     = synergyActivatedTotalFromCounts(cntAfter);
      const synProg    = synergyProgressFromCounts(cntAfter);
      const synDeltaAct  = synAct  - synBeforeAct;
      const synDeltaProg = synProg - synBeforeProg;
      const synScore     = RecommendCfg.wSynergy * (synDeltaAct + 0.5*synDeltaProg);

      // --- Tipo preferido ---
      const typeCountsAfter = {...beforeTypeCounts};
      (Array.isArray(p.symbols)?p.symbols:[]).map(symbolToType).filter(Boolean)
        .forEach(t=> typeCountsAfter[t]=(typeCountsAfter[t]||0)+1);

      const prefProgressAfter = typeProgress(typeCountsAfter, RecommendCfg.preferTypes);
      const prefDelta         = prefProgressAfter - baseTypeProg;

      const afterMax = maxTypeInfo(typeCountsAfter);
      const activatedPreferred   = afterMax.types.some(t=>RecommendCfg.preferTypes.has(t)) && afterMax.count >= TYPE_MIN(afterMax.types[0]||'');
      const majorityPreferred    = afterMax.types.some(t=>RecommendCfg.preferTypes.has(t));
      const majorityActivated    = afterMax.count >= TYPE_MIN(afterMax.types[0]||'');
      const nonPreferredMajority = majorityActivated && !majorityPreferred;

      const typeScore =
        (RecommendCfg.typePrefWeight * prefDelta) +
        (activatedPreferred   ? RecommendCfg.typeActivateBonus       : 0) +
        (majorityPreferred    ? RecommendCfg.typeMajorityBonus       : 0) +
        (nonPreferredMajority ? -RecommendCfg.typeNonPreferredPenalty: 0);

      return { p,
        heur: synScore + typeScore + (RecommendCfg.wStats * (sumStats(p)/2000))
      };
    })
    .sort((a,b)=> b.heur - a.heur)
    .slice(0, RecommendCfg.preselectPerSlot)
    .map(x=>x.p);

    // fallback por stats
    if (!list.length){
      list = characters
        .filter(p=> !beforeStarters.has(p.nome)
                 && !benchNames.has(p.nome)
                 && !filledBase.has(baseName(p.nome))
                 && (role==='L' ? p.funcao==='L'
                                 : (RecommendCfg.allowCrossRole ? p.funcao!=='L' : p.funcao===role)))
        .sort((a,b)=> sumStats(b)-sumStats(a))
        .slice(0, RecommendCfg.preselectPerSlot);
    }
    return list;
  });

  // 5) BEAM search
  let beam = [{ pick:[], names:new Set(), base:new Set(filledBase), score:0, stats:0 }];
  emptySlots.forEach((slot, stepIdx)=>{
    const next = [];
    for (const state of beam){
      for (const p of pools[stepIdx]){
        if (state.names.has(p.nome)) continue;
        const b = baseName(p.nome);
        if (state.base.has(b)) continue;

        const namesAfter = new Set([...beforeStarters, ...state.names, p.nome]);

        const synAfter = schoolsAndBondsActivated(namesAfter, benchNames).total;
        const synDelta = synAfter - synBeforeTotal;

        const ancGain = anchorGain(beforeStarters, namesAfter);

        const afterTypeCounts   = teamTypeCountsFromNames(namesAfter);
        const prefProgressAfter = typeProgress(afterTypeCounts, RecommendCfg.preferTypes);
        const prefDelta         = prefProgressAfter - baseTypeProg;

        const afterMax = maxTypeInfo(afterTypeCounts);
        const activatedPreferred   = afterMax.types.some(t=>RecommendCfg.preferTypes.has(t)) && afterMax.count >= TYPE_MIN(afterMax.types[0]||'');
        const majorityPreferred    = afterMax.types.some(t=>RecommendCfg.preferTypes.has(t));
        const majorityActivated    = afterMax.count >= TYPE_MIN(afterMax.types[0]||'');
        const nonPreferredMajority = majorityActivated && !majorityPreferred;

        const typeScore =
          (RecommendCfg.typePrefWeight * prefDelta) +
          (activatedPreferred   ? RecommendCfg.typeActivateBonus       : 0) +
          (majorityPreferred    ? RecommendCfg.typeMajorityBonus       : 0) +
          (nonPreferredMajority ? -RecommendCfg.typeNonPreferredPenalty: 0);

        const statsSum   = state.stats + sumStats(p);
        const statsScore = statsSum / ((state.pick.length + 1) * 2000);

        const score = (RecommendCfg.wSynergy*synDelta)
                    + (RecommendCfg.wAnchor*ancGain)
                    + typeScore
                    + (RecommendCfg.wStats*statsScore);

        next.push({
          pick:[...state.pick, {slot, p}],
          names:new Set([...state.names, p.nome]),
          base:new Set([...state.base, b]),
          score, stats: statsSum
        });
      }
    }
    next.sort((a,b)=> b.score - a.score);
    beam = next.slice(0, RecommendCfg.beamWidth);
  });

  if (!beam.length || !beam[0].pick?.length) return;

  // 6) Aplicar nos slots vazios
  beam[0].pick.forEach(({slot, p})=>{
    const keepRole = slotRole(slot)==='L' ? 'L' : (slot.dataset.role || slot.getAttribute('data-role'));
    setCharacter(slot, p, keepRole);
  });

  if (typeof updateSynergies === 'function') updateSynergies();
}



// ======================= Multi Teams =========================

// Coleta estado atual do grid (titulares + banco + itens)
function collectTeamState(name){
  const state = { name: name || `Time ${currentTeamIndex+1}`, starters:{}, bench:{}, equip:{} };

  // titulares
  document.querySelectorAll('.hex').forEach(slot=>{
    const id   = getSlotId(slot);
    const nome = slot.dataset?.nome || null;
    if (nome) state.starters[id] = nome;
    const eq = equipState.get(id);
    if (eq) state.equip[id] = JSON.parse(JSON.stringify(eq));
  });

  // banco
  document.querySelectorAll('.bench-slot').forEach(slot=>{
    const id   = getSlotId(slot);
    const nome = slot.dataset?.nome || null;
    if (nome) state.bench[id] = nome;
    const eq = equipState.get(id);
    if (eq) state.equip[id] = JSON.parse(JSON.stringify(eq));
  });

  return state;
}

// Cria um estado vazio (novo time)
function makeEmptyTeamState(name){
  return { name: name || `Time ${teams.length+1}`, starters:{}, bench:{}, equip:{} };
}

// Limpa completamente o grid atual (remove personagens e itens)
function clearWholeGrid(){
  document.querySelectorAll('.hex,.bench-slot').forEach(slot=>{
    if (slot.dataset?.nome) removeCharacter(slot);
    const id = getSlotId(slot);
    equipState.delete(id);
  });
}

// Aplica um estado ao grid
function applyTeamState(state){
  clearWholeGrid();

  // titulares
  Object.entries(state.starters || {}).forEach(([slotId, nome])=>{
    const slot = document.querySelector(`[data-slot-id="${slotId}"]`) || document.getElementById(slotId);
    if (!slot) return;
    const role = slot.classList.contains('bench-slot') ? 'bench' : (slot.dataset.role || slot.getAttribute('data-role'));
    const p = characters.find(c => c.nome === nome);
    if (p) setCharacter(slot, p, role);
  });

  // banco
  Object.entries(state.bench || {}).forEach(([slotId, nome])=>{
    const slot = document.querySelector(`[data-slot-id="${slotId}"]`) || document.getElementById(slotId);
    if (!slot) return;
    const role = 'bench';
    const p = characters.find(c => c.nome === nome);
    if (p) setCharacter(slot, p, role);
  });

  // itens
  Object.entries(state.equip || {}).forEach(([slotId, obj])=>{
    equipState.set(slotId, JSON.parse(JSON.stringify(obj)));
  });

  // atualiza UI dependente
  if (typeof updateSynergies === 'function') updateSynergies();
  if (typeof refreshAllGears  === 'function') refreshAllGears();
}

// Salva o time atual no array
function saveCurrentTeam(){
  if (!teams.length) return;
  const oldName = teams[currentTeamIndex]?.name || `Time ${currentTeamIndex+1}`;
  teams[currentTeamIndex] = collectTeamState(oldName);
}

// Renderiza as abas
function renderTeamTabs(){
  const tabs = document.getElementById('teamTabs');
  if (!tabs) return;
  tabs.innerHTML = '';

  teams.forEach((t, i)=>{
    const b = document.createElement('button');
    b.className = 'team-tab' + (i===currentTeamIndex ? ' active' : '');
    b.textContent = t.name;
    b.title = `Selecionar ${t.name}`;

    // evita troca enquanto estiver editando
    b.addEventListener('click', ()=>{
      if (b.classList.contains('editing')) return;
      if (i === currentTeamIndex) return;
      saveCurrentTeam();
      currentTeamIndex = i;
      applyTeamState(teams[i]);
      renderTeamTabs();
    });

    // === Renomear no dblclick ===
    b.addEventListener('dblclick', (e)=>{
      e.preventDefault();
      e.stopPropagation();
      if (b.classList.contains('editing')) return;

      b.classList.add('editing');
      const oldName = teams[i].name;
      b.textContent = ''; // limpar para inserir input

      const input = document.createElement('input');
      input.className = 'team-tab-edit';
      input.type = 'text';
      input.value = oldName;
      input.setAttribute('maxlength', 40);
      b.appendChild(input);
      input.focus();
      input.select();

      const commit = ()=>{
        const val = (input.value || '').trim();
        teams[i].name = val || oldName; // se vazio, mant√©m
        b.classList.remove('editing');
        renderTeamTabs();
      };
      const cancel = ()=>{
        b.classList.remove('editing');
        renderTeamTabs();
      };

      input.addEventListener('keydown', (ev)=>{
        if (ev.key === 'Enter') commit();
        else if (ev.key === 'Escape') cancel();
      });
      input.addEventListener('blur', commit);
    });

    tabs.appendChild(b);
  });
}

// Inicializa a barra de times
function initMultiTeams(){
  const addBtn = document.getElementById('addTeamBtn');

  if (teams.length === 0){
    teams.push(collectTeamState('Team 1'));
    currentTeamIndex = 0;
  }
  renderTeamTabs();

  // evita ligar o clique mais de uma vez
  if (addBtn && !addBtn.__mtBound){
    addBtn.__mtBound = true;
    addBtn.addEventListener('click', ()=>{
      if (__mtAdding) return;          // trava se j√° estiver rodando
      __mtAdding = true;
      try {
        saveCurrentTeam();
        const newIdx = teams.length + 1;
        const empty = makeEmptyTeamState(`Team ${newIdx}`);
        teams.push(empty);
        currentTeamIndex = teams.length - 1;
        applyTeamState(empty);
        renderTeamTabs();
      } finally {
        // solta o lock no pr√≥ximo ciclo do event loop
        setTimeout(()=>{ __mtAdding = false; }, 0);
      }
    });
  }

  // opcional: salvar automaticamente ap√≥s qualquer mudan√ßa
  // se voc√™ j√° usa hooks globais, podemos plugar aqui:
  const oldAfterAssign = window.afterAssignCharacter;
  window.afterAssignCharacter = function(el, nome){
    if (typeof oldAfterAssign === 'function') oldAfterAssign(el, nome);
    saveCurrentTeam();
  };
  const oldAfterRemove = window.afterRemoveCharacter;
  window.afterRemoveCharacter = function(el){
    if (typeof oldAfterRemove === 'function') oldAfterRemove(el);
    saveCurrentTeam();
  };
}

</script>



<!-- ===================== PLANEJADOR DE RECURSOS (P√ÅGINA NOVA) ===================== -->
<style>
  /* P√°ginas altern√°veis */
  .page { display: none; }
  .page.active { display: block; }
  /* Quando a classe show-planner est√° no <body>, mostramos o planner em overlay e ocultamos overflow */
  body.show-planner { overflow: hidden; }
  body.show-planner .hide-when-planner { display: none !important; }
  body.show-planner #pagePlanner { display: block; position: fixed; inset: 0; z-index: 9999; background:#111; overflow:auto; }

  /* Barra do bot√£o Planejador acima de Save & Load */
  #plannerTopBar {
    display:flex; gap:10px; align-items:center; justify-content:center;
    margin: 14px 0 0;
  }
  #openPlannerBtn {
    background:#ffd54f; color:#222; border:0; font-weight:800;
    padding:10px 14px; border-radius:10px; cursor:pointer;
    box-shadow:0 3px 0 rgba(0,0,0,.25);
  }
  #openPlannerBtn:hover{ transform: translateY(-1px); }

  /* Layout do Planejador */
  #pagePlanner { padding: 18px; }
  .planner-wrap{
    max-width: 1180px; margin: 0 auto;
    display:grid; grid-template-columns: 1.1fr .9fr;
    gap: 20px;
    background:#2a2a2a; border:1px solid #3a3a3a; border-radius:14px; padding:16px;
  }
  @media (max-width: 980px){
    .planner-wrap{ grid-template-columns: 1fr; }
  }

  .panel {
    background:#242424; border:1px solid #3a3a3a; border-radius:12px; padding:12px;
  }
  .panel h3{ margin: 0 0 10px; }
  .panel .sub{ opacity:.8; font-size:.9rem; margin-top:-6px; }

  /* tabelas edit√°veis */
  .grid-table{ width:100%; border-collapse: collapse; }
  .grid-table th, .grid-table td{
    border-bottom: 1px solid #3a3a3a; padding:6px 8px; text-align:left;
  }
  .grid-table th{ background:#1f1f1f; position:sticky; top:0; z-index:1; }
  .grid-table input[type="number"], .grid-table input[type="text"], .grid-table select{
    width:100%; background:#1d1d1d; color:#fff; border:1px solid #555; border-radius:8px;
    padding:6px 8px; box-sizing:border-box;
  }
  .grid-table input[type="checkbox"]{ transform: scale(1.2); }

  .row-actions{ display:flex; gap:6px; }
  .btn { background:#333; color:#fff; border:1px solid #666; border-radius:8px; padding:8px 10px; cursor:pointer; }
  .btn.del{ background:#a33; border-color:#d66; }
  .btn.add{ background:#2f6; color:#000; font-weight:800; }
  .btn.primary{ background:#40f06a; color:#000; font-weight:800; }
  .btn.light{ background:#111; border-color:#444; }

  .flex { display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
  .right { text-align:right; }

  /* Resumo */
  .summary{ display:grid; grid-template-columns: repeat(4,1fr); gap:10px; margin-top:10px; }
  .metric{
    background:#1e1e1e; border:1px solid #3a3a3a; border-radius:10px; padding:10px;
    text-align:center;
  }
  .metric b{ display:block; font-size:1.1rem; }

  /* Tabela de Simula√ß√£o por Banner */
  #simTable{ width:100%; border-collapse: collapse; margin-top:10px; }
  #simTable th, #simTable td{ border-bottom:1px solid #3a3a3a; padding:8px; text-align:right; }
  #simTable th{ text-align:center; background:#1f1f1f; }
  #simTable td:first-child, #simTable th:first-child{ text-align:left; }
  /* === Planner em tela cheia === */
#pagePlanner{
  position: fixed;      /* vira um overlay */
  inset: 0;             /* top/right/bottom/left = 0 */
  width: 100vw;
  height: 100vh;
  margin: 0;
  padding: 16px clamp(12px,2vw,24px) 24px;
  background: #121212;  /* use a cor do seu tema, se tiver vari√°vel */
  z-index: 999;         /* acima do restante da UI */
  overflow: auto;       /* rolagem interna */
}

/* evita ‚Äúcaixa‚Äù estreita por max-width herdado */
#pagePlanner .container,
#pagePlanner .planner-box,
#pagePlanner .planner-wrap,
#pagePlanner .planner-grid{
  max-width: none !important;
  width: 100% !important;
}

/* mant√©m cabe√ßalho/toolbar vis√≠vel enquanto rola o planner */
#pagePlanner .planner-header{
  position: sticky;
  top: 0;
  z-index: 1;
  background: inherit;
  padding-bottom: 8px;
}

/* quando o planner est√° aberto, trava o scroll do body atr√°s */
body.planner-open{ overflow: hidden; }
#simInputs small.muted{opacity:.9}
#simTable tfoot{ display:none; }
#simTable .neg{ color:#ff5c5c; font-weight:700; }
/* Caixa num√©rica padr√£o do planner (usar em Saldo Inicial, Tickets e Mem√≥rias) */
.planner-input{
  width: 140px;      /* ajuste conforme seu layout */
  padding: 6px 10px;
  background:#111;
  color:#fff;
  border:1px solid #444;
  border-radius:8px;
  outline:none;
}
.planner-input:focus{ border-color:#777; }
.sim-extras{
  border-top:1px solid #333;
  padding-top:8px;
  font-weight:600;
  display:flex;
  flex-wrap:wrap;
  gap:10px 16px;
}
.sim-extras .pill{
  background:#1d1d1d;
  border:1px solid #444;
  border-radius:999px;
  padding:4px 10px;
}
/* ===== Planner: 2 colunas mais equilibradas ===== */


/* Simula√ß√£o (direita) garante que n√£o estoure a largura */
#pagePlanner .planner-sim{
  width: 100%;
  box-sizing: border-box;
}

/* Evita qualquer overflow horizontal do planner */
#pagePlanner{ overflow-x: hidden; }

/* ===== Cart√µes de banner mais enxutos ===== */
/* use uma ‚Äúvari√°vel‚Äù pra controlar o tamanho dos cards */
:root{ --card-w: 200px; }          /* antes: 320px */
.banner-card,
.rebanner-card{
  width: var(--card-w);
  flex: 0 0 var(--card-w);         /* n√£o estica */
  margin: 0 auto;
}
.month-row > div{ min-width: 0; }  /* impede que colunas internas forcem largura */

/* Em telas um pouco menores, encolhe mais um pouco os cards */
@media (max-width: 1700px){
  :root{ --card-w: 280px; }
}

/* === 50% | 50%: Banners (esq) e Simula√ß√£o (dir) === */
#pagePlanner .planner-right-grid,
#pagePlanner .planner-two-col{
  display: grid;
  grid-template-columns: 1fr 1fr;   /* META: meio a meio */
  gap: 12px;
  align-items: start;
}

/* Simula√ß√£o fixa vis√≠vel e scroll√°vel dentro da metade direita (opcional) */
#simPane{
  position: sticky;
  top: 12px;
  max-height: calc(100vh - 120px);
  overflow: auto;
}

/* Em telas menores, caia para 1 coluna para n√£o esmagar conte√∫do */
@media (max-width: 1200px){
  #pagePlanner .planner-right-grid,
  #pagePlanner .planner-two-col{
    grid-template-columns: 1fr;
  }
}
/* Gutter (recuo) √† direita da aba Simula√ß√£o */
:root{
  --sim-gutter: clamp(8px, 1vw, 16px); /* ajuste aqui se quiser mais/menos */
}

#simPane{
  padding-right: calc(var(--sim-gutter) + env(safe-area-inset-right, 0px));
  box-sizing: border-box;   /* evita ‚Äúestourar‚Äù a metade direita */
  /* j√° deve existir overflow:auto; mantenha */
}
/* ---------- Desktop (j√° existente): duas colunas ---------- */
/* (mantenha como estiver hoje; n√£o precisa mexer) */


/* ---------- Mobile: <= 980px ---------- */
@media (max-width: 980px){

  /* A grade vira 1 coluna, e controlamos a ordem com √°reas */
  #pagePlanner .planner-right-grid{
    display: grid;
    grid-template-columns: 1fr;
    grid-template-areas:
      "sim"
      "banners";
    row-gap: 14px;
  }

  /* Nomear as √°reas */
  #bannersPane{ grid-area: banners; }
  #simPane{ grid-area: sim; }

  /* A Simula√ß√£o N√ÉO deve ser sticky no mobile: mostra tudo */
  #simPane{
    position: static;
    max-height: none;
    overflow: visible;
    padding-right: var(--sim-gutter, 12px); /* mant√©m o leve recuo que fizemos */
    box-sizing: border-box;
  }

  /* Cards de banner ocupam 100% da linha para caber bem */
  .month-row{
    grid-template-columns: 1fr;   /* 1 por linha */
    gap: 12px;
  }
  .banner-card,
  .rebanner-card{
    width: 100%;
    max-width: 100%;
  }

  /* Inputs da Simula√ß√£o n√£o estourarem largura */
  #simPane #simInputs label{ display:flex; align-items:center; gap:10px; }
  #simPane #simInputs input{ max-width: 240px; }
}
/* ==== Ranking list (igual ao EN) ==== */
.mini-line{ display:inline-flex; gap:4px; vertical-align:middle; margin-right:6px; }  /* EN */
.mini-char{ width:24px; height:32px; object-fit:cover; border-radius:4px; box-shadow:0 0 0 1px #444; }  /* EN */
.top-row-li{ display:flex; align-items:center; gap:6px; justify-content:center; }  /* EN */
.btn-more{ background:#2a2a2a; color:#ddd; border:1px solid #555; border-radius:8px; padding:2px 8px; cursor:pointer; }  /* EN */
.btn-imp,.btn-cmt{ margin-left:4px; }  /* EN */

/* ==== Abas do ranking (3 colunas, ocupando a largura toda) ==== */
.rank-tabs{ display:grid; grid-template-columns:repeat(3,1fr); gap:10px; margin:8px 0 12px; }
.rank-tabs .menu-btn{ display:block; width:100%; }

/* ==== Ranking de personagens centralizado ==== */
#panelRankChar .top-list{ width:fit-content; margin:0 auto; }           /* centraliza o bloco todo */
.char-row{ display:flex; align-items:center; justify-content:space-between; gap:.5rem; min-width:360px; }
.char-row .mini-line{ display:flex; align-items:center; gap:.5rem; }
.char-row small{ width:56px; text-align:center; }                        /* n√∫mero centralizado */
.xpcalc.hidden { display:none; }
.xpcalc { background:#111; border:1px solid #333; border-radius:12px; padding:16px; }
.xpcalc-head { display:flex; align-items:center; justify-content:space-between; margin-bottom:8px; }
.xpcalc-row { display:flex; gap:12px; flex-wrap:wrap; margin:10px 0; }
.xpcalc-col { display:flex; flex-direction:column; gap:6px; min-width:100px; }
.xpcalc-col input, .xpcalc-col select { padding:6px 10px; border-radius:8px; border:1px solid #333; background:#1a1a1a; color:#fff; }
.xpcalc-results { margin-top:10px; padding:10px; border:1px dashed #444; border-radius:10px; }
.xpcalc-table summary { cursor:pointer; margin-top:10px; }
.muted { color:#aaa; font-size:.9em; }
.ghost { background:transparent; border:0; color:#aaa; font-size:20px; cursor:pointer; }
.sidebtn { width:100%; margin-top:6px; }
/* tamanho geral: ~2x (ajuste fino se quiser) */
.xpcalc { 
  font-size: 1.6rem;              /* era ~0.9‚Äì1.0rem; agora ‚Äú2x-ish‚Äù */
  line-height: 1.5;
  margin-top: 24px;               /* espa√ßo ACIMA do bloco */
  margin-bottom: 32px;            /* espa√ßo ABAIXO do bloco */
}

/* t√≠tulos um pouco maiores */
.xpcalc h2 { font-size: 2rem; margin: 0 0 12px; }
.xpcalc h3 { font-size: 1.6rem; margin: 16px 0 8px; }

/* inputs/selects proporcionalmente maiores */
.xpcalc-col input, 
.xpcalc-col select { 
  font-size: 1.1em; 
  padding: 10px 14px; 
  border-radius: 10px; 
}

/* summary da tabela com mais respiro */
.xpcalc-table summary { 
  font-size: 1.2em; 
  padding: 10px 0 4px; 
}
/* centraliza t√≠tulos, labels e resultados */
.xpcalc, 
.xpcalc *:not(input):not(select) { 
  text-align: center; 
}

/* inputs/selects centralizados internamente */
.xpcalc-col input, 
.xpcalc-col select { 
  text-align: center; 
}

/* tabela de XP pura centralizada */
#xpTable table { 
  margin: 10px auto 0; 
  text-align: center; 
}
#xpTable th, #xpTable td { 
  padding: 6px 10px; 
}
</style>
 <!-- PAINEL DA CALCULADORA (fica escondido at√© clicar no bot√£o) -->
<section id="xpCalcPanel" class="xpcalc hidden">
  <header class="xpcalc-head">
    <h2>Calculadora XP</h2>
    <button id="xpCalcClose" class="ghost">√ó</button>
  </header>

  <div class="xpcalc-row">
    <div class="xpcalc-col">
      <label>Raridade</label>
      <select id="xpRare">
        <option>UR</option>
        <option>SSR</option>
        <option>SR</option>
        <option>R</option>
        <option>N</option>
      </select>
    </div>
   <div class="xpcalc-row" id="alreadyWrap">
  <label style="display:flex;align-items:center;gap:8px;">
    <input id="alreadyAsc" type="checkbox">
    <span id="alreadyLabel">Already X‚òÖ</span>
  </label>
</div>
    <div class="xpcalc-col">
      <label>De</label>
      <select id="xpFrom">
        <option>1</option><option>20</option><option>40</option><option>60</option><option>70</option>
      </select>
    </div>

    <div class="xpcalc-col">
      <label>Para</label>
      <select id="xpTo">
        <option>20</option><option>40</option><option>60</option><option>70</option><option>80</option>
      </select>
    </div>
  </div>

  <h3>Foods</h3>
  <div class="xpcalc-row foods">
    <div class="xpcalc-col"><label>5‚òÖ</label><input id="have5" type="number" min="0" value="0"></div>
    <div class="xpcalc-col"><label>4‚òÖ</label><input id="have4" type="number" min="0" value="0"></div>
    <div class="xpcalc-col"><label>3‚òÖ</label><input id="have3" type="number" min="0" value="0"></div>
    <div class="xpcalc-col"><label>2‚òÖ</label><input id="have2" type="number" min="0" value="0"></div>
  </div>

  <div class="xpcalc-results">
    <div><b>XP Total necess√°rio:</b> <span id="resTotalXp">0</span></div>
    
    <div style="margin-top:.5rem"><b>Total de Foods 2‚òÖ Necess√°rios :</b> <span id="resNeed2">0</span></div>
    <div id="resBreak" class="muted"></div>
  </div>

  <details class="xpcalc-table">
    <summary>XP table (bruto, sem ascens√µes)</summary>
    <div id="xpTable"></div>
  </details>
</section>
<!-- 2) NOVA P√ÅGINA: Se√ß√£o de Ranking (mant√©m o padr√£o das outras p√°ginas, ex.: .page) -->
<section id="pageRanking" class="page">

  <h2 class="page-title">Ranking</h2>

  <!-- Descri√ß√£o (placeholder): voc√™ edita depois -->
  <p class="muted" id="rankingRules">Ranking coleta dados de times fechados desse team builder apenas</p>

  <!-- Barra de filtros (3 bot√µes) no MESMO estilo dos bot√µes do menu -->
  <div id="rankingPanels">
  <div class="rank-tabs">
    <button id="btnRank7d"  class="menu-btn">Ranking (7d)</button>
    <button id="btnRankAll" class="menu-btn">Ranking (All)</button>
    <button id="btnRankChar" class="menu-btn">Ranking Characters</button>
  </div>

  <section id="panelRank7d"></section>
  <section id="panelRankAll" hidden></section>
  <section id="panelRankChar" hidden></section>
</div>
</section>

<!-- ===================== PLANEJADOR DE RECURSOS (NOVA P√ÅGINA) ===================== -->
<section id="pagePlanner" class="page"
  style="display:none; text-align:left; position:fixed; inset:0; width:100vw; height:100vh; margin:0; padding:16px 20px; background:#121212; overflow:auto; z-index:999;">

  <!-- Cabe√ßalho -->
  <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
    <h3 style="margin:0;">Planejamento de Banners</h3>
    <button id="btnVoltarBuilder" class="btn" type="button"
      style="background:#444;border:1px solid #777;color:#fff;border-radius:8px;padding:6px 10px;cursor:pointer">
      ‚Üê Voltar ao Builder
    </button>
  </div>

  <!-- Duas colunas principais: Fontes (esq) | Painel de Banners+Simula√ß√£o (dir) -->
  <div class="planner-wrap" style="display:grid; grid-template-columns: 420px 1fr; gap:16px; align-items:start;">

    <!-- Coluna ESQUERDA: Fontes de diamantes -->
    <div class="panel sources" style="background:#2a2a2a;border:1px solid #444;border-radius:10px;padding:10px;">
      <h3 style="display:flex;align-items:center;justify-content:space-between;margin:0 0 8px;">
        Fontes de Diamantes (edit√°veis)
        <button id="toggleSources" class="btn mini" type="button"
          style="background:#555;border:1px solid #777;color:#fff;border-radius:8px;padding:4px 8px;cursor:pointer">
          Minimizar
        </button>
      </h3>

      <!-- FREE -->
      <div style="font-weight:700;opacity:.9;margin-top:6px;">Fontes FREE</div>
      <table id="tblFree" class="grid-table" style="width:100%;border-collapse:separate;border-spacing:6px 6px;">
        <thead>
          <tr><th>Usar</th><th class="col-sistema">Sistema</th><th>Quantidade</th><th>Frequ√™ncia</th><th></th></tr>
        </thead>
        <tbody></tbody>
      </table>
      <button id="addFree" class="btn" type="button"
        style="background:#3a6bd4;color:#fff;border:0;border-radius:8px;padding:6px 10px;cursor:pointer">+ Fonte FREE</button>

      <!-- CASH -->
      <div style="font-weight:700;opacity:.9;margin-top:14px;">Fontes CASH</div>
      <table id="tblCash" class="grid-table" style="width:100%;border-collapse:separate;border-spacing:6px 6px;">
        <thead>
          <tr><th>Usar</th><th class="col-sistema">Sistema</th><th>Quantidade</th><th>Frequ√™ncia</th><th></th></tr>
        </thead>
        <tbody></tbody>
      </table>
      <button id="addCash" class="btn" type="button"
        style="background:#3a6bd4;color:#fff;border:0;border-radius:8px;padding:6px 10px;cursor:pointer">+ Fonte CASH</button>

      <!-- (qualquer outro bloco/observa√ß√£o que voc√™ j√° tinha pode ficar aqui) -->
    </div>

    <!-- Coluna DIREITA: Controles + Banners (esq) | Simula√ß√£o (dir) -->
    <div class="panel" style="background:#2a2a2a;border:1px solid #444;border-radius:10px;padding:10px;">

      <!-- Controles do plano -->

        <label>Nome do Planejamento:
          <input id="nomePlano" type="text"
            style="background:#1d1d1d;color:#fff;border:1px solid #555;border-radius:8px;padding:4px 6px;min-width:220px;">
        </label>

        <select id="slotsPlanos"
          style="background:#1d1d1d;color:#fff;border:1px solid #555;border-radius:8px;padding:6px;">
          <option value="">(selecione um plano salvo)</option>
        </select>

        <button id="btnSalvarPlano" class="btn"
          style="background:#3a6bd4;color:#fff;border:0;border-radius:8px;padding:6px 10px;">Salvar / Atualizar</button>
        <button id="btnNovoPlano" class="btn"
          style="background:#555;color:#fff;border:0;border-radius:8px;padding:6px 10px;">Novo</button>
        <button id="btnExcluirPlano" class="btn"
          style="background:#b63a3a;color:#fff;border:0;border-radius:8px;padding:6px 10px;">Excluir</button>
      </div>

      <!-- Grid interno: Banners (esquerda) + Simula√ß√£o (direita/sticky) -->
      <div class="planner-right-grid">

        <!-- BANNERS POR M√äS (ESQUERDA) -->
        <section id="bannersPane">
          <h4 style="margin:12px 0 6px;text-align:center;">Ordem dos Banners</h4>
<!-- NOVO: alternador de servidor -->
<div id="serverSwitch" class="server-switch">
  <button id="serverJPBtn" class="server-btn active" type="button">Jap√£o</button>
  <button id="serverCNBtn" class="server-btn" type="button">China</button>
</div>

<!-- j√° existente -->
<div id="bannersCards"></div>
        </section>

        <!-- SIMULA√á√ÉO (DIREITA, STICKY) -->
        <aside id="simPane" style="position:sticky; top:12px; max-height:calc(100vh - 120px); overflow:auto;">
          <h4 style="margin:12px 0 6px;text-align:center;">Simula√ß√£o</h4>
          <!-- Inputs iniciais (agora dentro da Simula√ß√£o) -->
<div id="simInputs" style="display:flex; flex-direction:column; gap:8px; margin-bottom:10px;">

  <label style="display:flex; gap:8px; align-items:center;">
    <label>Saldo Inicial (cristais):
  <input id="saldoInicial" type="number" class="planner-input" inputmode="numeric">
</label>

  <label style="display:flex; gap:8px; align-items:center;">
  <label>Data de in√≠cio:
  <input id="planStartDate" type="date" class="planner-input">
  <button id="startTodayBtn" class="btn mini" type="button">Hoje</button>
</label>

  <div style="display:flex; gap:8px;">
    <button id="openSourcesBtn" class="bond-btn" type="button">+ Recursos de cristais</button>
  </div>
  
</div>
          <table id="simTable" style="width:100%;border-collapse:separate;border-spacing:6px 6px;">
            <thead>
              <tr>
                <th>M√™s</th>
                
                <th>Ganhos (FREE+CASH)</th>
                <th>Gasto Bruto</th>
                <th>Cashback</th>
                <th>Custo L√≠quido</th>
                <th>Saldo In√≠cio</th>
                <th>Saldo Final</th>
              </tr>
            </thead>
            <tbody></tbody>
            <tfoot>
              <tr style="font-weight:800;">
                <td>Total</td>
                <td></td>
                <td class="right" id="tGanhos">0</td>
                <td class="right" id="tGastoBruto">0</td>
                <td class="right" id="tCashback">0</td>
                <td class="right" id="tLiquido">0</td>
                <td></td>
                <td class="right" id="tSaldoFinal">0</td>
              </tr>
            </tfoot>
          </table>
          <div id="simExtras" class="sim-extras"></div>
        </aside>

      </div><!-- /planner-right-grid -->
    </div><!-- /panel direita -->
  </div><!-- /planner-wrap -->


  <!-- Modal de Recursos (FREE/CASH) -->
<div id="sourcesModal" class="modal-overlay" aria-hidden="true">
  <div class="modal-backdrop" data-close="1"></div>
  <div class="modal-dialog" role="dialog" aria-modal="true" aria-labelledby="sourcesTitle">
    <div class="modal-header">
      <h3 id="sourcesTitle">Recursos de cristais</h3>
      <button id="closeSourcesBtn" class="bond-btn">Fechar</button>
    </div>
    <div id="sourcesModalBody" class="modal-body">
      <!-- o painel .panel.sources ser√° movido pra c√° ao abrir -->
    </div>
  </div>
</div>

</section>

<!-- =================== FIM DO PLANEJADOR =================== -->


<script>
  
(function(){
  // ===== Configura√ß√µes =====
  const MONTHS = ['January','February','March','April','May','June','July','August','September','October','November','December'];
  const FREQS  = ['Daily','Weekly','Biweekly','Monthly'];
  const TYPE_ORDER = { 'Banner 1': 0, 'Rebanner': 1, 'Banner 2': 2 };
  const COLLAPSE_KEY = 'hqPlannerSourcesCollapsed';
  const PLANS_KEY = 'hqPlannerPlansV1';
  const DRAFT_KEY = 'hqPlannerDraftV1';

  // ===== Defaults de fontes =====
  const DEFAULT_FREE = [
    {usar:true, nome:'Training Program', qtd:75,  freq:'Daily'},
    {usar:true, nome:'Daily Missions',            qtd:60,  freq:'Daily'},
    {usar:true, nome:'Weekly Missions',           qtd:100, freq:'Weekly'},
    {usar:true, nome:'Peak Challenge',           qtd:15,  freq:'Daily'},
    {usar:true, nome:'Peak Challeng Ranking',   qtd:20,  freq:'Daily'},
    {usar:true, nome:'Casual Games',            qtd:150, freq:'Weekly'},
    {usar:true, nome:'Quiz',                     qtd:10,  freq:'Daily'},
    {usar:true, nome:'Exercises',               qtd:10,  freq:'Daily'},
    {usar:true, nome:'Weekend Bonus',      qtd:120, freq:'Weekly'},
    {usar:true, nome:'Match Streak',    qtd:640, freq:'Biweekly'},
    {usar:true, nome:'Specialty Trial',   qtd:320, freq:'Weekly'},
    {usar:true, nome:'Store banner 1 e 2',   qtd:2500, freq:'Monthly'},
    {usar:true, nome:'Checkin banner 1 e 2',   qtd:1500, freq:'Monthly'},
  ];

  const DEFAULT_CASH = [
    {usar:true, nome:'Monthly Pass',           porDia:90,  dias:30},
    {usar:true, nome:'Monthly Pass Premium',   porDia:100, dias:30},
    {usar:true, nome:'Daily Conversion 80',    porDia:80,  dias:30},
    {usar:true, nome:'Daily Conversion 60',    porDia:60,  dias:14},
  ];

  // ===== Cronograma da planilha (por m√™s) =====
  const BANNER_SHEET = {
    'August':   { b1:'Ushijima UR',      rebs:[],                           b2:'Kuroo UR' },
    'September': { b1:'Oikawa UR',        rebs:[],                           b2:'Bokuto UR' },
    'October':  { b1:'Miya Atsumu UR',   rebs:[],                           b2:'Miya Osamu UR' },
    'November': { b1:'Hoshiumi UR',         rebs:['Oikawa UR'],                b2:'Hirugami UR' },
    'December': { b1:'Kageyama UR',      rebs:['Bokuto UR','Hoshiumi UR'],     b2:'Hinata SP' },
    'January':  { b1:'Kenma SP',         rebs:['Hirugami UR'],              b2:'Nishinoya SP' },
    'February':{ b1:'Sugawara SP',      rebs:['Kuro UR'],                 b2:'Bokuto SP' },
    'March':    { b1:'Akaashi SP',       rebs:['Kageyama UR'],   b2:'Aone SP' },
    'April':    { b1:'Sakusa UR',    rebs:['Osamu UR'],                 b2:'Komori UR' },
    'May':     { b1:'Tsuki SP',         rebs:[],                           b2:'Kuro SP' },
    'June':    { b1:'Kunimi SP',        rebs:[],                           b2:'Koganegawa SP' },
  };

  // ===== Estado =====
  let planner = {
    saldoInicial: 0,
    nomePlano: '',
    free: JSON.parse(JSON.stringify(DEFAULT_FREE)),
    cash: JSON.parse(JSON.stringify(DEFAULT_CASH)),
    banners: []
  };

  // ===== Helpers =====
  const $ = (s, el=document)=>el.querySelector(s);
  const $$ = (s, el=document)=>Array.from(el.querySelectorAll(s));
  const fmt = n => (Math.round((+n||0))).toLocaleString('pt-BR');

  // liga a data de in√≠cio ao render dos banners e √† simula√ß√£o
(function bindPlanStartDate(){
  const dateEl = document.getElementById('planStartDate');
  const btnToday = document.getElementById('startTodayBtn');
  if(!dateEl) return;

  // quando mudar a data, re-renderiza e recalcula
  const onChange = ()=>{
    if (typeof renderBanners === 'function') renderBanners();
    if (typeof recalc === 'function') recalc();
  };
  dateEl.addEventListener('change', onChange);

  // bot√£o "Hoje"
  if(btnToday){
    btnToday.addEventListener('click', ()=>{
      const now = new Date();
      dateEl.value = `${now.getFullYear()}-${String(now.getMonth()+1).padStart(2,'0')}-${String(now.getDate()).padStart(2,'0')}`;
      onChange();
    });
  }

  // define um valor padr√£o (hoje) se estiver vazio ao abrir
  if(!dateEl.value){
    const now = new Date();
    dateEl.value = `${now.getFullYear()}-${String(now.getMonth()+1).padStart(2,'0')}-${String(now.getDate()).padStart(2,'0')}`;
  }
})();


  function setCollapsed(on){
    document.body.classList.toggle('planner-collapsed', !!on);
    const btn = document.getElementById('toggleSources');
    if(btn) btn.textContent = on ? 'Maximizar' : 'Minimizar';
    try{ localStorage.setItem(COLLAPSE_KEY, on?'1':'0'); }catch(e){}
  }

  function sortBannersFixed(){
  const monthsSeq = Object.keys(BANNER_SHEET);
  planner.banners.sort((a,b)=>{
    const am = monthsSeq.indexOf(a.mes);
    const bm = monthsSeq.indexOf(b.mes);
    if (am !== bm) return am - bm;                    // ordem da planilha
    return (TYPE_ORDER[a.tipo] ?? 99) - (TYPE_ORDER[b.tipo] ?? 99); // dentro do m√™s
  });
}


  // Gera√ß√£o de caminho de imagem a partir do nome
  function nameToImgCandidates(nome){
    if(!nome) return [];
    const rar = (nome.match(/\b(UR|SP)\b/i)||[])[1];
    if(!rar) return [];
    const rarity = rar.toUpperCase();
    const base = nome.replace(/\b(UR|SP)\b/i,'').trim()
      .normalize('NFD').replace(/[\u0300-\u036f]/g,'');
    const parts = base.split(/\s+/).filter(Boolean);
    if(!parts.length) return [];
    const lower = s => s.toLowerCase();
    const camel = parts.map((p,i)=> i===0 ? p.toLowerCase() : (p[0]||'').toUpperCase()+p.slice(1).toLowerCase()).join('');
    const last = lower(parts[parts.length-1]);
    const fullCamel = camel;
    return [
      `img/${last}${rarity}.png`,
      `img/${fullCamel}${rarity}.png`,
      `img/${last}${rarity}.webp`,
      `img/${fullCamel}${rarity}.webp`
    ];
  }
  function getBannerImage(b){
    if(b.img && b.img.trim()) return b.img;
    const list = nameToImgCandidates(b.nome);
    return list[0] || '';
  }

  // Cashback milestones
  function cashbackMilestones(totalPulls){
    let back150 = 0, back100 = 0;
    const extras = { ssrBox:0, milk:0, copy:0 };
    if(totalPulls >= 10)  back150 += 2;
    if(totalPulls >= 20)  back100 += 5;
    if(totalPulls >= 50)  back150 += 5;
    if(totalPulls >= 80)  back100 += 5;
    if(totalPulls >= 120) extras.ssrBox += 1;
    if(totalPulls >= 160) extras.milk   += 5;
    if(totalPulls >= 200) extras.copy   += 1;
    if(totalPulls >= 220) extras.milk   += 5;
    if(totalPulls >= 350) extras.milk   += 10;
    const cashbackDiamonds = back150*150 + back100*100;
    return { back150, back100, cashbackDiamonds, extras };
  }

  // Seed banners from sheet
  function uid(){ return 'b' + Math.random().toString(36).slice(2,9); }
  function seedBannersFromSheet(){
  planner.banners = [];
  // Ordem = a ordem de inser√ß√£o em BANNER_SHEET
  for (const mes of Object.keys(BANNER_SHEET)) {
    const row = BANNER_SHEET[mes]; if(!row) continue;

    if (row.b1){
      const img = getBannerImage({nome: row.b1});
      planner.banners.push({ id: uid(), mes, tipo:'Banner 1', nome: row.b1, img, dias:14, t150:0, m100:0, cashback:0 });
    }
    if (Array.isArray(row.rebs)){
      row.rebs.forEach(nome=>{
        const img = getBannerImage({nome});
        planner.banners.push({ id: uid(), mes, tipo:'Rebanner', nome, img, dias:14, t150:0, m100:0, cashback:0 });
      });
    }
    if (row.b2){
      const img = getBannerImage({nome: row.b2});
      planner.banners.push({ id: uid(), mes, tipo:'Banner 2', nome: row.b2, img, dias:14, t150:0, m100:0, cashback:0 });
    }
  }
}

// ===== Renderers =====
  function renderFree(){
    const tb = $('#tblFree tbody'); if(!tb) return;
    tb.innerHTML = '';
    planner.free.forEach((row, idx)=>{
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td><input type="checkbox" data-k="usar" ${row.usar?'checked':''}></td>
        <td class="col-System"><input type="text" data-k="nome" value="${row.nome}" title="${row.nome}"></td>
        <td><input type="number" data-k="qtd" min="0" step="1" value="${row.qtd}"></td>
        <td><select data-k="freq">${FREQS.map(f=>`<option ${f===row.freq?'selected':''}>${f}</option>`).join('')}</select></td>
        <td class="row-actions">
          <button class="btn light up">‚Üë</button>
          <button class="btn light down">‚Üì</button>
          <button class="btn del rm">üóë</button>
        </td>
      `;
      const onEdit = (e)=>{
        const k = e.target.getAttribute('data-k'); if(!k) return;
        if(k==='usar'){ planner.free[idx][k] = e.target.checked; }
        else if(k==='nome' || k==='freq'){ planner.free[idx][k] = e.target.value; if(k==='nome') e.target.title = e.target.value; }
        else { planner.free[idx][k] = +e.target.value || 0; }
        recalc();
      };
      tr.addEventListener('input', onEdit); tr.addEventListener('change', onEdit);
      tr.querySelector('.rm').onclick   = ()=>{ planner.free.splice(idx,1); renderFree(); recalc(); };
      tr.querySelector('.up').onclick   = ()=>{ if(idx>0){ const t=planner.free[idx-1]; planner.free[idx-1]=planner.free[idx]; planner.free[idx]=t; renderFree(); recalc(); } };
      tr.querySelector('.down').onclick = ()=>{ if(idx<planner.free.length-1){ const t=planner.free[idx+1]; planner.free[idx+1]=planner.free[idx]; planner.free[idx]=t; renderFree(); recalc(); } };
      tb.appendChild(tr);
    });
  }

  function renderCash(){
    const tb = $('#tblCash tbody'); if(!tb) return;
    tb.innerHTML = '';
    planner.cash.forEach((row, idx)=>{
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td><input type="checkbox" data-k="usar" ${row.usar?'checked':''}></td>
        <td class="col-System"><input type="text" data-k="nome" value="${row.nome}" title="${row.nome}"></td>
        <td><input type="number" data-k="porDia" min="0" step="1" value="${row.porDia}"></td>
        <td><input type="number" data-k="dias" min="0" step="1" value="${row.dias}"></td>
        <td class="row-actions">
          <button class="btn light up">‚Üë</button>
          <button class="btn light down">‚Üì</button>
          <button class="btn del rm">üóë</button>
        </td>
      `;
      const onEdit = (e)=>{
        const k = e.target.getAttribute('data-k'); if(!k) return;
        if(k==='usar'){ planner.cash[idx][k] = e.target.checked; }
        else if(k==='nome'){ planner.cash[idx][k] = e.target.value; e.target.title = e.target.value; }
        else { planner.cash[idx][k] = +e.target.value || 0; }
        recalc();
      };
      tr.addEventListener('input', onEdit); tr.addEventListener('change', onEdit);
      tr.querySelector('.rm').onclick   = ()=>{ planner.cash.splice(idx,1); renderCash(); recalc(); };
      tr.querySelector('.up').onclick   = ()=>{ if(idx>0){ const t=planner.cash[idx-1]; planner.cash[idx-1]=planner.cash[idx]; planner.cash[idx]=t; renderCash(); recalc(); } };
      tr.querySelector('.down').onclick = ()=>{ if(idx<planner.cash.length-1){ const t=planner.cash[idx+1]; planner.cash[idx+1]=planner.cash[idx]; planner.cash[idx]=t; renderCash(); recalc(); } };
      tb.appendChild(tr);
    });
  }
  
  function renderBanners(){
  // === helpers para normalizar m√™s (sem acento / min√∫sculo) e obter √≠ndice 1..12 ===
  const rmAccents = (s)=> String(s||'').normalize('NFD').replace(/[\u0300-\u036f]/g,'');
  const MONTH_INDEX = {
  // pt-BR
  "janeiro":1,"fevereiro":2,"marco":3,"mar√ßo":3,"abril":4,"maio":5,"junho":6,
  "julho":7,"agosto":8,"setembro":9,"outubro":10,"novembro":11,"dezembro":12,
  // en
  "january":1,"february":2,"march":3,"april":4,"may":5,"june":6,
  "july":7,"august":8,"september":9,"october":10,"november":11,"december":12
};
const norm = s => String(s||'')
  .normalize('NFD').replace(/[\u0300-\u036f]/g,'') // remove acento
  .trim().toLowerCase();
  // ‚Äî‚Äî‚Äî‚Äî‚Äî util para data de in√≠cio e rota√ß√£o de meses ‚Äî‚Äî‚Äî‚Äî‚Äî
function getPlanStartMonth(){
  const el = document.getElementById('planStartDate');
  if(!el || !el.value) return 8; // padr√£o August (ou ajuste)
  const dt = new Date(el.value + 'T00:00:00');
  const m = dt.getMonth()+1;
  return (m>=1 && m<=12) ? m : 8;
}
  // 1) setup padr√£o (mantido)
  
  const wrap = document.getElementById('bannersCards'); if(!wrap) return;
  wrap.innerHTML='';

  // 2) agrupar banners por m√™s (mantido)
  const byMonth={};
  (planner.banners||[]).forEach(b=>{
    if(!b||!b.mes) return;
    (byMonth[b.mes] ||= []).push(b);
  });

  // 3) determinar m√™s de in√≠cio a partir de #planStartDate (fallback = m√™s atual)
  let startMonth = (new Date()).getMonth() + 1; // 1..12
  const startEl = document.getElementById('planStartDate');
  if (startEl && startEl.value){
    const d = new Date(startEl.value + 'T00:00:00');
    if (!Number.isNaN(d.getTime())) startMonth = d.getMonth() + 1;
  }
  // usar a ordem cronol√≥gica definida na planilha (BANNER_SHEET) como linha do tempo
const monthsSeq = Object.keys(BANNER_SHEET);

// √çndice de in√≠cio = primeiro m√™s cujo n√∫mero (1..12) >= startMonth
let startIdx = monthsSeq.findIndex(m => PT_MONTH_INDEX[norm(m)] >= startMonth);
if (startIdx < 0) startIdx = 0;

// Da data inicial em diante (inclui January..June do ‚Äúpr√≥ximo ano‚Äù)
// e ainda filtra para manter s√≥ meses que realmente t√™m banners no dataset atual
const monthsToRender = monthsSeq.slice(startIdx).filter(m => byMonth[m]);

// ====== A partir daqui renderiza
monthsToRender.forEach(mes=>{
    const arr = byMonth[mes];
    const b1   = arr.find(x=>x.tipo==='Banner 1');
    const b2   = arr.find(x=>x.tipo==='Banner 2');
    const rebs = arr.filter(x=>x.tipo==='Rebanner'); // 0..2

    const group = document.createElement('div');
    group.className='month-group';
    group.innerHTML=`<div class="month-title">${mes}</div>`;

    const row = document.createElement('div');
    row.className='month-row';

    const mkLinesHTML = (b)=>{
      const t150 = +b.t150 || 0;
      const m100 = +b.m100 || 0;

      // cashback de Marchs e %: **apenas para tickets**
      const gastoTickets   = 150 * t150;
      const cbMilTickets   = cashbackMilestones(t150); // s√≥ tickets contam
      const cashbackPerc   = Math.round(gastoTickets * ((+b.cashback || 0)/100));
      const cashbackTotal  = (cbMilTickets.cashbackDiamonds || 0) + cashbackPerc;

      return `<div class="banner-lines">
        <span>Tickets: ${t150.toLocaleString('pt-BR')}</span>
        <span>Memories: ${m100.toLocaleString('pt-BR')}</span>
        <span>Cashback: ${cashbackTotal.toLocaleString('pt-BR')}</span>
      </div>`;
    };

    const mkCard=(b,label)=>{
      const el=document.createElement('div'); el.className='banner-card';
      const imgSrc=getBannerImage(b);
      el.innerHTML=`
        <h5>${label} ‚Ä¢ ${b.nome||''}</h5>
        ${imgSrc?`<img src="${imgSrc}" onerror="this.style.display='none'>`:
          `<div style="height:210px;border:1px dashed #444;border-radius:10px;display:flex;align-items:center;justify-content:center;opacity:.7">Sem imagem</div>`}
        <div class="banner-fields">
          <label>Tickets (150): <input type="number" class="planner-input" data-id="${b.id}" data-k="t150" min="0" step="1" value="${b.t150||0}"></label>
          <label>Memories (100): <input type="number" class="planner-input" data-id="${b.id}" data-k="m100" min="0" step="1" value="${b.m100||0}"></label>
        </div>
        ${mkLinesHTML(b)}
      `;
      el.querySelectorAll('input[data-id]').forEach(inp=>{
        inp.addEventListener('input', e=>{
          const it=planner.banners.find(x=>x.id===e.target.getAttribute('data-id'));
          if(!it) return; it[e.target.getAttribute('data-k')]=+e.target.value||0;
          const old=el.querySelector('.banner-lines');
          if(old){
            const tmp=document.createElement('div');
            tmp.innerHTML=mkLinesHTML(it);
            old.replaceWith(tmp.firstElementChild);
          }
          recalc();
        });
      });
      return el;
    };

    // Coluna esquerda: Banner 1
    const left=document.createElement('div');
    if(b1) left.appendChild(mkCard(b1,'Banner 1'));
    row.appendChild(left);

    // Coluna do meio: TODOS os rebanners LADO A LADO
    const mid=document.createElement('div'); mid.className='rebanners-row';
    rebs.forEach((rb,i)=>{
      const card=mkCard(rb, `Rebanner ${rebs.length>1?i+1:''}`.trim());
      card.classList.add('rebanner-card');
      mid.appendChild(card);
    });
    if(rebs.length) row.appendChild(mid); else row.appendChild(document.createElement('div')); // mant√©m 3 colunas

    // Coluna direita: Banner 2
    const right=document.createElement('div');
    if(b2) right.appendChild(mkCard(b2,'Banner 2'));
    row.appendChild(right);

    group.appendChild(row);
    wrap.appendChild(group);
  });
}






  // ===== C√°lculos =====
  function gainsFreePorDia(){
    let total = 0;
    planner.free.forEach(f=>{
      if(!f.usar) return;
      const q = +f.qtd || 0;
      switch(f.freq){
        case 'Daily': total += q; break;
        case 'Weekly': total += q/7; break;
        case 'Biweekly': total += q/14; break;
        case 'Monthly': total += q/30; break;
      }
    });
    return total;
  }

  function recalc(){ simular(); persistTemp(); }
// ===== Alternador de servidor: Jap√£o / China =====
const SERVER_KEYS = { JP: 'banners_JP', CN: 'banners_CN' };

// Inicializa os datasets por servidor.
// - Se ainda n√£o existir, semeia JP com a lista atual e CN como c√≥pia vazia (ou a atual, se preferir).
function initServerBanners(){
  // garante que planner existe
  window.planner = window.planner || {};
  if (!planner.server) planner.server = 'JP';

  // semear JP se vazio
  if (!localStorage.getItem(SERVER_KEYS.JP)) {
    localStorage.setItem(SERVER_KEYS.JP, JSON.stringify(planner.banners || []));
  }
  // semear CN se vazio (aqui come√ßo igual ao JP; depois voc√™ edita a ordem manualmente)
  if (!localStorage.getItem(SERVER_KEYS.CN)) {
    localStorage.setItem(SERVER_KEYS.CN, JSON.stringify(planner.banners || []));
  }

  // carrega o dataset do servidor ativo para planner.banners
  const activeKey = SERVER_KEYS[planner.server] || SERVER_KEYS.JP;
  try {
    const saved = JSON.parse(localStorage.getItem(activeKey) || '[]');
    planner.banners = Array.isArray(saved) ? saved : [];
  } catch {
    planner.banners = planner.banners || [];
  }

  // estado visual dos bot√µes
  document.getElementById('serverJPBtn')?.classList.toggle('active', planner.server === 'JP');
  document.getElementById('serverCNBtn')?.classList.toggle('active', planner.server === 'CN');
}

// Troca o servidor, salvando o dataset atual e carregando o outro.
function switchServer(s){
  if (!SERVER_KEYS[s]) return;
  if (!window.planner) return;

  // salva banners atuais no slot do servidor corrente
  const curKey = SERVER_KEYS[planner.server || 'JP'];
  try { localStorage.setItem(curKey, JSON.stringify(planner.banners || [])); } catch{}

  // carrega banners do novo servidor
  const nextKey = SERVER_KEYS[s];
  let next = [];
  try { next = JSON.parse(localStorage.getItem(nextKey) || '[]'); } catch{}
  planner.banners = Array.isArray(next) ? next : [];
  planner.server = s;

  // atualiza UI
  document.getElementById('serverJPBtn')?.classList.toggle('active', s === 'JP');
  document.getElementById('serverCNBtn')?.classList.toggle('active', s === 'CN');

  // re-render e recalcula
  if (typeof renderBanners === 'function') renderBanners();
  if (typeof recalc === 'function') recalc();
  if (typeof savePlanner === 'function') savePlanner(); // opcional
}
  // DEV: resetar dataset do servidor e reseed a partir da planilha atual
window.resetServer = function(s='JP'){
  const key = SERVER_KEYS[s] || SERVER_KEYS.JP;
  localStorage.removeItem(key);
  // re-semeia conforme init
  initServerBanners();
  renderBanners && renderBanners();
  recalc && recalc();
};
// Liga os bot√µes (chame ap√≥s montar o Planner)
function bindServerButtons(){
  document.getElementById('serverJPBtn')?.addEventListener('click', ()=>switchServer('JP'));
  document.getElementById('serverCNBtn')?.addEventListener('click', ()=>switchServer('CN'));
}

// >>> Em algum ponto da inicializa√ß√£o do Planner:

// (se j√° carrega banners antes, chame initServerBanners() logo depois)

  // meses pt-BR -> 1..12
const PT_MONTH_INDEX = {
  "January":1,"February":2,"March":3,"March":3,"April":4,"May":5,"June":6,
  "July":7,"August":8,"September":9,"October":10,"November":11,"December":12
};
const norm = s => String(s||'').trim().toLowerCase();
// Torna o mapa tolerante a mai√∫sc./min√∫sc. e acentos
(() => {
  const keys = Object.keys(PT_MONTH_INDEX);
  for (const k of keys) {
    const low = String(k).normalize('NFD').replace(/[\u0300-\u036f]/g,'').toLowerCase();
    PT_MONTH_INDEX[low] = PT_MONTH_INDEX[k];
  }
})();
// dias reais do m√™s (considera ano bissexto)
function daysInMonth(year, month1to12){
  return new Date(year, month1to12, 0).getDate();
}

// l√™ a data do input; se vazio, usa hoje
function getPlanStartDate(){
  const el = document.getElementById('planStartDate');
  const v = el && el.value ? new Date(el.value+'T00:00:00') : new Date();
  // zera hora
  return new Date(v.getFullYear(), v.getMonth(), v.getDate());
}

// atalho p/ ‚ÄúHoje‚Äù
(function bindStartToday(){
  const b = document.getElementById('startTodayBtn');
  const i = document.getElementById('planStartDate');
  if (b && i){
    b.addEventListener('click', ()=>{
      const now = new Date();
      i.value = `${now.getFullYear()}-${String(now.getMonth()+1).padStart(2,'0')}-${String(now.getDate()).padStart(2,'0')}`;
      if (typeof recalc === 'function') recalc();
    });
  }
  if (i){
    i.addEventListener('change', ()=>{ if (typeof recalc === 'function') recalc(); });
  }
})();

  function simular(){
  const tbody = $('#simTable tbody'); if(!tbody) return;
  tbody.innerHTML = '';

  // --- 0) saldos iniciais (cristais + tickets*150)
  // --- 0) saldos iniciais (cristais + tickets*150) ‚Äî com casting seguro
const num = (id)=> Math.max(0, +(document.getElementById(id)?.value || 0));
const saldoCristais = num('saldoInicial');
const saldoTickets  = num('ticketsInic') * 150;
let saldo = saldoCristais + saldoTickets;


  // --- 1) ordem cronol√≥gica de meses a partir dos banners
  const order = [];
  const seen = new Set();
  (planner.banners||[]).forEach(b=>{
    const m = norm(b.mes);
    if(m && !seen.has(m)){ seen.add(m); order.push(m); }
  });

  // --- 2) agrega GASTOS/CASHBACK/EXTRAS por m√™s (somando banners daquele m√™s)
  const byMonth = new Map();
  const extrasTot = { ssrBox:0, milk:0, copy:0 };

  (planner.banners||[]).forEach(b=>{
    const m = norm(b.mes); if(!m) return;
    if(!byMonth.has(m)){
      byMonth.set(m, { mes:m, gastoBruto:0, cashback:0, custoLiquido:0, extras:{ssrBox:0,milk:0,copy:0} });
    }
    const t150 = +b.t150 || 0;
    const m100 = +b.m100 || 0;

    // custo total continua somando tudo
  const gastoBruto  = 150*t150 + 100*m100;

// ‚ö†Ô∏è EXTRAS agora contam S√ì tickets (150), sem mem√≥rias (100)
  const cbMilExtras = cashbackMilestones(t150);

    // cashback s√≥ com tickets
    const cbMilTickets = cashbackMilestones(t150);
    const cashbackPerc = Math.round((150*t150) * ((+b.cashback || 0)/100));
    const cashback     = (cbMilTickets.cashbackDiamonds || 0) + cashbackPerc;

    const custoLiquido = gastoBruto - cashback;

    const mm = byMonth.get(m);
    mm.gastoBruto   += gastoBruto;
    mm.cashback     += cashback;
    mm.custoLiquido += custoLiquido;

    // extras somam pelos pulls totais
    mm.extras.ssrBox += (cbMilExtras.extras?.ssrBox || 0);
    mm.extras.milk   += (cbMilExtras.extras?.milk   || 0);
    mm.extras.copy   += (cbMilExtras.extras?.copy   || 0);

    extrasTot.ssrBox += (cbMilExtras.extras?.ssrBox || 0);
    extrasTot.milk   += (cbMilExtras.extras?.milk   || 0);
    extrasTot.copy   += (cbMilExtras.extras?.copy   || 0);
  });

  // --- 3) gains por m√™s (FREE + distribuir CASH a partir da data de in√≠cio)
  const gainDiaFREE = gainsFreePorDia();
  const start = getPlanStartDate();
  const startMonthIdx = start.getMonth()+1; // 1..12
  const startYear = start.getFullYear();

  // encontra o √≠ndice do 1¬∫ m√™s que coincide com a data de in√≠cio;
  // se n√£o encontrar, usa o primeiro da lista (m√™s cheio).
  let idxStart = order.findIndex(m => PT_MONTH_INDEX[String(m).trim().toLowerCase()] === startMonthIdx);
if (idxStart < 0) idxStart = 0; // fallback seguro

  if (idxStart === -1) idxStart = 0;

  // consumo de CASH: come√ßa na data de in√≠cio
  // N√ÉO queremos mais consumo estadoful:



  // ano/m√™s correntes para cada entrada da order (contabiliza virada de ano)
  let runningYear = startYear;
  let prevIdx = startMonthIdx;

  // totais
  let totalgains=0, totalGastoBruto=0, totalCashback=0, totalLiquido=0;

  for (let i=0;i<order.length;i++){
    const label = order[i];
    const mIdx = PT_MONTH_INDEX[String(label).trim().toLowerCase()] || 1;



    // avan√ßa o ano quando cruza December->January
    if (i === 0){
      // se a lista come√ßa antes do m√™s de in√≠cio, ajuste o ano para tr√°s
      // (opcional: pode deixar como est√°; n√£o afeta pr√≥-rata)
    } else if (prevIdx > mIdx){
      runningYear += 1;
    }
    prevIdx = mIdx;

    // dias do m√™s real
    const dim = daysInMonth(runningYear, mIdx);

    // se o m√™s √© anterior √† data de in√≠cio ‚Üí pula (sem gains, sem custos)
    // Obs: se N√ÉO quiser pular custos de meses anteriores, troque o 'continue' por 'activeDays=0'.
    if (i < idxStart){
      continue;
    }

    // dias ativos: pr√≥-rata no primeiro m√™s √∫til, cheios nos demais
    const activeDays = (i === idxStart)
      ? (mIdx === startMonthIdx ? Math.max(0, dim - (start.getDate() - 1)) : dim) // se o label for o mesmo m√™s da data
      : dim;

    // gains FREE + CASH desse m√™s (CASH consome 'activeDays' sequencialmente)
    // FREE do m√™s (mant√©m)
const gFree = Math.round(gainDiaFREE * activeDays);

// CASH do m√™s: Quantity (por dia) √ó min(Frequency, dias ativos no m√™s)
let gCash = 0;
(planner.cash || []).forEach(c=>{
  if(!c || !c.usar) return;

  // Compat: alguns planos antigos usam c.porDia; no UI atual, a coluna √© "Quantity" => c.qtd
  const perDay = (+c.qtd || +c.porDia || 0);

  // "Frequency" agora significa "dias ativos no m√™s" (ex.: 30 = m√™s inteiro)
  const diasAtivosNoMes = Math.min(activeDays, +c.dias || 0);

  gCash += perDay * diasAtivosNoMes;
});

const gains = gFree + Math.round(gCash);


    // custos agregados daquele m√™s (se n√£o houver, zero)
    const mm = byMonth.get(label) || { gastoBruto:0, cashback:0, custoLiquido:0 };

    // saldo
    const saldoIni = saldo;
    saldo = saldo + gains - mm.custoLiquido;

    // render linha
    const pretty = label.charAt(0).toUpperCase() + label.slice(1);
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${pretty}</td>
      <td class="right">${gains.toLocaleString('pt-BR')}</td>
      <td class="right">${(mm.gastoBruto||0).toLocaleString('pt-BR')}</td>
      <td class="right">${(mm.cashback||0).toLocaleString('pt-BR')}</td>
      <td class="right">${(mm.custoLiquido||0).toLocaleString('pt-BR')}</td>
      <td class="right">${saldoIni.toLocaleString('pt-BR')}</td>
      <td class="right">${saldo.toLocaleString('pt-BR')}</td>
    `;
    // pinta saldo final negativo
    const saldoCell = tr.querySelector('td:last-child');
    if (saldoCell) saldoCell.classList.toggle('neg', saldo < 0);

    tbody.appendChild(tr);

    // totais (se mantiver rodap√©)
    totalgains     += gains;
    totalGastoBruto += (mm.gastoBruto||0);
    totalCashback   += (mm.cashback||0);
    totalLiquido    += (mm.custoLiquido||0);
  }

  // atualiza rodap√© se voc√™ ainda estiver usando <tfoot> (se n√£o, pode remover)
  const el = (id)=>document.getElementById(id);
  if (el('tgains'))      el('tgains').textContent      = totalgains.toLocaleString('pt-BR');
  if (el('tGastoBruto'))  el('tGastoBruto').textContent  = totalGastoBruto.toLocaleString('pt-BR');
  if (el('tCashback'))    el('tCashback').textContent    = totalCashback.toLocaleString('pt-BR');
  if (el('tLiquido'))     el('tLiquido').textContent     = totalLiquido.toLocaleString('pt-BR');
  if (el('tSaldoFinal')){ el('tSaldoFinal').textContent  = saldo.toLocaleString('pt-BR');
                          el('tSaldoFinal').classList.toggle('neg', saldo < 0); }

  // extras (se estiver usando a caixa abaixo da tabela)
  const simEl = document.getElementById('simExtras');
  if (simEl) {
    simEl.innerHTML = `
      <div><b>Extras Totais</b> ‚Äî
        SSR Box: <b>${extrasTot.ssrBox}</b> ‚Ä¢
        Milk: <b>${extrasTot.milk}</b> ‚Ä¢
        Copy: <b>${extrasTot.copy}</b>
      </div>`;
  }
}


   

  // ===== Persist√™ncia =====
  function savePlan(name){
    const store = JSON.parse(localStorage.getItem(PLANS_KEY)||'{}');
    store[name] = JSON.parse(JSON.stringify(planner));
    localStorage.setItem(PLANS_KEY, JSON.stringify(store));
    fillSlots(name);
  }
  function loadPlan(name){
    const store = JSON.parse(localStorage.getItem(PLANS_KEY)||'{}');
    if(!store[name]) return;
    planner = JSON.parse(JSON.stringify(store[name]));
    $('#saldoInicial').value = planner.saldoInicial || 0;
    $('#nomePlano').value = name;
    renderFree(); renderCash(); renderBanners(); recalc();
  }
  function delPlan(name){
    const store = JSON.parse(localStorage.getItem(PLANS_KEY)||'{}');
    delete store[name];
    localStorage.setItem(PLANS_KEY, JSON.stringify(store));
  }
  function fillSlots(sel=''){
    const store = JSON.parse(localStorage.getItem(PLANS_KEY)||'{}');
    const sl = $('#slotsPlanos'); if(!sl) return;
    sl.innerHTML = '<option value="">(selecione um plano salvo)</option>';
    Object.keys(store).sort().forEach(k=>{
      const opt = document.createElement('option');
      opt.value = k; opt.textContent = k; if(k===sel) opt.selected = true; sl.appendChild(opt);
    });
  }
  function persistTemp(){
    const draft = JSON.parse(JSON.stringify(planner));
    try{ localStorage.setItem(DRAFT_KEY, JSON.stringify(draft)); }catch(e){}
  }
  function loadDraft(){
    try{
      const draft = JSON.parse(localStorage.getItem(DRAFT_KEY)||'null');
      if(draft){
        planner = draft;
        return true;
      }
    }catch(e){}
    return false;
  }

  // ===== Navega√ß√£o =====
  function showPlanner(){ document.body.classList.add('show-planner'); document.getElementById('pagePlanner').style.display='block';document.body.classList.add('planner-open');}
  function showBuilder(){ document.body.classList.remove('show-planner'); document.getElementById('pagePlanner').style.display='none';document.body.classList.remove('planner-open'); }

  window.hqShowPlanner = showPlanner;
  window.hqShowBuilder = showBuilder;


  
  // ===== Boot =====
  function boot(){
    {
  const btnOpenRanking = document.getElementById('btnOpenRanking');
  if (btnOpenRanking){
    btnOpenRanking.addEventListener('click', (ev)=>{
      ev.stopPropagation();
      document.body.classList.remove('show-planner');
      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
      const rankPg = document.getElementById('pageRanking');
      if (rankPg){ rankPg.classList.add('active'); rankPg.style.display='block'; }
     // 1) abre 7d por padr√£o (sem borbulhar)
document.getElementById('btnRank7d')?.dispatchEvent(new Event('click', { bubbles:false }));

// 2) rola suavemente at√© o bloco dos rankings (logo abaixo das sinergias)
requestAnimationFrame(()=> {
  // escolha autom√°tica do alvo (ajusta se voc√™ tiver um id espec√≠fico)
  const target =
    document.getElementById('pageRanking') ||
    document.getElementById('rankingPanels') ||
    document.getElementById('panelRank7d');

  if (!target) return;

  // compensa cabe√ßalho fixo, se existir
  const sticky =
    document.querySelector('.topbar, .header, #stickyHeader, .navbar, .nav-top');
  const isFixed = sticky && getComputedStyle(sticky).position === 'fixed';
  const offset = isFixed ? sticky.offsetHeight + 12 : 12;

  const y = target.getBoundingClientRect().top + window.pageYOffset - offset;
  window.scrollTo({ top: y, behavior: 'smooth' });
});
    });
  }

  // bot√µes internos do ranking
  (function(){
    const p7 = document.getElementById('panelRank7d');
    const pA = document.getElementById('panelRankAll');
    const pC = document.getElementById('panelRankChar');
    const showOnly = (panel) => [p7,pA,pC].forEach(p => p && (p.hidden = (p!==panel)));
    document.getElementById('btnRank7d') ?.addEventListener('click', ()=> showOnly(p7));
    document.getElementById('btnRankAll')?.addEventListener('click', ()=> showOnly(pA));
    document.getElementById('btnRankChar')?.addEventListener('click', ()=> showOnly(pC));
  })();
}
// Detecta pelo <html lang="...">, com override poss√≠vel por window.SITE_LANG
const SITE_LANG = (window.SITE_LANG || document.documentElement.lang || 'pt-BR').toLowerCase();
// Nome da aba no Sheets
const COMMENTS_SHEET = SITE_LANG.startsWith('pt') ? 'commentsPTBR' : 'commentsEN';
    const btnOpen = document.getElementById('openPlannerBtn'); if(btnOpen) btnOpen.addEventListener('click', showPlanner);
    {
  const srcBtn = document.getElementById('openPlannerBtn')    // use o que j√° tem estilizado
             || document.querySelector('#sidebar button, #sidebar .menu-btn');
  const dstBtn = document.getElementById('btnOpenRanking');
  if (srcBtn && dstBtn){
    dstBtn.className = srcBtn.className;   // üîÅ copia as MESMAS classes
    // se o src tiver um wrapper espec√≠fico (ex.: display:block 100%), copie tamb√©m estilos inline √∫teis
    if (srcBtn.style.width)  dstBtn.style.width  = srcBtn.style.width;
    if (srcBtn.style.display)dstBtn.style.display= srcBtn.style.display;
  }
}
    const btnBack = document.getElementById('btnVoltarBuilder'); if(btnBack) btnBack.addEventListener('click', showBuilder);
    


    const btnToggle = document.getElementById('toggleSources');
    if(btnToggle){ btnToggle.addEventListener('click', ()=> setCollapsed(!document.body.classList.contains('planner-collapsed'))); }
    const btnReopen = document.getElementById('reopenSources');
    if(btnReopen){ btnReopen.addEventListener('click', ()=> setCollapsed(false)); }
    const prev = localStorage.getItem(COLLAPSE_KEY);

  // === Toggle "Meme Version" no topo, ao lado do + Team ===
(function placeTopMemeToggle(){
  const addBtn = document.getElementById('addTeamBtn');
  if (!addBtn || document.getElementById('memeToggleTop')) return; // j√° colocado

  const wrap = document.createElement('div');
  wrap.style.display = 'inline-flex';
  wrap.style.alignItems = 'center';
  wrap.style.gap = '10px';
  wrap.style.marginLeft = '10px';

  const label = document.createElement('label');
  label.style.display = 'inline-flex';
  label.style.alignItems = 'center';
  label.style.gap = '6px';
  label.innerHTML = `
    <input id="memeToggleTop" type="checkbox" ${window.MEME_VERSION_ON ? 'checked' : ''}>
    <div>Personagens da Comunidade</div>
  `;

  // Insere imediatamente depois do bot√£o + Team
  addBtn.parentNode.insertBefore(wrap, addBtn.nextSibling);
  wrap.appendChild(label);

  // Listener do toggle do topo
  const top = label.querySelector('#memeToggleTop');
  top.addEventListener('change', (e)=>{
    window.MEME_VERSION_ON = !!e.target.checked;
syncCharactersWithToggle(); // atualiza lista global "characters"
updateWinDiamondsBtn();

// se a lista do grid estiver aberta, reconstr√≥i imediatamente
if (isGridMenuOpen()) {
  refreshGridMenu();
}

// manter os dois toggles sincronizados
const otherId = this.id === 'memeToggle' ? 'memeToggleTop' : 'memeToggle';
const other = document.getElementById(otherId);
if (other && other.checked !== window.MEME_VERSION_ON) {
  other.checked = window.MEME_VERSION_ON;
}


    // Se a aba Characters estiver aberta, re-renderiza
    if (document.getElementById('charList')) {
      showCharacterList();
    }

    // Sincroniza com o toggle da lateral (se existir)
    const side = document.getElementById('memeToggle');
    if (side && side.checked !== window.MEME_VERSION_ON) side.checked = window.MEME_VERSION_ON;
  });
})();

// 1¬™ visita: mant√©m colapsado; visitas seguintes: respeita o salvo
if (prev === null) {
  setCollapsed(true);
} else {
  setCollapsed(prev === '1');
}


    const saldoEl = document.getElementById('saldoInicial'); if(saldoEl) saldoEl.addEventListener('input', ()=>{ planner.saldoInicial = +(saldoEl.value||0); recalc(); });
    const nomeEl  = document.getElementById('nomePlano');    if(nomeEl)  nomeEl.addEventListener('input', ()=>{ planner.nomePlano = nomeEl.value||''; persistTemp(); });
    
    const bSave = document.getElementById('btnSalvarPlano'); if(bSave) bSave.addEventListener('click', ()=>{
      const name = (document.getElementById('nomePlano').value||'').trim() || 'Plano';
      savePlan(name);
    });
    const bNovo = document.getElementById('btnNovoPlano'); if(bNovo) bNovo.addEventListener('click', ()=>{
      planner = { saldoInicial:0, nomePlano:'', free:JSON.parse(JSON.stringify(DEFAULT_FREE)), cash:JSON.parse(JSON.stringify(DEFAULT_CASH)), banners:[] };
      document.getElementById('saldoInicial').value = 0; document.getElementById('nomePlano').value='';
      seedBannersFromSheet();
      // 1) garante dados base (JP) em mem√≥ria
if (!planner.banners || !planner.banners.length) seedBannersFromSheet();


      renderFree(); renderCash(); renderBanners(); recalc(); fillSlots(''); persistTemp();
    });
    const bDel = document.getElementById('btnExcluirPlano'); if(bDel) bDel.addEventListener('click', ()=>{
      const sel = document.getElementById('slotsPlanos').value; if(sel){ delPlan(sel); fillSlots(''); }
    });
    const slots = document.getElementById('slotsPlanos'); if(slots) slots.addEventListener('change', (e)=>{ const name = e.target.value; if(name) loadPlan(name); });

    const hadDraft = loadDraft();
    if(!hadDraft || !planner.banners || planner.banners.length===0 ||
       (planner.banners.length===1 && /^Novo Banner$/i.test(planner.banners[0]?.nome||'')) ){
      seedBannersFromSheet();
    }

    fillSlots(planner?.nomePlano || '');
    initServerBanners();     // <‚Äî COLE AQUI
    bindServerButtons();
    renderFree(); renderCash(); renderBanners(); recalc();
  }
  // === BIND: + Fonte FREE / + Fonte CASH ===
const $addFree = document.getElementById('addFree');
if ($addFree) {
  $addFree.addEventListener('click', () => {
    // linha nova FREE (usar/nome/qtd/freq)
    planner.free = planner.free || [];
    planner.free.push({ usar: true, nome: 'Nova fonte FREE', qtd: 0, freq: 'Monthly' });
    renderFree && renderFree();
    recalc && recalc();
    savePlanner && savePlanner();
  });
}

const $addCash = document.getElementById('addCash');
if ($addCash) {
  $addCash.addEventListener('click', () => {
    // linha nova CASH (usar/nome/diamantes por dia/dias)
    planner.cash = planner.cash || [];
    planner.cash.push({ usar: true, nome: 'Nova fonte CASH', qtd: 0, dias: 30 });
    renderCash && renderCash();
    recalc && recalc();
    savePlanner && savePlanner();
  });
}

  if(document.readyState==='loading') document.addEventListener('DOMContentLoaded', boot);
  else boot();

})();
/* ==================== STATS BONDS ‚Äì infra (revamp) ==================== */

/** 3.1) Nomes dos titulares do grid principal */
/** titulares + banco: quem pode aparecer listado no modal */
function getPresentTeamNames(){
  const main  = [...document.querySelectorAll('.hex')].map(s => s.dataset?.nome).filter(Boolean);
  const bench = [...document.querySelectorAll('.bench-slot')].map(s => s.dataset?.nome).filter(Boolean);
  return new Set([...main, ...bench]);
}

/** personagens salvos na conta (localStorage) */
const OWNED_KEY = 'hqOwnedCharsV2';
function loadOwned(){ try{ return new Set(JSON.parse(localStorage.getItem(OWNED_KEY)||'[]')); }catch(e){ return new Set(); } }
function saveOwned(set){ localStorage.setItem(OWNED_KEY, JSON.stringify([...set])); }
function clearOwned(){ localStorage.removeItem(OWNED_KEY); }

/** conjunto para ATIVA√á√ÉO: time (quadra+banco) + conta */
function getActivationSet(){
  const present = getPresentTeamNames();
  const owned   = loadOwned();
  return new Set([...present, ...owned]);
}

/** 3.2) Fonte de dados (segue igual: window.STATS_BONDS = {...}) */
const STATS_BONDS = (typeof window !== 'undefined' && window.STATS_BONDS) ? window.STATS_BONDS : {};

/** 3.3) (fallback opcional ‚Äî mant√©m se quiser) */
if (!Object.keys(STATS_BONDS).length){
  window.STATS_BONDS = {
    "Team's Guardians": { "Nishinoya SSR": "Receive +5/7/9/12/15, Receive +1/2/3/4/5%", "Yaku SSR": "Receive +5/7/9/12/15, Receive +1/2/3/4/5%" },
    "Karasuno's Setters": { "Sugawara SP": "Toss +5/7/9/12/15, Toss +1/2/3/4/5%", "Kageyama UR": "" }
  };
}

/** 3.4) Extrai v√≠nculos de stats ‚Äúativos‚Äù considerando titulares + conta */
function getActiveStatBonds(){
  const presentForList = getPresentTeamNames();   // quadra + banco (para mostrar)
  const activationSet  = getActivationSet();      // time + conta (para ativar)

  const out = [];

  for (const [bondName, mapping] of Object.entries(window.STATS_BONDS || {})){
    const allMembers = Object.keys(mapping);

    // Quem ativa (time + conta)
    const activators = allMembers.filter(k => activationSet.has(k));
    if (activators.length < 2) continue;

    // Quem aparece (somente time)
    const listed   = allMembers.filter(k => presentForList.has(k));
    if (listed.length === 0) continue;

    // Quem n√£o est√° aparecendo (fora do time)
    const missing  = allMembers.filter(k => !presentForList.has(k));

    const toEntry = (name)=>({
      name,
      buff: mapping[name] || '',
      img: (characters.find(p => p.nome === name) || {}).img || ''
    });

    out.push({
      bondName,
      entries: listed.map(toEntry),
      missing: missing.map(toEntry)
    });
  }

  out.sort((a,b)=> a.bondName.localeCompare(b.bondName));
  return out;
}

  
/** 3.5) Picker ‚ÄúPersonagens da conta‚Äù (multi-sele√ß√£o com busca) */
function openOwnedPicker(){
  const owned = loadOwned();
  const allChars = (Array.isArray(characters) ? characters.slice() : []).sort((a,b)=>a.nome.localeCompare(b.nome));

  const backdrop = document.createElement('div'); backdrop.className = 'item-modal-backdrop';
  const box = document.createElement('div'); box.className = 'item-modal';
  backdrop.appendChild(box);

  box.innerHTML = `
    <h3>Adicionar Personagens da conta</h3>
    <div style="display:flex;gap:8px;align-items:center;margin:6px 0;">
      <input id="ownedSearch" placeholder="Pesquisar..." style="flex:1;padding:6px;">
      <button id="ownedAll"   class="item-btn" type="button">All</button>
      <button id="ownedClear" class="item-btn" type="button">Clear</button>
    </div>
    <div id="ownedGrid" class="owned-picker"></div>
    <div class="item-actions">
      <button id="ownedCancel" class="item-btn">Cancelar</button>
      <button id="ownedSave"   class="item-btn">Salvar</button>
    </div>
  `;

  const render = (term='')=>{
    const t = term.trim().toLowerCase();
    const grid = box.querySelector('#ownedGrid');
    grid.innerHTML = allChars
      .filter(c => !t || c.nome.toLowerCase().includes(t))
      .map(c => `
        <label class="owned-card">
          <img class="stats-char-thumb" src="${c.img}" alt="">
          <span>${c.nome}</span>
          <input type="checkbox" data-name="${c.nome}" ${owned.has(c.nome)?'checked':''}>
        </label>
      `).join('');
  };
  render();

  const markAll = (state)=>{
    box.querySelectorAll('input[type="checkbox"][data-name]').forEach(cb => cb.checked = state);
  };

  box.querySelector('#ownedSearch').addEventListener('input', e=>render(e.target.value));
  box.querySelector('#ownedAll').addEventListener('click',   ()=> markAll(true));
  box.querySelector('#ownedClear').addEventListener('click', ()=> markAll(false));

  box.querySelector('#ownedCancel').addEventListener('click', ()=>backdrop.remove());
  box.querySelector('#ownedSave').addEventListener('click', ()=>{
    const picked = new Set(
      [...box.querySelectorAll('input[type="checkbox"][data-name]')]
        .filter(i=>i.checked).map(i=>i.dataset.name)
    );
    saveOwned(picked);
    backdrop.remove();
    // Reabre o modal de Stat Bonds j√° com o c√°lculo novo (time + conta)
    openStatsBondsModal();
  });

  document.body.appendChild(backdrop);
}

/** 3.6) Modal de listagem (com imagens + a√ß√µes) */
function openStatsBondsModal(){
  const list = getActiveStatBonds();

  const backdrop = document.createElement('div');
  backdrop.className = 'item-modal-backdrop';

  const modal = document.createElement('div');
  modal.className  = 'item-modal';

  let html = `<h3>Active Stats Bonds (${list.length})</h3>`;

  if (list.length === 0){
    html += `<p style="opacity:.85">No stats bonds are active in main court, add characters to the account</p>`;
  } else {
    html += `<div class="stats-bond-list">`;
    list.forEach((b, i) => {
      html += `
        <div class="stats-bond-item">
          <div class="stats-bond-head">
            <h4>${b.bondName}</h4>
            ${b.missing.length ? `<button class="see-details-btn" data-bond-id="${i}">See details</button>` : ``}
          </div>
          <ul>
            ${b.entries.map(e => `
              <li>
                ${e.img ? `<img class="stats-char-thumb" src="${e.img}" alt="${e.name}">` : ''}
                <b>${e.name}</b> ‚Äî ${e.buff && e.buff.trim() ? e.buff : '<em>sem buff</em>'}
              </li>
            `).join('')}
          </ul>

          ${b.missing.length ? `
            <ul class="missing-list" data-bond-id="${i}" style="display:none;">
              ${b.missing.map(e => `
                <li class="missing-char">
                  ${e.img ? `<img class="stats-char-thumb" src="${e.img}" alt="${e.name}">` : ''}
                  <b>${e.name}</b> ‚Äî ${e.buff && e.buff.trim() ? e.buff : '<em>sem buff</em>'}
                </li>
              `).join('')}
            </ul>
          ` : ``}
        </div>
      `;
    });
    html += `</div>`;
  }

  html += `
    <div class="item-actions">
      <button id="addOwnedBtn" class="item-btn">Add Characters to your Account</button>
      <button id="clearOwnedBtn" class="item-btn">Clear All</button>
      <button id="closeStatsModal" class="item-btn">Close</button>
    </div>`;
  modal.innerHTML = html;

  backdrop.appendChild(modal);
  document.body.appendChild(backdrop);
  document.body.classList.add('modal-open');

  const close = ()=>{ document.body.classList.remove('modal-open'); backdrop.remove(); };
  backdrop.addEventListener('click', (e)=>{ if (e.target === backdrop) close(); });
  modal.querySelector('#closeStatsModal').addEventListener('click', close);

  // ‚ÄúConta‚Äù
  modal.querySelector('#addOwnedBtn').addEventListener('click', ()=>{
    close(); openOwnedPicker();
  });
  modal.querySelector('#clearOwnedBtn').addEventListener('click', ()=>{
    if (confirm('Limpar todos os personagens da conta?')){ clearOwned(); close(); openStatsBondsModal(); }
  });

  // Toggle See details / Hide details
  modal.querySelectorAll('.see-details-btn').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      const id = btn.dataset.bondId;
      const block = modal.querySelector(`.missing-list[data-bond-id="${id}"]`);
      const isHidden = !block || block.style.display === 'none';
      if (block){
        block.style.display = isHidden ? 'block' : 'none';
        btn.textContent = isHidden ? 'Hide details' : 'See details';
      }
    });
  });
}

/** 3.7) Liga o bot√£o do painel (id="statsBondBtn") */
(function bindStatsBondButton(){
  const btn = document.getElementById('statsBondBtn');
  if (btn && !btn.__sbBound){
    btn.__sbBound = true;
    btn.addEventListener('click', ()=>{
      if (!window.STATS_BONDS || !Object.keys(window.STATS_BONDS).length){
        alert('Nenhum mapeamento de "stats bonds" foi carregado. Defina window.STATS_BONDS = {...} antes.');
        return;
      }
      openStatsBondsModal();
    });
  }
})();
(() => {
  const btn = document.getElementById('openPlannerBtn');
  if (btn) btn.classList.add('bond-btn','menu-link');
})();

(function bindInitials(){
  const t   = document.getElementById('ticketsInic');
  const out = document.getElementById('ticketsInicCrystals');
  if (t && out){
    const upd = ()=>{
      const v = Math.max(0, +t.value || 0);
      out.textContent = (v * 150).toLocaleString('pt-BR');
    };
    const fire = ()=>{ upd(); recalc && recalc(); };
    t.addEventListener('input',  fire);
    t.addEventListener('change', fire);   // <‚Äî garante rec√°lculo em todos os casos
    fire();                               // <‚Äî recalc j√° na carga
  }
  const totalOut = document.getElementById('saldoInicialTotal');
if (totalOut && t){
  const s = document.getElementById('saldoInicial');
  const updTotal = ()=>{
    const saldo = (Math.max(0, +s?.value||0)) + (Math.max(0, +t.value||0) * 150);
    totalOut.textContent = saldo.toLocaleString('pt-BR');
  };
  t.addEventListener('input',  updTotal);
  t.addEventListener('change', updTotal);
  s?.addEventListener('input',  updTotal);
  s?.addEventListener('change', updTotal);
  updTotal();
}


  const s = document.getElementById('saldoInicial');
  if (s){
    const fire = ()=>{ recalc && recalc(); };
    s.addEventListener('input',  fire);
    s.addEventListener('change', fire);
  }
})();

// ===== Modal de Recursos (FREE/CASH) =====
(function(){
  const openBtn   = document.getElementById('openSourcesBtn');
  const modal     = document.getElementById('sourcesModal');
  const closeBtn  = document.getElementById('closeSourcesBtn');
  const bodySlot  = document.getElementById('sourcesModalBody');

  if(!openBtn || !modal || !bodySlot) return;

  let prevParent = null, prevNext = null; // onde devolver o painel ao fechar

  function openSourcesModal(){
  document.body.classList.remove('planner-collapsed');

  const panel = document.querySelector('.panel.sources');
  if(panel){
    prevParent = panel.parentNode;
    prevNext   = panel.nextSibling;
    bodySlot.appendChild(panel);
    panel.style.removeProperty('display');

    // ESCONDE o bot√£o antigo de fechar/minimizar quando o painel est√° na modal
    const oldToggle = panel.querySelector('#toggleSources');
    if (oldToggle) oldToggle.style.display = 'none';
  }
  modal.classList.add('open');
  document.body.classList.add('modal-open');
  closeBtn?.focus();
}



  function closeSourcesModal(){
  const panel = document.querySelector('.modal-body .panel.sources');
  if (panel && prevParent){
    if (prevNext) prevParent.insertBefore(panel, prevNext);
    else          prevParent.appendChild(panel);
    panel.style.display = 'none';          // mant√©m oculto no layout base
    const oldToggle = panel.querySelector('#toggleSources');
    if (oldToggle) oldToggle.style.display = 'none'; // evita UI antiga
  }
  modal.classList.remove('open');
  document.body.classList.remove('modal-open');
}


  openBtn.addEventListener('click', openSourcesModal);
  closeBtn?.addEventListener('click', closeSourcesModal);

  // clicar fora fecha
  modal.addEventListener('click', (e)=>{
    if(e.target && e.target.getAttribute('data-close')) closeSourcesModal();
  });

  // ESC fecha
  document.addEventListener('keydown', (e)=>{
    if(e.key === 'Escape' && modal.classList.contains('open')) closeSourcesModal();
  });
})();

// forma esperada dos itens (exemplo m√≠nimo):
// { id, mes: 'September', tipo: 'Banner 1'|'Banner 2'|'Rebanner', nome: 'Oikawa UR', t150:0, m100:0, cashback:0 }

// forma esperada dos itens (exemplo m√≠nimo):
// { id, mes: 'September', tipo: 'Banner 1'|'Banner 2'|'Rebanner', nome: 'Oikawa UR', t150:0, m100:0, cashback:0 }

(function setCNOrder(){
  const cnList = [
  { id:'cn-August-banner-1-ushijima-ur', mes:'August',   tipo:'Banner 1', nome:'Ushijima UR',    t150:0, m100:0, cashback:0 },
  { id:'cn-August-banner-2-kuro-ur',     mes:'August',   tipo:'Banner 2', nome:'Kuro UR',        t150:0, m100:0, cashback:0 },

  { id:'cn-September-banner-1-oikawa-ur', mes:'September', tipo:'Banner 1', nome:'Oikawa UR',      t150:0, m100:0, cashback:0 },
  { id:'cn-September-banner-2-bokuto-ur', mes:'September', tipo:'Banner 2', nome:'Bokuto UR',      t150:0, m100:0, cashback:0 },

  { id:'cn-October-banner-1-miya-atsumu-ur', mes:'October', tipo:'Banner 1', nome:'Miya Atsumu UR', t150:0, m100:0, cashback:0 },
  { id:'cn-October-rebanner-1-Kuro-ur',     mes:'October', tipo:'Rebanner', nome:'Kuro UR',       t150:0, m100:0, cashback:0 },
  { id:'cn-October-banner-2-miya-osamu-ur',  mes:'October', tipo:'Banner 2', nome:'Miya Osamu UR',  t150:0, m100:0, cashback:0 },

  { id:'cn-November-banner-1-Hoshiumi-ur',   mes:'November', tipo:'Banner 1', nome:'Hoshiumi UR',       t150:0, m100:0, cashback:0 },
  { id:'cn-November-banner-2-hirugami-ur',mes:'November', tipo:'Banner 2', nome:'Hirugami UR',    t150:0, m100:0, cashback:0 },

  { id:'cn-December-banner-1-kageyama-ur', mes:'December', tipo:'Banner 1', nome:'Kageyama UR',   t150:0, m100:0, cashback:0 },
  { id:'cn-December-rebanner-1-oikawa-ur', mes:'December', tipo:'Rebanner', nome:'Oikawa UR',     t150:0, m100:0, cashback:0 },
  { id:'cn-December-banner-2-hinata-sp',   mes:'December', tipo:'Banner 2', nome:'Hinata SP',     t150:0, m100:0, cashback:0 },

  { id:'cn-January-banner-1-kenma-sp',     mes:'January', tipo:'Banner 1', nome:'Kenma SP',       t150:0, m100:0, cashback:0 },
  { id:'cn-January-banner-2-nishinoya-sp', mes:'January', tipo:'Banner 2', nome:'Nishinoya SP',   t150:0, m100:0, cashback:0 },

  { id:'cn-February-banner-1-sugawara-sp', mes:'February', tipo:'Banner 1', nome:'Sugawara SP', t150:0, m100:0, cashback:0 },
  { id:'cn-February-banner-2-bokuto-sp',   mes:'February', tipo:'Banner 2', nome:'Bokuto SP',   t150:0, m100:0, cashback:0 },

  { id:'cn-March-banner-1-akaashi-sp',  mes:'March', tipo:'Banner 1', nome:'Akaashi SP',         t150:0, m100:0, cashback:0 },
  { id:'cn-March-banner-2-aone-sp',     mes:'March', tipo:'Banner 2', nome:'Aone SP',            t150:0, m100:0, cashback:0 },

  { id:'cn-April-banner-1-Sakusa-ur', mes:'April', tipo:'Banner 1', nome:'Sakusa UR',    t150:0, m100:0, cashback:0 },
  { id:'cn-April-banner-2-komori-ur',     mes:'April', tipo:'Banner 2', nome:'Komori UR',        t150:0, m100:0, cashback:0 },

  { id:'cn-May-banner-1-tsuki-sp',  mes:'May', tipo:'Banner 1', nome:'Tsuki SP',               t150:0, m100:0, cashback:0 },
  { id:'cn-May-banner-2-kuro-sp',   mes:'May', tipo:'Banner 2', nome:'Kuro SP',                t150:0, m100:0, cashback:0 },

  { id:'cn-June-banner-1-kunimi-sp',      mes:'June', tipo:'Banner 1', nome:'Kunimi SP',       t150:0, m100:0, cashback:0 },
  { id:'cn-June-banner-2-koganegawa-sp',  mes:'June', tipo:'Banner 2', nome:'Koganegawa SP',   t150:0, m100:0, cashback:0 },
];

// salvar & aplicar na UI (CN)
localStorage.setItem('banners_CN', JSON.stringify(cnList));
if (window.planner){
  planner.server = 'CN';
  planner.banners = cnList.slice();
  renderBanners && renderBanners();
  recalc && recalc();
  savePlanner && savePlanner();
}
})();

// === 3.1 TABELA "PURA" por raridade (seus dados) ===
const XP_PURE = {
  "N":   { "1-20":15200,  "20-40":139840, "40-60":552000, "60-70":410400, "70-80":454000 },
  "R":   { "1-20":15200,  "20-40":139840, "40-60":552000, "60-70":410400, "70-80":454000 },
  "SR":  { "1-20":17388,  "20-40":157320, "40-60":621000, "60-70":461700, "70-80":510750 },
  "SSR": { "1-20":19320,  "20-40":174800, "40-60":690000, "60-70":513000, "70-80":567500 },
  "UR":  { "1-20":19320,  "20-40":174800, "40-60":690000, "60-70":513000, "70-80":567500 },
};

// === 3.2 Bases para fabricar foods (assumindo usar N) ===
const B20 = 15200, B40 = 155040, B60 = 707040;
const C3 = B20;                         // 1 food 3‚òÖ (N)
const C4 = B40 + 3*B20;                 // 1 food 4‚òÖ (N)
const C5 = B60 + 3*(B40 + 3*B20);       // 1 food 5‚òÖ (N)

// === 3.3 Utilit√°rios ===
const LV_STEPS = [1,20,40,60,70,80];

// thresholds e ‚Äúestrela‚Äù ap√≥s a ascens√£o
const THRESHOLDS = [
  { lv:20, star:3, need: () => ({need3:0, need4:0, need5:0, add2:2}) }, // 2√ó2‚òÖ (XP=0)
  { lv:40, star:4, need: () => ({need3:3, need4:0, need5:0, add2:0}) }, // 3√ó3‚òÖ
  { lv:60, star:5, need: () => ({need3:0, need4:3, need5:0, add2:0}) }, // 3√ó4‚òÖ
  { lv:70, star:6, need: () => ({need3:0, need4:0, need5:4, add2:0}) }, // 4√ó5‚òÖ
];

function sumCharacterXP(rarity, from, to){
  const t = XP_PURE[rarity];
  let xp = 0;
  const idxFrom = LV_STEPS.indexOf(from);
  const idxTo   = LV_STEPS.indexOf(to);
  for (let i=idxFrom; i<idxTo; i++){
    const a = LV_STEPS[i], b = LV_STEPS[i+1];
    const key = `${a}-${b}`;
    xp += t[key];
  }
  return xp;
}

function sumCharacterXP(rarity, from, to){
  const t = XP_PURE[rarity];
  let xp = 0;
  const idxFrom = LV_STEPS.indexOf(from);
  const idxTo   = LV_STEPS.indexOf(to);
  for (let i=idxFrom; i<idxTo; i++){
    const a = LV_STEPS[i], b = LV_STEPS[i+1];
    xp += t[`${a}-${b}`];
  }
  return xp;
}

// S√≥ cobra ascens√£o em p se To > p e (From < p ou (From==p e !alreadyAtP))
function foodsRequiredOnPath(from, to, alreadyAtP){
  const need = { need3:0, need4:0, need5:0, base2:0 };
  for (const t of THRESHOLDS){
    if (to > t.lv && (from < t.lv || (from === t.lv && !alreadyAtP))){
      const add = t.need();
      need.need3 += add.need3 || 0;
      need.need4 += add.need4 || 0;
      need.need5 += add.need5 || 0;
      need.base2 += add.add2 || 0; // 2√ó2‚òÖ da ascens√£o de 20
    }
  }
  return need;
}

function base2Needed(need3, need4, need5){
  // 3‚òÖ = 2√ó2‚òÖ; 4‚òÖ = 3√ó(2√ó2‚òÖ)=6√ó2‚òÖ; 5‚òÖ = 3√ó(6√ó2‚òÖ)=18√ó2‚òÖ
  return need3*2 + need4*6 + need5*18;
}

function updateAlreadyUI(){
  const from = parseInt(document.getElementById('xpFrom').value,10);
  const wrap = document.getElementById('alreadyWrap');
  const lab  = document.getElementById('alreadyLabel');
  const cb   = document.getElementById('alreadyAsc');

  const map = {20:3, 40:4, 60:5, 70:6};
  if (map[from]){
    wrap.style.display = '';
    lab.textContent = `Already ${map[from]}‚òÖ at Lv.${from}?`;
  } else {
    wrap.style.display = 'none';
    cb.checked = false;
  }
}


function compute(){
  const rare = document.getElementById('xpRare').value;
  const from = parseInt(document.getElementById('xpFrom').value,10);
  const to   = parseInt(document.getElementById('xpTo').value,10);
  const already = document.getElementById('alreadyAsc').checked;

  if (LV_STEPS.indexOf(from) >= LV_STEPS.indexOf(to)) {
    document.getElementById('resTotalXp').textContent = '‚Äî';
    document.getElementById('resNeed2').textContent   = '‚Äî';
    document.getElementById('resBreak').textContent   = 'Select a valid range.';
    return;
  }

  const have5 = Math.max(0, parseInt(document.getElementById('have5').value||'0',10));
  const have4 = Math.max(0, parseInt(document.getElementById('have4').value||'0',10));
  const have3 = Math.max(0, parseInt(document.getElementById('have3').value||'0',10));
  const have2 = Math.max(0, parseInt(document.getElementById('have2').value||'0',10));

  const charXP = sumCharacterXP(rare, from, to);

  // (TRECHO NOVO ‚Äî ADICIONAR)
const req0 = foodsRequiredOnPath(from, to, already); // req0.need3/need4/need5 e req0.base2(2‚òÖ de 20)
let need3 = req0.need3;
let need4 = req0.need4;
let need5 = req0.need5;

// 1) Consumir 5‚òÖ prontos para cobrir need5 (n√£o h√° XP aqui)
const rem5 = Math.max(0, need5 - have5);

// 2) 4‚òÖ necess√°rios = need4 (da ascens√£o 60) + 3 por cada 5‚òÖ faltante
const need4_total = need4 + 3*rem5;

// Consumir 4‚òÖ prontos
const used4 = Math.min(have4, need4_total);
const rem4  = need4_total - used4; // 4‚òÖ que ainda precisam ser FABRICADOS

// 3) 3‚òÖ necess√°rios = need3 (da ascens√£o 40) + 3 por cada 4‚òÖ a fabricar
const need3_total = need3 + 3*rem4;

// Consumir 3‚òÖ prontos
const used3 = Math.min(have3, need3_total);
const rem3  = need3_total - used3; // 3‚òÖ que ainda precisam ser FABRICADOS

// 4) 2‚òÖ necess√°rios = 2 do threshold 20 (se aplic√°vel) + 2 por cada 3‚òÖ a fabricar
const need2Total = (req0.base2 || 0) + 2*rem3;

// 5) XP das foods a FABRICAR (apenas o que realmente falta fazer)
// - cada 5‚òÖ que SOBROU exige 1 base que vai at√© 60 ‚Üí B60
// - cada 4‚òÖ a fabricar exige 1 base que vai at√© 40 ‚Üí B40
// - cada 3‚òÖ a fabricar exige 1 base que vai at√© 20 ‚Üí B20
const xpFoods = rem5*B60 + rem4*B40 + rem3*B20;

// 6) Faltam 2‚òÖ?
const missing2 = Math.max(0, need2Total - have2);


  const totalXP = charXP + xpFoods;

  document.getElementById('resTotalXp').textContent = totalXP.toLocaleString();
  document.getElementById('resNeed2').textContent   = missing2.toLocaleString();
  document.getElementById('resBreak').innerHTML =
  `<span class="muted">Personagem: ${charXP.toLocaleString()} | Foods XP: ${xpFoods.toLocaleString()} `
  + `| Calculos depois de usar suas foods ‚Üí 3‚òÖ para craftar: ${rem3}, 4‚òÖ para craftar: ${rem4}, 5‚òÖ para craftar: ${rem5} `
  + `| Base 2‚òÖ necess√°rios: ${need2Total.toLocaleString()}</span>`;
}

// === 3.4 UI: abrir/fechar painel ===
(function setupXpCalc(){
  const panel = document.getElementById('xpCalcPanel');
  const btn   = document.getElementById('btnXpCalc');
  const close = document.getElementById('xpCalcClose');

  // ajuste aqui se seu grid tiver outro seletor
  const grid = document.getElementById('mainCourt') || document.querySelector('.main-court');

  function openPanel(){
    if (grid) grid.style.display = 'none';
    panel.classList.remove('hidden');
    if (typeof closeSideMenu === 'function') closeSideMenu();

  // ‚ñº SCROLL AT√â A CALCULADORA
  panel.scrollIntoView({ behavior: 'smooth', block: 'start' });
    updateAlreadyUI();
    compute();
  }
  function closePanel(){
    panel.classList.add('hidden');
    if (grid) grid.style.display = '';
  }

  btn?.addEventListener('click', openPanel);
  close?.addEventListener('click', closePanel);

  ['xpRare','xpFrom','xpTo','have5','have4','have3','have2','alreadyAsc'].forEach(id=>{
    const el = document.getElementById(id);
    el?.addEventListener('input', ()=>{ if(id==='xpFrom') updateAlreadyUI(); compute(); });
    el?.addEventListener('change', ()=>{ if(id==='xpFrom') updateAlreadyUI(); compute(); });
  });

  // monta a pequena tabela com os dados puros
  const holder = document.getElementById('xpTable');
  if (holder){
    const rows = [];
    rows.push('<table><thead><tr><th>Raridade</th><th>1‚Üí20</th><th>20‚Üí40</th><th>40‚Üí60</th><th>60‚Üí70</th><th>70‚Üí80</th></tr></thead><tbody>');
    Object.keys(XP_PURE).forEach(r=>{
      const t = XP_PURE[r];
      rows.push(`<tr><td>${r}</td><td>${t['1-20'].toLocaleString()}</td><td>${t['20-40'].toLocaleString()}</td><td>${t['40-60'].toLocaleString()}</td><td>${t['60-70'].toLocaleString()}</td><td>${t['70-80'].toLocaleString()}</td></tr>`);
    });
    rows.push('</tbody></table>');
    holder.innerHTML = rows.join('');
}})();

</script>
<script>
(function () {
  // === configure ===
  const ENDPOINT = 'https://script.google.com/macros/s/AKfycbwSnplPmw7Agru5gA7bU1Gk9_tAQSw8j3ma1WEFOMmlUXqXVBp-Qe4Ey-5xMxMRASS-/exec'; // ex.: https://script.google.com/macros/s/XXX/exec
  // =================

  async function updateCounters() {
    try {
      // Conta visitas repetidas: sempre incrementa a cada carregamento
      const res = await fetch(ENDPOINT + '?inc=1', { cache: 'no-store' });
      const data = await res.json();

      // Atualiza a UI se existir (n√£o quebra se voc√™ mover/ocultar o bloco)
      const t = document.getElementById('visits-today');
      const g = document.getElementById('visits-total');
      if (data && !data.error) {
        if (t) t.textContent = data.todayCount ?? '0';
        if (g) g.textContent = data.total ?? '0';
      } else {
        console.warn('Counter API error:', data && data.error);
      }
    } catch (err) {
      console.error('View counter fetch failed:', err);
    }
  }

  // Dispara quando o DOM estiver pronto (n√£o interfere no seu JS atual)
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', updateCounters);
  } else {
    updateCounters();
  }
})();
</script>

</body>
</html>
